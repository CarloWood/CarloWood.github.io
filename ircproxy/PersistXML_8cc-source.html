<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML LANG="en-us">
 
<HEAD>
<META name="Author" content="Carlo Wood">
<META name="description" content="IRC proxy">
<META name="keywords" content="IRC, proxy, bnc, security, protection">
<META http-equiv="content-type" content="text/html; charset=iso-8859-1">
<TITLE>ircproxy documentation</TITLE>
<LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
<LINK HREF="main.css" REL="stylesheet" TYPE="text/css">
</HEAD>

<BODY>

<TABLE class="header" BORDER=0 CELLSPACING=0 CELLPADDING=0>
<TR>
<TD WIDTH=120><IMG SRC="images/ircproxy.png" BORDER=0></TD>
<TD VALIGN=center ALIGN=center BGCOLOR="#0A0607"><FONT size=+4 color="#ffffff"><B>&nbsp;ircproxy</B>&nbsp;</FONT>
<FONT size=+3 color="#ffffff">The&nbsp;Ultimate&nbsp;Cyborg</FONT></TD>
</TR>
</TABLE>

<DIV class="normal">
<hr>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>PersistXML.cc</h1><a href="PersistXML_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// ircproxy -- An IRC bouncer.</span>
<a name="l00002"></a>00002 <span class="comment">//</span><span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">//! @file PersistXML.cc</span>
<a name="l00004"></a>00004 <span class="comment">//! @brief This file contains the implementation of class PersistXML.</span>
<a name="l00005"></a>00005 <span class="comment"></span><span class="comment">//</span>
<a name="l00006"></a>00006 <span class="comment">// Copyright (C) 2005 - 2007 by</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 <span class="comment">// Carlo Wood, Run on IRC &lt;carlo@alinoe.com&gt;</span>
<a name="l00009"></a>00009 <span class="comment">// RSA-1024 0x624ACAD5 1997-01-26                    Sign &amp; Encrypt</span>
<a name="l00010"></a>00010 <span class="comment">// Fingerprint16 = 32 EC A7 B6 AC DB 65 A6  F6 F6 55 DD 1C DC FF 61</span>
<a name="l00011"></a>00011 <span class="comment">//</span>
<a name="l00012"></a>00012 <span class="comment">// This file may be distributed under the terms of the Q Public License</span>
<a name="l00013"></a>00013 <span class="comment">// version 1.0 as appearing in the file LICENSE.QPL included in the</span>
<a name="l00014"></a>00014 <span class="comment">// packaging of this file.</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="preprocessor">#ifndef USE_PCH</span>
<a name="l00017"></a>00017 <span class="preprocessor"></span><span class="preprocessor">#include "sys.h"</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;iterator&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;libxml/xmlmemory.h&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;libxml/parser.h&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="This file contains the declaration of debug related macros, objects and functions...">debug.h</a>"</span>
<a name="l00024"></a>00024 <span class="preprocessor">#endif</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span>
<a name="l00026"></a>00026 <span class="preprocessor">#include "<a class="code" href="PersistXML_8h.html" title="This file contains the declaration of class PersistXML.">PersistXML.h</a>"</span>
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="classPersistXML.html#2a0aa48dfd52f9101e1ce4958ea674a0">00028</a> <a class="code" href="classPersistXML.html#2a0aa48dfd52f9101e1ce4958ea674a0" title="Construct a new persistent XML archive object.">PersistXML::PersistXML</a>(<span class="keywordtype">void</span>) : M_openmode(not_open)
<a name="l00029"></a>00029 {
<a name="l00030"></a>00030   Dout(<a class="code" href="namespacedebug_1_1channels_1_1dc.html#4df69f2eaea85a2436897d76669e43a5" title="This debug channel is used for XMLPersist.">dc::persist</a>, <span class="stringliteral">"PersistXML::PersistXML(void) is called."</span>);
<a name="l00031"></a>00031 }
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="classPersistXML.html#aebd66f50c13ade879176bf91c606cf3">00033</a> <a class="code" href="classPersistXML.html#aebd66f50c13ade879176bf91c606cf3" title="Destruct the object. An open archive is first finalized.">PersistXML::~PersistXML</a>()
<a name="l00034"></a>00034 {
<a name="l00035"></a>00035   Dout(<a class="code" href="namespacedebug_1_1channels_1_1dc.html#4df69f2eaea85a2436897d76669e43a5" title="This debug channel is used for XMLPersist.">dc::persist</a>, <span class="stringliteral">"PersistXML::~PersistXML() is called."</span>);
<a name="l00036"></a>00036   <span class="keywordflow">if</span> (<a class="code" href="classPersistXML.html#2b18e69338f77033f4308a56ee111419" title="Whether or not the archive is opened for reading or writing.">M_openmode</a> != <a class="code" href="classPersistXML.html#ebe6d1165a2ef09b5cc722f09d145edaad0d87e448e1d77010c4111d76a6ed93" title="Used internally to mark that the archive is not open.">not_open</a>)
<a name="l00037"></a>00037     <a class="code" href="classPersistXML.html#b700aedeb305bb53c8a888e22f812b07" title="Finalize and close the archive.">close</a>();
<a name="l00038"></a>00038 }
<a name="l00039"></a>00039 <span class="comment"></span>
<a name="l00040"></a>00040 <span class="comment">//! Parse the archive.</span>
<a name="l00041"></a><a class="code" href="classPersistXML.html#3d0fcb488bba83e5b2c416aa61ed5545">00041</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classPersistXML.html#3d0fcb488bba83e5b2c416aa61ed5545" title="Parse the archive.">PersistXML::parse_archive</a>(<span class="keywordtype">void</span>)
<a name="l00042"></a>00042 {
<a name="l00043"></a>00043   <a class="code" href="classPersistXML.html#0a91795734c743d5a09a10bd94b56250" title="XML document open for reading.">M_doc</a> = xmlParseFile(<a class="code" href="classPersistXML.html#40ca9714090ca036aad28dce47e6c46b" title="The name of the XML file used to write the archive to disk.">M_archivename</a>.c_str());
<a name="l00044"></a>00044   
<a name="l00045"></a>00045   <span class="comment">// Do some sanity checks.</span>
<a name="l00046"></a>00046   <span class="keywordflow">if</span> (!<a class="code" href="classPersistXML.html#0a91795734c743d5a09a10bd94b56250" title="XML document open for reading.">M_doc</a>)
<a name="l00047"></a>00047     <span class="keywordflow">throw</span> <a class="code" href="classxml__parse__error.html" title="Exception class used to signal a failure in parsing an XML document.">xml_parse_error</a>(<span class="stringliteral">"Document not parsed successfully."</span>);
<a name="l00048"></a>00048   <a class="code" href="classPersistXML.html#ffe7f6b77657b09a8e5c22e0d85d3442" title="Current node in M_doc.">M_cur</a> = xmlDocGetRootElement(<a class="code" href="classPersistXML.html#0a91795734c743d5a09a10bd94b56250" title="XML document open for reading.">M_doc</a>);
<a name="l00049"></a>00049   <span class="keywordflow">if</span> (!<a class="code" href="classPersistXML.html#ffe7f6b77657b09a8e5c22e0d85d3442" title="Current node in M_doc.">M_cur</a>)
<a name="l00050"></a>00050   {
<a name="l00051"></a>00051     xmlFreeDoc(<a class="code" href="classPersistXML.html#0a91795734c743d5a09a10bd94b56250" title="XML document open for reading.">M_doc</a>);
<a name="l00052"></a>00052     <span class="keywordflow">throw</span> <a class="code" href="classxml__parse__error.html" title="Exception class used to signal a failure in parsing an XML document.">xml_parse_error</a>(<span class="stringliteral">"Empty document."</span>);
<a name="l00053"></a>00053   }
<a name="l00054"></a>00054   <span class="keywordflow">if</span> (xmlStrcmp(<a class="code" href="classPersistXML.html#ffe7f6b77657b09a8e5c22e0d85d3442" title="Current node in M_doc.">M_cur</a>-&gt;name, (xmlChar <span class="keyword">const</span>*) <span class="stringliteral">"archive"</span>))
<a name="l00055"></a>00055   {
<a name="l00056"></a>00056     xmlFreeDoc(<a class="code" href="classPersistXML.html#0a91795734c743d5a09a10bd94b56250" title="XML document open for reading.">M_doc</a>);
<a name="l00057"></a>00057     <span class="keywordflow">throw</span> <a class="code" href="classxml__parse__error.html" title="Exception class used to signal a failure in parsing an XML document.">xml_parse_error</a>(<span class="stringliteral">"Document of the wrong type, root node isn't &lt;archive&gt;."</span>);
<a name="l00058"></a>00058   }
<a name="l00059"></a>00059   
<a name="l00060"></a>00060   <span class="comment">// Set M_cur to the first node inside &lt;archive&gt;.</span>
<a name="l00061"></a>00061   <a class="code" href="classPersistXML.html#ffe7f6b77657b09a8e5c22e0d85d3442" title="Current node in M_doc.">M_cur</a> = <a class="code" href="classPersistXML.html#ffe7f6b77657b09a8e5c22e0d85d3442" title="Current node in M_doc.">M_cur</a>-&gt;xmlChildrenNode;
<a name="l00062"></a>00062 }
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="classPersistXML.html#df1b0482f071fbc2b1bae652e8a52e17">00064</a> <span class="keywordtype">void</span> <a class="code" href="classPersistXML.html#df1b0482f071fbc2b1bae652e8a52e17" title="Associate the archive with a file for either reading or writing.">PersistXML::open</a>(std::string filename, <a class="code" href="classPersistXML.html#ebe6d1165a2ef09b5cc722f09d145eda" title="The open mode type of the archive.">openmode_type</a> mode)
<a name="l00065"></a>00065 {
<a name="l00066"></a>00066   Dout(<a class="code" href="namespacedebug_1_1channels_1_1dc.html#4df69f2eaea85a2436897d76669e43a5" title="This debug channel is used for XMLPersist.">dc::persist</a>, <span class="stringliteral">"PersistXML::open(\""</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">"\", "</span> &lt;&lt; mode &lt;&lt; <span class="stringliteral">") is called."</span>);
<a name="l00067"></a>00067   assert(<a class="code" href="classPersistXML.html#2b18e69338f77033f4308a56ee111419" title="Whether or not the archive is opened for reading or writing.">M_openmode</a> == <a class="code" href="classPersistXML.html#ebe6d1165a2ef09b5cc722f09d145edaad0d87e448e1d77010c4111d76a6ed93" title="Used internally to mark that the archive is not open.">not_open</a>);
<a name="l00068"></a>00068   assert(mode == <a class="code" href="classPersistXML.html#ebe6d1165a2ef09b5cc722f09d145eda332ebd1dc31393255a2a6ed1ddcb0270" title="Open for writing objects to the archive.">store</a> || mode == <a class="code" href="classPersistXML.html#ebe6d1165a2ef09b5cc722f09d145eda312929ba0cd974a84c9edeaad046c922" title="Open for reading objects from the archive.">load</a>);
<a name="l00069"></a>00069   <a class="code" href="classPersistXML.html#40ca9714090ca036aad28dce47e6c46b" title="The name of the XML file used to write the archive to disk.">M_archivename</a> = filename;
<a name="l00070"></a>00070   <span class="keywordflow">if</span> (mode == <a class="code" href="classPersistXML.html#ebe6d1165a2ef09b5cc722f09d145eda332ebd1dc31393255a2a6ed1ddcb0270" title="Open for writing objects to the archive.">store</a>)
<a name="l00071"></a>00071   {
<a name="l00072"></a>00072     <a class="code" href="classPersistXML.html#6d5a8241c4e060671c2bd3a33bcb755d" title="The file stream of an open archive.">M_archive</a>.open(filename.c_str(), std::ios_base::out);
<a name="l00073"></a>00073     <a class="code" href="classPersistXML.html#6d5a8241c4e060671c2bd3a33bcb755d" title="The file stream of an open archive.">M_archive</a> &lt;&lt; <span class="stringliteral">"&lt;?xml version=\"1.0\"?&gt;\n"</span>;
<a name="l00074"></a>00074     <a class="code" href="classPersistXML.html#6d5a8241c4e060671c2bd3a33bcb755d" title="The file stream of an open archive.">M_archive</a> &lt;&lt; <a class="code" href="classPersistXML.html#54815808b1b69750789c4acdfc41481f" title="Current XML indentation.">M_indent</a>++ &lt;&lt; <span class="stringliteral">"&lt;archive&gt;\n"</span>;
<a name="l00075"></a>00075   }
<a name="l00076"></a>00076   <span class="keywordflow">else</span>
<a name="l00077"></a>00077     <a class="code" href="classPersistXML.html#3d0fcb488bba83e5b2c416aa61ed5545" title="Parse the archive.">parse_archive</a>();
<a name="l00078"></a>00078   <a class="code" href="classPersistXML.html#2b18e69338f77033f4308a56ee111419" title="Whether or not the archive is opened for reading or writing.">M_openmode</a> = mode;
<a name="l00079"></a>00079 }
<a name="l00080"></a>00080 
<a name="l00081"></a><a class="code" href="classPersistXML.html#b700aedeb305bb53c8a888e22f812b07">00081</a> <span class="keywordtype">void</span> <a class="code" href="classPersistXML.html#b700aedeb305bb53c8a888e22f812b07" title="Finalize and close the archive.">PersistXML::close</a>(<span class="keywordtype">void</span>)
<a name="l00082"></a>00082 {
<a name="l00083"></a>00083   Dout(<a class="code" href="namespacedebug_1_1channels_1_1dc.html#4df69f2eaea85a2436897d76669e43a5" title="This debug channel is used for XMLPersist.">dc::persist</a>, <span class="stringliteral">"PersistXML::close() is called."</span>);
<a name="l00084"></a>00084   assert(<a class="code" href="classPersistXML.html#2b18e69338f77033f4308a56ee111419" title="Whether or not the archive is opened for reading or writing.">M_openmode</a> != <a class="code" href="classPersistXML.html#ebe6d1165a2ef09b5cc722f09d145edaad0d87e448e1d77010c4111d76a6ed93" title="Used internally to mark that the archive is not open.">not_open</a>);
<a name="l00085"></a>00085   <span class="keywordflow">if</span> (<a class="code" href="classPersistXML.html#2b18e69338f77033f4308a56ee111419" title="Whether or not the archive is opened for reading or writing.">M_openmode</a> == <a class="code" href="classPersistXML.html#ebe6d1165a2ef09b5cc722f09d145eda332ebd1dc31393255a2a6ed1ddcb0270" title="Open for writing objects to the archive.">store</a>)
<a name="l00086"></a>00086     <a class="code" href="classPersistXML.html#6d5a8241c4e060671c2bd3a33bcb755d" title="The file stream of an open archive.">M_archive</a> &lt;&lt; --<a class="code" href="classPersistXML.html#54815808b1b69750789c4acdfc41481f" title="Current XML indentation.">M_indent</a> &lt;&lt; <span class="stringliteral">"&lt;/archive&gt;"</span> &lt;&lt; std::endl;
<a name="l00087"></a>00087   <span class="keywordflow">else</span>
<a name="l00088"></a>00088     xmlFreeDoc(<a class="code" href="classPersistXML.html#0a91795734c743d5a09a10bd94b56250" title="XML document open for reading.">M_doc</a>);
<a name="l00089"></a>00089   <a class="code" href="classPersistXML.html#6d5a8241c4e060671c2bd3a33bcb755d" title="The file stream of an open archive.">M_archive</a>.close();
<a name="l00090"></a>00090   <a class="code" href="classPersistXML.html#2b18e69338f77033f4308a56ee111419" title="Whether or not the archive is opened for reading or writing.">M_openmode</a> = <a class="code" href="classPersistXML.html#ebe6d1165a2ef09b5cc722f09d145edaad0d87e448e1d77010c4111d76a6ed93" title="Used internally to mark that the archive is not open.">not_open</a>;
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a><a class="code" href="PersistXML_8h.html#b1f15d2306c5fe44b59b06d350760f47">00093</a> <span class="keywordtype">bool</span> <a class="code" href="PersistXML_8cc.html#b1f15d2306c5fe44b59b06d350760f47" title="Returns true if the label is valid.">valid_label</a>(std::string <span class="keyword">const</span>&amp; label)
<a name="l00094"></a>00094 {
<a name="l00095"></a>00095   <span class="keywordflow">if</span> (label.size() == 0)
<a name="l00096"></a>00096     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00097"></a>00097   <span class="keywordtype">char</span> first_char = label[0];
<a name="l00098"></a>00098   <span class="keywordflow">if</span> (first_char != <span class="charliteral">'_'</span> &amp;&amp; !std::isalpha(first_char))
<a name="l00099"></a>00099     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00100"></a>00100   <span class="keywordflow">if</span> (label.size() &gt;= 3 &amp;&amp;
<a name="l00101"></a>00101       std::tolower(first_char) == <span class="charliteral">'x'</span> &amp;&amp;
<a name="l00102"></a>00102       std::tolower(label[1]) == <span class="charliteral">'m'</span> &amp;&amp;
<a name="l00103"></a>00103       std::tolower(label[2]) == <span class="charliteral">'l'</span>)
<a name="l00104"></a>00104     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00105"></a>00105   std::string::const_iterator iter = label.begin();
<a name="l00106"></a>00106   <span class="keywordflow">while</span> (++iter != label.end())
<a name="l00107"></a>00107   {
<a name="l00108"></a>00108     <span class="keywordtype">char</span> next_character = *iter;
<a name="l00109"></a>00109     <span class="keywordflow">if</span> (!std::isalpha(next_character) &amp;&amp; !std::isdigit(next_character) &amp;&amp; !std::ispunct(next_character))
<a name="l00110"></a>00110       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00111"></a>00111   }
<a name="l00112"></a>00112   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00113"></a>00113 }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 <span class="keyword">template</span>&lt;&gt;
<a name="l00116"></a><a class="code" href="classPersistXML.html#38c1a8f6dbee2b89bfeb0bfc15c12bfa">00116</a>   <span class="keywordtype">void</span> <a class="code" href="classPersistXML.html#84c22189a1765ecd9e7972a36e4f202f" title="Write builtin-type builtin to archive.">PersistXML::write_escaped</a>(<span class="keywordtype">char</span> <span class="keyword">const</span>&amp; c)
<a name="l00117"></a>00117   {
<a name="l00118"></a>00118     <span class="keywordflow">switch</span> (c)
<a name="l00119"></a>00119     {
<a name="l00120"></a>00120       <span class="keywordflow">default</span>:
<a name="l00121"></a>00121         <a class="code" href="classPersistXML.html#6d5a8241c4e060671c2bd3a33bcb755d" title="The file stream of an open archive.">M_archive</a>.put(c);
<a name="l00122"></a>00122         <span class="keywordflow">break</span>;
<a name="l00123"></a>00123       <span class="keywordflow">case</span> <span class="charliteral">'&lt;'</span>:
<a name="l00124"></a>00124         <a class="code" href="classPersistXML.html#6d5a8241c4e060671c2bd3a33bcb755d" title="The file stream of an open archive.">M_archive</a> &lt;&lt; <span class="stringliteral">"&amp;lt;"</span>;
<a name="l00125"></a>00125         <span class="keywordflow">break</span>;
<a name="l00126"></a>00126       <span class="keywordflow">case</span> <span class="charliteral">'&gt;'</span>:
<a name="l00127"></a>00127         <a class="code" href="classPersistXML.html#6d5a8241c4e060671c2bd3a33bcb755d" title="The file stream of an open archive.">M_archive</a> &lt;&lt; <span class="stringliteral">"&amp;gt;"</span>;
<a name="l00128"></a>00128         <span class="keywordflow">break</span>;
<a name="l00129"></a>00129       <span class="keywordflow">case</span> <span class="charliteral">'&amp;'</span>:
<a name="l00130"></a>00130         <a class="code" href="classPersistXML.html#6d5a8241c4e060671c2bd3a33bcb755d" title="The file stream of an open archive.">M_archive</a> &lt;&lt; <span class="stringliteral">"&amp;amp;"</span>;
<a name="l00131"></a>00131         <span class="keywordflow">break</span>;
<a name="l00132"></a>00132       <span class="keywordflow">case</span> <span class="charliteral">'"'</span>:
<a name="l00133"></a>00133         <a class="code" href="classPersistXML.html#6d5a8241c4e060671c2bd3a33bcb755d" title="The file stream of an open archive.">M_archive</a> &lt;&lt; <span class="stringliteral">"&amp;quot;"</span>;
<a name="l00134"></a>00134         <span class="keywordflow">break</span>;
<a name="l00135"></a>00135       <span class="keywordflow">case</span> <span class="charliteral">'\''</span>:
<a name="l00136"></a>00136         <a class="code" href="classPersistXML.html#6d5a8241c4e060671c2bd3a33bcb755d" title="The file stream of an open archive.">M_archive</a> &lt;&lt; <span class="stringliteral">"&amp;apos;"</span>;
<a name="l00137"></a>00137         <span class="keywordflow">break</span>;
<a name="l00138"></a>00138     }
<a name="l00139"></a>00139   }
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 <span class="keyword">template</span>&lt;&gt;
<a name="l00142"></a><a class="code" href="classPersistXML.html#49b75a89604060d42bcfd93d1402ed08">00142</a>   <span class="keywordtype">void</span> <a class="code" href="classPersistXML.html#84c22189a1765ecd9e7972a36e4f202f" title="Write builtin-type builtin to archive.">PersistXML::write_escaped</a>(std::string <span class="keyword">const</span>&amp; builtin)
<a name="l00143"></a>00143   {
<a name="l00144"></a>00144     std::stringstream str;
<a name="l00145"></a>00145     str &lt;&lt; builtin;
<a name="l00146"></a>00146     std::istreambuf_iterator&lt;char&gt; <span class="keyword">const</span> end;
<a name="l00147"></a>00147     <span class="keywordflow">for</span> (std::istreambuf_iterator&lt;char&gt; iter(str); iter != end; ++iter)
<a name="l00148"></a>00148       <a class="code" href="classPersistXML.html#84c22189a1765ecd9e7972a36e4f202f" title="Write builtin-type builtin to archive.">write_escaped</a>(*iter);
<a name="l00149"></a>00149   } 
<a name="l00150"></a>00150 
</pre></div></div>
<hr>

<TABLE WIDTH=100% BORDER=0 CELLSPACING=0 CELLPADDING=0>
<TR>
<TH ALIGN=left BGCOLOR="#e8feff"><ADDRESS>Copyright &copy; 2005-2007 Carlo Wood.&nbsp; All rights reserved.</ADDRESS></TH>
</TR>
</TABLE>

</DIV>
</BODY>
</HTML>

