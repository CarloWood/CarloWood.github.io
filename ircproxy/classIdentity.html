<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML LANG="en-us">
 
<HEAD>
<META name="Author" content="Carlo Wood">
<META name="description" content="IRC proxy">
<META name="keywords" content="IRC, proxy, bnc, security, protection">
<META http-equiv="content-type" content="text/html; charset=iso-8859-1">
<TITLE>ircproxy documentation</TITLE>
<LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
<LINK HREF="main.css" REL="stylesheet" TYPE="text/css">
</HEAD>

<BODY>

<TABLE class="header" BORDER=0 CELLSPACING=0 CELLPADDING=0>
<TR>
<TD WIDTH=120><IMG SRC="images/ircproxy.png" BORDER=0></TD>
<TD VALIGN=center ALIGN=center BGCOLOR="#0A0607"><FONT size=+4 color="#ffffff"><B>&nbsp;ircproxy</B>&nbsp;</FONT>
<FONT size=+3 color="#ffffff">The&nbsp;Ultimate&nbsp;Cyborg</FONT></TD>
</TR>
</TABLE>

<DIV class="normal">
<hr>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Identity Class Reference</h1><!-- doxytag: class="Identity" --><!-- doxytag: inherits="event_client_ct" --><code>#include &lt;<a class="el" href="Identity_8h-source.html">Identity.h</a>&gt;</code>
<p>
<div class="dynheader">
Inheritance diagram for Identity:</div>
<div class="dynsection">

<p><center><img src="classIdentity.png" usemap="#Identity_map" border="0" alt=""></center>
<map name="Identity_map">
</map>
</div>

<p>
<a href="classIdentity-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
A Nick/Network identity. 
<p>
The IRC Client provides a unique key with the PASS message. Each unique key corresponds to a single <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a>, making it possible to re-attach to an identity after losing connection.<p>
The uniqueness corresponds therefore to the uniqueness of a nick/network combination (also in that case there can only be one unique value). 
<p>Definition at line <a class="el" href="Identity_8h-source.html#l00058">58</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#27a2aade8b133b29c1b66fd062b0ca20">Identity</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct an <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a> object for initialization from XML file.  <a href="#27a2aade8b133b29c1b66fd062b0ca20"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#d3c62d14af965795ed965f39fff35df1">Identity</a> (std::string const &amp;key)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct an <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a> object with key <em>key</em>.  <a href="#d3c62d14af965795ed965f39fff35df1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#e2d2f09e464b093543e398e42669088c">~Identity</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destruct an <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a>.  <a href="#e2d2f09e464b093543e398e42669088c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#b1da7874183b9b06e1cdc159520a2d39">Identity</a> (<a class="el" href="classIdentity.html">Identity</a> const &amp;identity)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">WARNING: This is NOT a real copy constructor. It's unfortunately needed for identities_type to work.  <a href="#b1da7874183b9b06e1cdc159520a2d39"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#472293cfac7d33484b2cdc2895fc9038">serialize</a> (<a class="el" href="classPersistXML.html">PersistXML</a> &amp;xml)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Serialize the object.  <a href="#472293cfac7d33484b2cdc2895fc9038"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string const &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#0cfb4a50c8b09d335de9f268aa1fc5de">key</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The key of this <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a>.  <a href="#0cfb4a50c8b09d335de9f268aa1fc5de"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#3c41a896404c73d7f84a53e0a430c0c1">new_client_message_received</a> (<a class="el" href="classClientMessageIn.html">ClientMessageIn</a> const &amp;msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called when a new message was received from the associated client.  <a href="#3c41a896404c73d7f84a53e0a430c0c1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#db9bc35ffd8b4c4df8fcd662701ce1a4">new_server_message_received</a> (<a class="el" href="classServerMessageIn.html">ServerMessageIn</a> const &amp;msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called when a new message was received from the associated server.  <a href="#db9bc35ffd8b4c4df8fcd662701ce1a4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classNick.html">Nick</a> const  &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50">mynick</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a pointer to my <a class="el" href="classNick.html" title="A nick name.">Nick</a> object.  <a href="#d7db39997b22c1d5f8fb7014eb438a50"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classNick.html">Nick</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#bdb9f4b820206b1ff988eeeb090a2e3d">mynick</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a pointer to my <a class="el" href="classNick.html" title="A nick name.">Nick</a> object.  <a href="#bdb9f4b820206b1ff988eeeb090a2e3d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#44ac5b2b0594d9417659ad191f52bc20">server_source</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a reasonable servername that can be used as source for client messages.  <a href="#44ac5b2b0594d9417659ad191f52bc20"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#27ccda057e779185cc678a883aaacba7">ident</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a best-guess for the users ident string.  <a href="#27ccda057e779185cc678a883aaacba7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#c797c7fd752ac44476887c01745b2413">real_hostname</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a best-guess for the users host name.  <a href="#c797c7fd752ac44476887c01745b2413"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#ef9f32c81621f82010e68efea93c3efc">hostname</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a best-guess for the users host name.  <a href="#ef9f32c81621f82010e68efea93c3efc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#e6b6eb4bf0073ab37c56c4218a2278be">real_name</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a best-guess for the users real name.  <a href="#e6b6eb4bf0073ab37c56c4218a2278be"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#30cae43d74e1e50408f30d2a3eff2025">network_name</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the network name that this identity corresponds with.  <a href="#30cae43d74e1e50408f30d2a3eff2025"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#07a9dbfdd574e3661874ac30e810f699">set_ident</a> (std::string const &amp;ident)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set ident string as returned by <a class="el" href="classIdentity.html#27ccda057e779185cc678a883aaacba7" title="Returns a best-guess for the users ident string.">ident()</a>.  <a href="#07a9dbfdd574e3661874ac30e810f699"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#c82636dc236ae926a782ca602b800ff5">set_real_hostname</a> (std::string const &amp;real_hostname)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set host name string as returned by <a class="el" href="classIdentity.html#c797c7fd752ac44476887c01745b2413" title="Returns a best-guess for the users host name.">real_hostname()</a>.  <a href="#c82636dc236ae926a782ca602b800ff5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#f6e0f1ea7930f0a4365f200e06d9e3ac">set_hostname</a> (std::string const &amp;hostname)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set host name string as returned by <a class="el" href="classIdentity.html#ef9f32c81621f82010e68efea93c3efc" title="Returns a best-guess for the users host name.">hostname()</a>.  <a href="#f6e0f1ea7930f0a4365f200e06d9e3ac"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#164492d04ae1322f0015293d32eefd84">set_real_name</a> (std::string const &amp;real_name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set real name string as returned by <a class="el" href="classIdentity.html#e6b6eb4bf0073ab37c56c4218a2278be" title="Returns a best-guess for the users real name.">real_name()</a>.  <a href="#164492d04ae1322f0015293d32eefd84"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#aa9ba940b674bac8361fab2d54575a16">set_network_name</a> (std::string const &amp;network_name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set network name string as returned by <a class="el" href="classIdentity.html#e6b6eb4bf0073ab37c56c4218a2278be" title="Returns a best-guess for the users real name.">real_name()</a>.  <a href="#aa9ba940b674bac8361fab2d54575a16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#79172a04e9886a0a4c5e28e92accc04a">has_authentication_password</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns true if an authentication password is needed.  <a href="#79172a04e9886a0a4c5e28e92accc04a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string const &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#298362ad4383f7f98400d8e907a6aa02">authentication_password</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the authentication password. Should only be called if has_authentication_password returns true.  <a href="#298362ad4383f7f98400d8e907a6aa02"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classNetwork.html">Network</a> const &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#d07e9d448f93a15e480db336e32cdb4a">private_network</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the fake network object, private to this identity.  <a href="#d07e9d448f93a15e480db336e32cdb4a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classNetwork.html">Network</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#6a4596239b296f51a016e53773a23c0e">private_network</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the fake network object, private to this identity.  <a href="#6a4596239b296f51a016e53773a23c0e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classNetwork.html">Network</a> const &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#947c5aff4de5d531cd229df61521f419">network</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the network object of the connection belonging to this identity.  <a href="#947c5aff4de5d531cd229df61521f419"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classNetwork.html">Network</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#f4856f69e3c26ef1c1fd7cdd6deae295">network</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the network object of the connection belonging to this identity.  <a href="#f4856f69e3c26ef1c1fd7cdd6deae295"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#21404842b1235f40c7f4068844fcf402">set_client_session</a> (<a class="el" href="classClientSession.html">ClientSession</a> *client_session)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set current <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a> of this <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a>, called by <a class="el" href="classClientSession.html#31a964d687c64a753af87844e6a76b30" title="Incoming event from ClientSessionInput.">ClientSession::new_message_received</a>.  <a href="#21404842b1235f40c7f4068844fcf402"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#ebf2ebfbca33e8a3f74f035dcf1449ed">reset_client_session</a> (<a class="el" href="classClientSession.html">ClientSession</a> *client_session)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reset the <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a> of this <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a>, provided it matches the currently set <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a>.  <a href="#ebf2ebfbca33e8a3f74f035dcf1449ed"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#b6710a56f4f20332a5b9a10ac8101fb0">has_client_session</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return true if this identity is associated with a client session.  <a href="#b6710a56f4f20332a5b9a10ac8101fb0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#07e702de45aded2c55b792c027bff42f">has_server_session</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return true if this identity is associated with a server session.  <a href="#07e702de45aded2c55b792c027bff42f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classClientSession.html">ClientSession</a> const &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec">client_session</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the current <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a>.  <a href="#4cd26e4bddc74ee29d48d62eb36998ec"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classClientSession.html">ClientSession</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#291dd9d23c82cbe3aef81139f73c7782">client_session</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the current <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a>.  <a href="#291dd9d23c82cbe3aef81139f73c7782"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classServerSession.html">ServerSession</a> const &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860">server_session</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the current <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a>.  <a href="#befd26ceb307699d1b4a16082fa51860"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classServerSession.html">ServerSession</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#499d626ba78f9c6c84adc880608784c0">server_session</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the current <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a>.  <a href="#499d626ba78f9c6c84adc880608784c0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classTarget.html">Target</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#5ff271e26dd0e344642033db31bd455a">notice_target</a> (<a class="el" href="question__nt_8h.html#027b743250267c94e5a1a63e0bbb3846">question_nt</a> number)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a target with prefix <em>prefix</em> that is not already in the private network map.  <a href="#5ff271e26dd0e344642033db31bd455a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classServerConnection.html">ServerConnection</a> const &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#bf3c39a512dcf261dff344aa87d4cceb">server_connection</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the primary server connection object.  <a href="#bf3c39a512dcf261dff344aa87d4cceb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classServerConnection.html">ServerConnection</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#1d3694b7ac3fb7700c2936eece7ae1f9">server_connection</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the primary server connection object.  <a href="#1d3694b7ac3fb7700c2936eece7ae1f9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#66f02133fc21be71cbfeb3512a130005">start_secondary_server_connection</a> (boost::shared_ptr&lt; <a class="el" href="classServer.html">Server</a> &gt; new_server)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start a secondary server connection, which will take over the primary once connected.  <a href="#66f02133fc21be71cbfeb3512a130005"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#940746ce01ed023a81ec25b6c942c760">swap_primary_and_secondary_connection</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Swap primary and secondary connection.  <a href="#940746ce01ed023a81ec25b6c942c760"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#6d80fc2efac0ed1f575183c3e471488b">end_secondary_server_connection</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Terminate the secondary connection.  <a href="#6d80fc2efac0ed1f575183c3e471488b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#d40e92b33971cd656d12f417cf90ef73">has_secondary_server_connection</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return true if this identity is associated with a secondary server connection.  <a href="#d40e92b33971cd656d12f417cf90ef73"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">boost::shared_ptr<br>
&lt; <a class="el" href="classServerConnection.html">ServerConnection</a> const  &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#dcace57442141b0264f670f5e944f9a9">secondary_server_connection</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the secondary server connection. Only valid if has_secondary_server_connection returns true.  <a href="#dcace57442141b0264f670f5e944f9a9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">boost::shared_ptr<br>
&lt; <a class="el" href="classServerConnection.html">ServerConnection</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#68ae8e741b9b8f2ec0db8b427e2ae7b3">secondary_server_connection</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the secondary server connection. Only valid if has_secondary_server_connection returns true.  <a href="#68ae8e741b9b8f2ec0db8b427e2ae7b3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classAuthentication.html">Authentication</a> const &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#b94224aa9917eafb7885d0411cf4bfd9">authentication</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the authentication object.  <a href="#b94224aa9917eafb7885d0411cf4bfd9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classAuthentication.html">Authentication</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#7c580cba7e4e76f027a848dfca13469c">authentication</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the authentication object.  <a href="#7c580cba7e4e76f027a848dfca13469c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#ad20e55e2b6fbe3022e63c3223abae08">send_notice</a> (std::string const &amp;notice, <a class="el" href="question__nt_8h.html#027b743250267c94e5a1a63e0bbb3846">question_nt</a> number=no_related_question)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a notice to the client.  <a href="#ad20e55e2b6fbe3022e63c3223abae08"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#aa0444d422ef667a1c57b9c883b0d3e3">received_network_domain_answer</a> (<a class="el" href="classUserAnswerEventType.html">UserAnswerEventType</a> const &amp;event_type, std::pair&lt; std::string, std::string &gt; network_domain)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Event call back: network domain answer received. Process it.  <a href="#aa0444d422ef667a1c57b9c883b0d3e3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#6322ad040f46c004b07acedc6a4d8e89">pass_as_is_to_server</a> (<a class="el" href="classClientMessageIn.html">ClientMessageIn</a> const &amp;msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write <a class="el" href="classClientMessageIn.html" title="An IRC message as received from a client.">ClientMessageIn</a> <em>msg</em> to the server.  <a href="#6322ad040f46c004b07acedc6a4d8e89"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#5b6ed690dca4101538b7b8e03b3fb3c7">pass_as_is_to_client</a> (<a class="el" href="classServerMessageIn.html">ServerMessageIn</a> const &amp;msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write <a class="el" href="classServerMessageIn.html" title="An IRC message as received from a server.">ServerMessageIn</a> <em>msg</em> to the client.  <a href="#5b6ed690dca4101538b7b8e03b3fb3c7"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#332b96a519b9fc1475904db577f3c280">pass_as_is_to</a> (<a class="el" href="classMessageIn.html">MessageIn</a> const &amp;msg, std::ostream &amp;os)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write <a class="el" href="classMessageIn.html" title="An IRC message as received from client or server.">MessageIn</a> <em>msg</em> to the ostream <em>os</em>.  <a href="#332b96a519b9fc1475904db577f3c280"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#97c1e362cf7d2b6af2795157fc224dbc">M_key</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The unique identity key as used with the identity map.  <a href="#97c1e362cf7d2b6af2795157fc224dbc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classAuthentication.html">Authentication</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#9d54312b39f830b32eee7b9bbe519695">M_authentication</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Temporary authentication token, or NULL.  <a href="#9d54312b39f830b32eee7b9bbe519695"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classNick.html">Nick</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#7015e844fccbd42d8587e2939403c4e8">M_mynick</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pointer to the <a class="el" href="classNick.html" title="A nick name.">Nick</a> object representing my own nick.  <a href="#7015e844fccbd42d8587e2939403c4e8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#1607f2b4aa110ef7b92b07d4daa4cd31">M_authpass</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="classAuthentication.html" title="Authentication token.">Authentication</a> password.  <a href="#1607f2b4aa110ef7b92b07d4daa4cd31"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classNetwork.html">Network</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#076ec46fbabd783e3712179c5b521fb2">M_private_network</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fake network, private to this identity.  <a href="#076ec46fbabd783e3712179c5b521fb2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classClientSession.html">ClientSession</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec">M_client_session</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pointer to the current client session.  <a href="#f1854ef005559a4a7bfa10e0f037e7ec"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#0bfddc02b548d71e42a073e265e26221">M_ident</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A best-guess for this users ident.  <a href="#0bfddc02b548d71e42a073e265e26221"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#639a3cb121a2e8be9ac762260715349c">M_real_hostname</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A best-guess for this users real hostname.  <a href="#639a3cb121a2e8be9ac762260715349c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#abffc9e26b5ad1094c8dfeecadf97031">M_hostname</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A best-guess for this users (cloaked) hostname.  <a href="#abffc9e26b5ad1094c8dfeecadf97031"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#737a886f8703407d1344fc4c62d7aff2">M_real_name</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A best-guess for this users real name.  <a href="#737a886f8703407d1344fc4c62d7aff2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#4f1fe5439749a78e03086cdfe58a9a6f">M_network_name</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The network name that corresponds to this identity.  <a href="#4f1fe5439749a78e03086cdfe58a9a6f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">boost::shared_ptr<br>
&lt; <a class="el" href="classServerConnection.html">ServerConnection</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e">M_primary_server_connection</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Our link to some server.  <a href="#b66b41d74f2cce6a8937974eba2f052e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">boost::shared_ptr<br>
&lt; <a class="el" href="classServerConnection.html">ServerConnection</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#3488da7856d81c986421922eff667072">M_secondary_server_connection</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Link to a secondary server connection in progress, or NULL when none.  <a href="#3488da7856d81c986421922eff667072"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Friends</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::ostream &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentity.html#3771af741a704fd3fc316a63ad6d0269">operator&lt;&lt;</a> (std::ostream &amp;os, <a class="el" href="classIdentity.html">Identity</a> const &amp;identity)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For debugging purposes. Write a <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a> to <em>os</em>.  <a href="#3771af741a704fd3fc316a63ad6d0269"></a><br></td></tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="27a2aade8b133b29c1b66fd062b0ca20"></a><!-- doxytag: member="Identity::Identity" ref="27a2aade8b133b29c1b66fd062b0ca20" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Identity::Identity           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Construct an <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a> object for initialization from XML file. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00076">76</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="debug_8cc-source.html#l00045">debug::channels::dc::objects</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00076"></a>00076                  :
<a name="l00077"></a>00077       <a class="code" href="classIdentity.html#7015e844fccbd42d8587e2939403c4e8" title="Pointer to the Nick object representing my own nick.">M_mynick</a>(NEW(<a class="code" href="classMyNick.html" title="My own nick name.">MyNick</a>(*<span class="keyword">this</span>))),
<a name="l00078"></a>00078       <a class="code" href="classIdentity.html#076ec46fbabd783e3712179c5b521fb2" title="Fake network, private to this identity.">M_private_network</a>(<span class="stringliteral">"private network"</span>, <span class="keyword">true</span>),
<a name="l00079"></a>00079       <a class="code" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec" title="Pointer to the current client session.">M_client_session</a>(NULL),
<a name="l00080"></a>00080       <a class="code" href="classIdentity.html#0bfddc02b548d71e42a073e265e26221" title="A best-guess for this users ident.">M_ident</a>(unknown_ident),
<a name="l00081"></a>00081       <a class="code" href="classIdentity.html#639a3cb121a2e8be9ac762260715349c" title="A best-guess for this users real hostname.">M_real_hostname</a>(unknown_hostname),
<a name="l00082"></a>00082       <a class="code" href="classIdentity.html#abffc9e26b5ad1094c8dfeecadf97031" title="A best-guess for this users (cloaked) hostname.">M_hostname</a>(unknown_hostname),
<a name="l00083"></a>00083       <a class="code" href="classIdentity.html#737a886f8703407d1344fc4c62d7aff2" title="A best-guess for this users real name.">M_real_name</a>(unknown_real_name),
<a name="l00084"></a>00084       <a class="code" href="classIdentity.html#4f1fe5439749a78e03086cdfe58a9a6f" title="The network name that corresponds to this identity.">M_network_name</a>(unknown_network_name),
<a name="l00085"></a>00085       <a class="code" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e" title="Our link to some server.">M_primary_server_connection</a>(NEW(<a class="code" href="classServerConnection.html" title="Object representing the server-side connection.">ServerConnection</a>(<span class="keyword">this</span>)))
<a name="l00086"></a>00086       { Dout(<a class="code" href="namespacedebug_1_1channels_1_1dc.html#4fad4911d56fc2bccbb8ed9041454394" title="This debug channel is used for object construction/destruction tracking.">dc::objects</a>, <span class="stringliteral">"Constructing Identity"</span>); }

</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d3c62d14af965795ed965f39fff35df1"></a><!-- doxytag: member="Identity::Identity" ref="d3c62d14af965795ed965f39fff35df1" args="(std::string const &amp;key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Identity::Identity           </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&nbsp;</td>
          <td class="paramname"> <em>key</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Construct an <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a> object with key <em>key</em>. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00089">89</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="debug_8cc-source.html#l00045">debug::channels::dc::objects</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00089"></a>00089                                  :
<a name="l00090"></a>00090       <a class="code" href="classIdentity.html#97c1e362cf7d2b6af2795157fc224dbc" title="The unique identity key as used with the identity map.">M_key</a>(<a class="code" href="classIdentity.html#0cfb4a50c8b09d335de9f268aa1fc5de" title="The key of this Identity.">key</a>),
<a name="l00091"></a>00091       <a class="code" href="classIdentity.html#7015e844fccbd42d8587e2939403c4e8" title="Pointer to the Nick object representing my own nick.">M_mynick</a>(NEW(<a class="code" href="classMyNick.html" title="My own nick name.">MyNick</a>(*<span class="keyword">this</span>))),
<a name="l00092"></a>00092       <a class="code" href="classIdentity.html#076ec46fbabd783e3712179c5b521fb2" title="Fake network, private to this identity.">M_private_network</a>(<span class="stringliteral">"private network of "</span> + <a class="code" href="classIdentity.html#0cfb4a50c8b09d335de9f268aa1fc5de" title="The key of this Identity.">key</a>, <span class="keyword">true</span>),
<a name="l00093"></a>00093       <a class="code" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec" title="Pointer to the current client session.">M_client_session</a>(NULL),
<a name="l00094"></a>00094       <a class="code" href="classIdentity.html#0bfddc02b548d71e42a073e265e26221" title="A best-guess for this users ident.">M_ident</a>(unknown_ident),
<a name="l00095"></a>00095       <a class="code" href="classIdentity.html#639a3cb121a2e8be9ac762260715349c" title="A best-guess for this users real hostname.">M_real_hostname</a>(unknown_hostname),
<a name="l00096"></a>00096       <a class="code" href="classIdentity.html#abffc9e26b5ad1094c8dfeecadf97031" title="A best-guess for this users (cloaked) hostname.">M_hostname</a>(unknown_hostname),
<a name="l00097"></a>00097       <a class="code" href="classIdentity.html#737a886f8703407d1344fc4c62d7aff2" title="A best-guess for this users real name.">M_real_name</a>(unknown_real_name),
<a name="l00098"></a>00098       <a class="code" href="classIdentity.html#4f1fe5439749a78e03086cdfe58a9a6f" title="The network name that corresponds to this identity.">M_network_name</a>(unknown_network_name),
<a name="l00099"></a>00099       <a class="code" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e" title="Our link to some server.">M_primary_server_connection</a>(NEW(<a class="code" href="classServerConnection.html" title="Object representing the server-side connection.">ServerConnection</a>(<span class="keyword">this</span>)))
<a name="l00100"></a>00100       { Dout(<a class="code" href="namespacedebug_1_1channels_1_1dc.html#4fad4911d56fc2bccbb8ed9041454394" title="This debug channel is used for object construction/destruction tracking.">dc::objects</a>, <span class="stringliteral">"Constructing Identity(\""</span> &lt;&lt; <a class="code" href="classIdentity.html#0cfb4a50c8b09d335de9f268aa1fc5de" title="The key of this Identity.">key</a> &lt;&lt; <span class="stringliteral">"\")"</span>); }

</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e2d2f09e464b093543e398e42669088c"></a><!-- doxytag: member="Identity::~Identity" ref="e2d2f09e464b093543e398e42669088c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Identity::~Identity           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destruct an <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a>. 
<p>

<p>Definition at line <a class="el" href="Identity_8cc-source.html#l00777">777</a> of file <a class="el" href="Identity_8cc-source.html">Identity.cc</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00208">client_session()</a>, <a class="el" href="Identity_8h-source.html#l00202">has_client_session()</a>, <a class="el" href="Identity_8h-source.html#l00205">has_server_session()</a>, <a class="el" href="ServerSession_8h-source.html#l00123">ServerSession::joined_channels()</a>, <a class="el" href="ClientSession_8h-source.html#l00107">ClientSession::joined_channels()</a>, <a class="el" href="debug_8cc-source.html#l00045">debug::channels::dc::objects</a>, and <a class="el" href="Identity_8h-source.html#l00214">server_session()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00778"></a>00778 {
<a name="l00779"></a>00779   Dout(<a class="code" href="namespacedebug_1_1channels_1_1dc.html#4fad4911d56fc2bccbb8ed9041454394" title="This debug channel is used for object construction/destruction tracking.">dc::objects</a>, <span class="stringliteral">"Destructing Identity "</span> &lt;&lt; *<span class="keyword">this</span> &lt;&lt; <span class="stringliteral">"."</span>);
<a name="l00780"></a>00780   <span class="comment">// Destruct channels before destructing private network.</span>
<a name="l00781"></a>00781   <span class="keywordflow">if</span> (<a class="code" href="classIdentity.html#b6710a56f4f20332a5b9a10ac8101fb0" title="Return true if this identity is associated with a client session.">has_client_session</a>())
<a name="l00782"></a>00782     <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#0d0c69d5e0674d086ac4ec09362664b3" title="Return reference to map with known channels.">joined_channels</a>().clear();
<a name="l00783"></a>00783   <span class="keywordflow">if</span> (<a class="code" href="classIdentity.html#07e702de45aded2c55b792c027bff42f" title="Return true if this identity is associated with a server session.">has_server_session</a>())
<a name="l00784"></a>00784     <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#1cdbba5e545c0759814b92d0c578cc02" title="Return reference to map with joined channels.">joined_channels</a>().clear();
<a name="l00785"></a>00785   cancel_all_requests();
<a name="l00786"></a>00786 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b1da7874183b9b06e1cdc159520a2d39"></a><!-- doxytag: member="Identity::Identity" ref="b1da7874183b9b06e1cdc159520a2d39" args="(Identity const &amp;identity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Identity::Identity           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classIdentity.html">Identity</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>identity</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
WARNING: This is NOT a real copy constructor. It's unfortunately needed for identities_type to work. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00106">106</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="Identity_8h-source.html#l00062">M_mynick</a>, <a class="el" href="Identity_8h-source.html#l00072">M_secondary_server_connection</a>, and <a class="el" href="debug_8cc-source.html#l00045">debug::channels::dc::objects</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00106"></a>00106                                      : event_client_ct(identity),
<a name="l00107"></a>00107       <a class="code" href="classIdentity.html#97c1e362cf7d2b6af2795157fc224dbc" title="The unique identity key as used with the identity map.">M_key</a>(identity.M_key),
<a name="l00108"></a>00108       <a class="code" href="classIdentity.html#9d54312b39f830b32eee7b9bbe519695" title="Temporary authentication token, or NULL.">M_authentication</a>(identity.M_authentication),
<a name="l00109"></a>00109       <a class="code" href="classIdentity.html#7015e844fccbd42d8587e2939403c4e8" title="Pointer to the Nick object representing my own nick.">M_mynick</a>(NEW(<a class="code" href="classMyNick.html" title="My own nick name.">MyNick</a>(*<span class="keyword">this</span>))),
<a name="l00110"></a>00110       <a class="code" href="classIdentity.html#1607f2b4aa110ef7b92b07d4daa4cd31" title="Authentication password.">M_authpass</a>(identity.M_authpass),
<a name="l00111"></a>00111       <a class="code" href="classIdentity.html#076ec46fbabd783e3712179c5b521fb2" title="Fake network, private to this identity.">M_private_network</a>(identity.M_private_network),
<a name="l00112"></a>00112       <a class="code" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec" title="Pointer to the current client session.">M_client_session</a>(identity.M_client_session),
<a name="l00113"></a>00113       <a class="code" href="classIdentity.html#0bfddc02b548d71e42a073e265e26221" title="A best-guess for this users ident.">M_ident</a>(identity.M_ident),
<a name="l00114"></a>00114       <a class="code" href="classIdentity.html#639a3cb121a2e8be9ac762260715349c" title="A best-guess for this users real hostname.">M_real_hostname</a>(identity.M_real_hostname),
<a name="l00115"></a>00115       <a class="code" href="classIdentity.html#abffc9e26b5ad1094c8dfeecadf97031" title="A best-guess for this users (cloaked) hostname.">M_hostname</a>(identity.M_hostname),
<a name="l00116"></a>00116       <a class="code" href="classIdentity.html#737a886f8703407d1344fc4c62d7aff2" title="A best-guess for this users real name.">M_real_name</a>(identity.M_real_name),
<a name="l00117"></a>00117       <a class="code" href="classIdentity.html#4f1fe5439749a78e03086cdfe58a9a6f" title="The network name that corresponds to this identity.">M_network_name</a>(identity.M_network_name),
<a name="l00118"></a>00118       <a class="code" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e" title="Our link to some server.">M_primary_server_connection</a>(NEW(<a class="code" href="classServerConnection.html" title="Object representing the server-side connection.">ServerConnection</a>(<span class="keyword">this</span>))),
<a name="l00119"></a>00119       <a class="code" href="classIdentity.html#3488da7856d81c986421922eff667072" title="Link to a secondary server connection in progress, or NULL when none.">M_secondary_server_connection</a>(identity.M_secondary_server_connection)
<a name="l00120"></a>00120       { <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(!<a class="code" href="classIdentity.html#3488da7856d81c986421922eff667072" title="Link to a secondary server connection in progress, or NULL when none.">M_secondary_server_connection</a>.get()); <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classIdentity.html#7015e844fccbd42d8587e2939403c4e8" title="Pointer to the Nick object representing my own nick.">M_mynick</a>.use_count() &lt;= 1); Dout(<a class="code" href="namespacedebug_1_1channels_1_1dc.html#4fad4911d56fc2bccbb8ed9041454394" title="This debug channel is used for object construction/destruction tracking.">dc::objects</a>, <span class="stringliteral">"Copy-constructing Identity from "</span> &lt;&lt; identity); }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="472293cfac7d33484b2cdc2895fc9038"></a><!-- doxytag: member="Identity::serialize" ref="472293cfac7d33484b2cdc2895fc9038" args="(PersistXML &amp;xml)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::serialize           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPersistXML.html">PersistXML</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>xml</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Serialize the object. 
<p>
Serialize object to XML. 
<p>Definition at line <a class="el" href="Identity_8cc-source.html#l00770">770</a> of file <a class="el" href="Identity_8cc-source.html">Identity.cc</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00063">M_authpass</a>, <a class="el" href="Identity_8h-source.html#l00060">M_key</a>, <a class="el" href="Identity_8h-source.html#l00070">M_network_name</a>, and <a class="el" href="PersistXML_8h-source.html#l00175">PersistXML::serialize()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00771"></a>00771 {
<a name="l00772"></a>00772   xml.<a class="code" href="classPersistXML.html#5612c3e53fee8ffb21a228536fea9595" title="Serialize object using the xml tag &amp;lt;label&amp;gt;&amp;lt;/label&amp;gt;.">serialize</a>(<span class="stringliteral">"M_key"</span>, <a class="code" href="classIdentity.html#97c1e362cf7d2b6af2795157fc224dbc" title="The unique identity key as used with the identity map.">M_key</a>);
<a name="l00773"></a>00773   xml.<a class="code" href="classPersistXML.html#5612c3e53fee8ffb21a228536fea9595" title="Serialize object using the xml tag &amp;lt;label&amp;gt;&amp;lt;/label&amp;gt;.">serialize</a>(<span class="stringliteral">"M_authpass"</span>, <a class="code" href="classIdentity.html#1607f2b4aa110ef7b92b07d4daa4cd31" title="Authentication password.">M_authpass</a>);
<a name="l00774"></a>00774   xml.<a class="code" href="classPersistXML.html#5612c3e53fee8ffb21a228536fea9595" title="Serialize object using the xml tag &amp;lt;label&amp;gt;&amp;lt;/label&amp;gt;.">serialize</a>(<span class="stringliteral">"M_network_name"</span>, <a class="code" href="classIdentity.html#4f1fe5439749a78e03086cdfe58a9a6f" title="The network name that corresponds to this identity.">M_network_name</a>);
<a name="l00775"></a>00775 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0cfb4a50c8b09d335de9f268aa1fc5de"></a><!-- doxytag: member="Identity::key" ref="0cfb4a50c8b09d335de9f268aa1fc5de" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string const&amp; Identity::key           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The key of this <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a>. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00126">126</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00060">M_key</a>.</p>

<p>Referenced by <a class="el" href="Target_8cc-source.html#l00208">Target::clientside_get_channel()</a>, <a class="el" href="Target_8cc-source.html#l00054">Target::get_joined_nick()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00377">ServerConnection::invisible_event()</a>, <a class="el" href="debug__ostream__operators_8cc-source.html#l00353">operator&lt;&lt;()</a>, and <a class="el" href="Target_8cc-source.html#l00190">Target::serverside_get_channel()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00126"></a>00126 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#97c1e362cf7d2b6af2795157fc224dbc" title="The unique identity key as used with the identity map.">M_key</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3c41a896404c73d7f84a53e0a430c0c1"></a><!-- doxytag: member="Identity::new_client_message_received" ref="3c41a896404c73d7f84a53e0a430c0c1" args="(ClientMessageIn const &amp;msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::new_client_message_received           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classClientMessageIn.html">ClientMessageIn</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Called when a new message was received from the associated client. 
<p>

<p>Definition at line <a class="el" href="Identity_8cc-source.html#l00092">92</a> of file <a class="el" href="Identity_8cc-source.html">Identity.cc</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="exceptions_8h-source.html#l00127">edragon::caught()</a>, <a class="el" href="MessageIn_8h-source.html#l00202">ClientMessageIn::client_session()</a>, <a class="el" href="Identity_8h-source.html#l00208">client_session()</a>, <a class="el" href="Target_8cc-source.html#l00208">Target::clientside_get_channel()</a>, <a class="el" href="Priority_8cc-source.html#l00023">default_priority()</a>, <a class="el" href="debug_8h-source.html#l00214">DoutEntering</a>, <a class="el" href="Authentication_8h-source.html#l00060">Authentication::get()</a>, <a class="el" href="ClientSession_8cc-source.html#l00282">ClientSession::get_nick()</a>, <a class="el" href="is__channel_8h-source.html#l00027">is_channel()</a>, <a class="el" href="MessageIn_8h-source.html#l00100">MessageIn::key()</a>, <a class="el" href="Identity_8h-source.html#l00061">M_authentication</a>, <a class="el" href="Identity_8h-source.html#l00066">M_ident</a>, <a class="el" href="Identity_8h-source.html#l00069">M_real_name</a>, <a class="el" href="Identity_8h-source.html#l00135">mynick()</a>, <a class="el" href="ClientSession_8cc-source.html#l00247">ClientSession::new_client_nick_received()</a>, <a class="el" href="MessageIn_8h-source.html#l00109">MessageIn::param()</a>, <a class="el" href="MessageIn_8h-source.html#l00106">MessageIn::params()</a>, <a class="el" href="MessageIn_8h-source.html#l00103">MessageIn::params_size()</a>, <a class="el" href="ClientSession_8h-source.html#l00101">ClientSession::private_targets()</a>, <a class="el" href="ServerSession_8h-source.html#l00135">ServerSession::queue_msg()</a>, <a class="el" href="ClientSession_8cc-source.html#l00240">ClientSession::queue_msg()</a>, <a class="el" href="ServerSession_8cc-source.html#l00382">ServerSession::queue_msg_as_is()</a>, <a class="el" href="MessageOut_8h-source.html#l00035">safe_query</a>, <a class="el" href="ServerSession_8cc-source.html#l00347">ServerSession::send_who_write_event()</a>, <a class="el" href="Identity_8h-source.html#l00226">server_connection()</a>, and <a class="el" href="Identity_8h-source.html#l00214">server_session()</a>.</p>

<p>Referenced by <a class="el" href="ClientSession_8cc-source.html#l00121">ClientSession::process_message()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00093"></a>00093 {
<a name="l00094"></a>00094   <a class="code" href="debug_8h.html#3dc350a548c074386c3ec0271d16a7a8" title="Debugging macro.">DoutEntering</a>(dc::debug, <span class="stringliteral">"Identity::new_client_message_received("</span> &lt;&lt; msg &lt;&lt; <span class="stringliteral">")"</span>);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <span class="keywordflow">switch</span> (msg.key())
<a name="l00097"></a>00097   {
<a name="l00098"></a>00098     <span class="keyword">using namespace </span>keys;
<a name="l00099"></a>00099     <span class="keywordflow">case</span> PASS:                  <span class="comment">// No target</span>
<a name="l00100"></a>00100       <a class="code" href="classAuthentication.html#45257d4b9eece61d7b96fd918379f036">Authentication::get</a>(<span class="keyword">this</span>, <a class="code" href="classIdentity.html#9d54312b39f830b32eee7b9bbe519695" title="Temporary authentication token, or NULL.">M_authentication</a>);
<a name="l00101"></a>00101       <a class="code" href="classIdentity.html#9d54312b39f830b32eee7b9bbe519695" title="Temporary authentication token, or NULL.">M_authentication</a>-&gt;decode_pass(msg);
<a name="l00102"></a>00102       <span class="keywordflow">break</span>;
<a name="l00103"></a>00103     <span class="keywordflow">case</span> USER:                  <span class="comment">// No target</span>
<a name="l00104"></a>00104       <span class="keywordflow">if</span> (<a class="code" href="classIdentity.html#0bfddc02b548d71e42a073e265e26221" title="A best-guess for this users ident.">M_ident</a> == unknown_ident)     <span class="comment">// It might be retrieved already from identd.</span>
<a name="l00105"></a>00105         <a class="code" href="classIdentity.html#0bfddc02b548d71e42a073e265e26221" title="A best-guess for this users ident.">M_ident</a> = msg.param(0);
<a name="l00106"></a>00106       <a class="code" href="classIdentity.html#737a886f8703407d1344fc4c62d7aff2" title="A best-guess for this users real name.">M_real_name</a> = msg.param(3);
<a name="l00107"></a>00107       <a class="code" href="classAuthentication.html#45257d4b9eece61d7b96fd918379f036">Authentication::get</a>(<span class="keyword">this</span>, <a class="code" href="classIdentity.html#9d54312b39f830b32eee7b9bbe519695" title="Temporary authentication token, or NULL.">M_authentication</a>);
<a name="l00108"></a>00108       <a class="code" href="classIdentity.html#9d54312b39f830b32eee7b9bbe519695" title="Temporary authentication token, or NULL.">M_authentication</a>-&gt;decode_user(msg);
<a name="l00109"></a>00109       <span class="keywordflow">break</span>;
<a name="l00110"></a>00110     <span class="keywordflow">case</span> PING:                  <span class="comment">// No target</span>
<a name="l00111"></a>00111     {
<a name="l00112"></a>00112       std::string server_name(<a class="code" href="classIdentity.html#bf3c39a512dcf261dff344aa87d4cceb" title="Return the primary server connection object.">server_connection</a>().has_server() ? <a class="code" href="classIdentity.html#bf3c39a512dcf261dff344aa87d4cceb" title="Return the primary server connection object.">server_connection</a>().server()-&gt;get_irc_name() : <span class="stringliteral">"noserver.pong.org"</span>);
<a name="l00113"></a>00113       <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> prefix(server_name);
<a name="l00114"></a>00114       <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(keys::PONG));
<a name="l00115"></a>00115       <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#b241a7f7189af7a21af82dff45277a0a" title="Send an output message to this session.">queue_msg</a>(msgout &lt;&lt; prefix &lt;&lt; keys::PONG &lt;&lt; server_name &lt;&lt; msg.params(0));
<a name="l00116"></a>00116       <span class="keywordflow">break</span>;
<a name="l00117"></a>00117     }
<a name="l00118"></a>00118     <span class="keywordflow">case</span> SILENCE:               <span class="comment">// No target</span>
<a name="l00119"></a>00119     {
<a name="l00120"></a>00120       <span class="comment">// FIXME.</span>
<a name="l00121"></a>00121       <span class="comment">// For now, just pass it on the server as-is.</span>
<a name="l00122"></a>00122       <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#19ff70c7a27c9d832cc072ac7f4add8a" title="Queue message msg with default priority without changing it.">queue_msg_as_is</a>(msg);
<a name="l00123"></a>00123       <span class="keywordflow">break</span>;
<a name="l00124"></a>00124     }
<a name="l00125"></a>00125     <span class="keywordflow">case</span> OPER:                  <span class="comment">// No target</span>
<a name="l00126"></a>00126     <span class="keywordflow">case</span> MAP:
<a name="l00127"></a>00127     <span class="keywordflow">case</span> WALLOPS:
<a name="l00128"></a>00128     <span class="keywordflow">case</span> WALLUSERS:
<a name="l00129"></a>00129     {
<a name="l00130"></a>00130       <span class="comment">// FIXME.</span>
<a name="l00131"></a>00131       <span class="comment">// For now, just pass it on the server as-is.</span>
<a name="l00132"></a>00132       <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#19ff70c7a27c9d832cc072ac7f4add8a" title="Queue message msg with default priority without changing it.">queue_msg_as_is</a>(msg);
<a name="l00133"></a>00133       <span class="keywordflow">break</span>;
<a name="l00134"></a>00134     }
<a name="l00135"></a>00135     <span class="keywordflow">case</span> STATS:                 <span class="comment">// No target, or server target.</span>
<a name="l00136"></a>00136     <span class="keywordflow">case</span> VERSION:
<a name="l00137"></a>00137     {
<a name="l00138"></a>00138       <span class="comment">// FIXME.</span>
<a name="l00139"></a>00139       <span class="comment">// For now, just pass it on the server as-is.</span>
<a name="l00140"></a>00140       <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#19ff70c7a27c9d832cc072ac7f4add8a" title="Queue message msg with default priority without changing it.">queue_msg_as_is</a>(msg);
<a name="l00141"></a>00141       <span class="keywordflow">break</span>;
<a name="l00142"></a>00142     }
<a name="l00143"></a>00143     <span class="keywordflow">case</span> WHO:                   <span class="comment">// Query</span>
<a name="l00144"></a>00144     {
<a name="l00145"></a>00145       <a class="code" href="classWhoRequest.html" title="A WHO request.">WhoRequest</a> who_request(msg.client_session(), (msg.params_size() &gt;= 3) ? msg.param(2) : msg.param(0), msg.param(1));
<a name="l00146"></a>00146       <span class="keywordflow">if</span> (msg.params().size() &gt;= 1 &amp;&amp; who_request.options().matches_against_channel() &amp;&amp; <a class="code" href="is__channel_8h.html#9211aa8dc88461be45ad52d918f5782e" title="Returns true if name is a channel name.">is_channel</a>(who_request.mask()))
<a name="l00147"></a>00147       {
<a name="l00148"></a>00148         <span class="comment">// Search in the private network targets map.</span>
<a name="l00149"></a>00149         ClientSession::private_targets_type::iterator priv_iter = <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#077fae5d435ae160b221805648638b4a" title="Return reference to map with private targets.">private_targets</a>().find(who_request.mask());
<a name="l00150"></a>00150         <span class="keywordflow">if</span> (priv_iter != <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#077fae5d435ae160b221805648638b4a" title="Return reference to map with private targets.">private_targets</a>().end())
<a name="l00151"></a>00151         {
<a name="l00152"></a>00152           boost::static_pointer_cast&lt;<a class="code" href="classPrivateTarget.html" title="A fake channel that is used for communication between user and ircproxy.">PrivateTarget</a>&gt;(priv_iter-&gt;second)-&gt;handle_who(who_request);
<a name="l00153"></a>00153           <span class="keywordflow">break</span>;
<a name="l00154"></a>00154         }
<a name="l00155"></a>00155       }
<a name="l00156"></a>00156       <span class="comment">// Not a private channel, pass it on to the server.</span>
<a name="l00157"></a>00157       <a class="code" href="classPseudoMessageOut.html" title="A pseudo output message.">PseudoMessageOut</a> pseudo_msg(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(keys::WHO), <a class="code" href="MessageOut_8h.html#35822c953540e9ad193309b6d4f650112ca27b35b01919ea12c7c3663e633460" title="The message can be sent to the server regardless.">safe_query</a>);
<a name="l00158"></a>00158       pseudo_msg.writeEventRequest(<a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>(), &amp;<a class="code" href="classServerSession.html#4fc533f77c0d9a4285267db38941a83b" title="A write event of a pseudo WHO message happened. Actually write the WHO message.">ServerSession::send_who_write_event</a>, who_request);
<a name="l00159"></a>00159       <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#6921a52d4541f22dc13cf48b743baf19" title="Queue message msg.">queue_msg</a>(pseudo_msg);
<a name="l00160"></a>00160       <span class="keywordflow">break</span>;
<a name="l00161"></a>00161     }
<a name="l00162"></a>00162     <span class="keywordflow">case</span> WHOIS:                 <span class="comment">// Query</span>
<a name="l00163"></a>00163     <span class="keywordflow">case</span> WHOWAS:                <span class="comment">// Query</span>
<a name="l00164"></a>00164     <span class="keywordflow">case</span> LIST:                  <span class="comment">// Query</span>
<a name="l00165"></a>00165     {
<a name="l00166"></a>00166       <span class="comment">// Extract the prefix of the input message.</span>
<a name="l00167"></a>00167       <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> prefix(msg);
<a name="l00168"></a>00168       <span class="comment">// FIXME: needs caching.</span>
<a name="l00169"></a>00169       <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(msg.key()));
<a name="l00170"></a>00170       <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#6921a52d4541f22dc13cf48b743baf19" title="Queue message msg.">queue_msg</a>(msgout &lt;&lt; prefix &lt;&lt; msg.key() &lt;&lt; msg.params(0));
<a name="l00171"></a>00171       <span class="keywordflow">break</span>;
<a name="l00172"></a>00172     }
<a name="l00173"></a>00173     <span class="keywordflow">case</span> LINKS:                 <span class="comment">// Disabled</span>
<a name="l00174"></a>00174       <span class="keywordflow">break</span>;
<a name="l00175"></a>00175     <span class="keywordflow">case</span> NICK:                  <span class="comment">// Target: this</span>
<a name="l00176"></a>00176       <span class="comment">// Handle NICK</span>
<a name="l00177"></a>00177       msg.client_session().new_client_nick_received(msg.param(0));
<a name="l00178"></a>00178       <span class="keywordflow">break</span>;
<a name="l00179"></a>00179     <span class="keywordflow">case</span> QUIT:                  <span class="comment">// Target: this</span>
<a name="l00180"></a>00180       <span class="keywordflow">break</span>;
<a name="l00181"></a>00181     <span class="keywordflow">case</span> KILL:                  <span class="comment">// Target: nick</span>
<a name="l00182"></a>00182     {
<a name="l00183"></a>00183       <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> prefix(msg);
<a name="l00184"></a>00184       <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(msg.key()));
<a name="l00185"></a>00185       <span class="keywordflow">try</span>
<a name="l00186"></a>00186       {
<a name="l00187"></a>00187         <span class="comment">// Is this a known target?</span>
<a name="l00188"></a>00188         boost::shared_ptr&lt;Target&gt; nick = msg.client_session().get_nick(msg.param(0));
<a name="l00189"></a>00189         <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#6921a52d4541f22dc13cf48b743baf19" title="Queue message msg.">queue_msg</a>(msgout &lt;&lt; prefix &lt;&lt; msg.key() &lt;&lt; nick &lt;&lt; msg.params(1));
<a name="l00190"></a>00190       }
<a name="l00191"></a>00191       <span class="keywordflow">catch</span>(<a class="code" href="classunknown__target.html" title="An exception class.">unknown_target</a>&amp; error)
<a name="l00192"></a>00192       {
<a name="l00193"></a>00193         Debug(<a class="code" href="namespaceedragon.html#bfd7060563c54aecc5df0be27066dcd1" title="Debugging function.">edragon::caught</a>(error));
<a name="l00194"></a>00194         <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#6921a52d4541f22dc13cf48b743baf19" title="Queue message msg.">queue_msg</a>(msgout &lt;&lt; prefix &lt;&lt; msg.key() &lt;&lt; msg.params(0));
<a name="l00195"></a>00195       }
<a name="l00196"></a>00196       <span class="keywordflow">break</span>;
<a name="l00197"></a>00197     }
<a name="l00198"></a>00198     <span class="keywordflow">case</span> MODE:                  <span class="comment">// Target: channel or nick (this)</span>
<a name="l00199"></a>00199     <span class="keywordflow">case</span> PRIVMSG:               <span class="comment">// Target: channel or nick</span>
<a name="l00200"></a>00200     <span class="keywordflow">case</span> NOTICE:                <span class="comment">// Target: channel or nick</span>
<a name="l00201"></a>00201     {
<a name="l00202"></a>00202       <span class="keywordflow">if</span> (!msg.params().empty())
<a name="l00203"></a>00203       {
<a name="l00204"></a>00204         <span class="keywordtype">char</span> c = *msg.params().front().start();
<a name="l00205"></a>00205         <span class="keywordflow">if</span> (c != <span class="charliteral">'#'</span> &amp;&amp; c != <span class="charliteral">'&amp;'</span>)
<a name="l00206"></a>00206         {
<a name="l00207"></a>00207           <span class="keywordflow">if</span> (msg.key() == MODE)
<a name="l00208"></a>00208           {
<a name="l00209"></a>00209             <span class="comment">// Handle MODE &lt;nick&gt;</span>
<a name="l00210"></a>00210             <span class="comment">// FIXME: replace ASSERT with code that handles the other case.</span>
<a name="l00211"></a>00211             <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(msg.param(0) == <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>()-&gt;in_name(<a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>())); 
<a name="l00212"></a>00212             <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> prefix(msg);
<a name="l00213"></a>00213             <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(msg.key()));
<a name="l00214"></a>00214             <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#6921a52d4541f22dc13cf48b743baf19" title="Queue message msg.">queue_msg</a>(msgout &lt;&lt; prefix &lt;&lt; msg.key() &lt;&lt; <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>() &lt;&lt; msg.params(1));
<a name="l00215"></a>00215             <span class="keywordflow">break</span>;
<a name="l00216"></a>00216           }
<a name="l00217"></a>00217           <span class="keywordflow">else</span>
<a name="l00218"></a>00218           {
<a name="l00219"></a>00219             <span class="keywordflow">try</span>
<a name="l00220"></a>00220             {
<a name="l00221"></a>00221               <span class="comment">// Is this a known target?</span>
<a name="l00222"></a>00222               msg.client_session().get_nick(msg.param(0))-&gt;<a class="code" href="classIdentity.html#3c41a896404c73d7f84a53e0a430c0c1" title="Called when a new message was received from the associated client.">new_client_message_received</a>(msg);
<a name="l00223"></a>00223             }
<a name="l00224"></a>00224             <span class="keywordflow">catch</span>(<a class="code" href="classunknown__target.html" title="An exception class.">unknown_target</a>&amp; error)
<a name="l00225"></a>00225             {
<a name="l00226"></a>00226               Debug(<a class="code" href="namespaceedragon.html#bfd7060563c54aecc5df0be27066dcd1" title="Debugging function.">edragon::caught</a>(error));
<a name="l00227"></a>00227               <span class="comment">// Client is sending a message to an unknown target.</span>
<a name="l00228"></a>00228               <span class="comment">// FIXME: Shouldn't we do something here?</span>
<a name="l00229"></a>00229               <span class="comment">// Pass the message as-is to the server.</span>
<a name="l00230"></a>00230               <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#19ff70c7a27c9d832cc072ac7f4add8a" title="Queue message msg with default priority without changing it.">queue_msg_as_is</a>(msg);
<a name="l00231"></a>00231             }
<a name="l00232"></a>00232           }
<a name="l00233"></a>00233           <span class="keywordflow">break</span>;
<a name="l00234"></a>00234         }
<a name="l00235"></a>00235       }
<a name="l00236"></a>00236       <span class="comment">/* FALL-THROUGH */</span>
<a name="l00237"></a>00237     }
<a name="l00238"></a>00238     <span class="keywordflow">case</span> INVITE:                <span class="comment">// Target: channel</span>
<a name="l00239"></a>00239     <span class="keywordflow">case</span> CPRIVMSG:              <span class="comment">// Target: channel</span>
<a name="l00240"></a>00240     <span class="keywordflow">case</span> CNOTICE:               <span class="comment">// Target: channel</span>
<a name="l00241"></a>00241     <span class="keywordflow">case</span> JOIN:                  <span class="comment">// Target: channel</span>
<a name="l00242"></a>00242     <span class="keywordflow">case</span> PART:                  <span class="comment">// Target: channel</span>
<a name="l00243"></a>00243     <span class="keywordflow">case</span> KICK:                  <span class="comment">// Target: channel</span>
<a name="l00244"></a>00244     <span class="keywordflow">case</span> NAMES:                 <span class="comment">// Target: channel</span>
<a name="l00245"></a>00245     <span class="keywordflow">case</span> TOPIC:                 <span class="comment">// Target: channel</span>
<a name="l00246"></a>00246       <span class="keywordflow">try</span>
<a name="l00247"></a>00247       {
<a name="l00248"></a>00248         <span class="comment">// Are we really on this channel?</span>
<a name="l00249"></a>00249         <a class="code" href="classTarget.html#1356d7463258b6863783b7e14ff21b0b" title="Retrieve a shared pointer to the Channel object for channel_name.">Target::clientside_get_channel</a>(*<span class="keyword">this</span>, msg.param(0))-&gt;<a class="code" href="classIdentity.html#3c41a896404c73d7f84a53e0a430c0c1" title="Called when a new message was received from the associated client.">new_client_message_received</a>(msg);
<a name="l00250"></a>00250       }
<a name="l00251"></a>00251       <span class="keywordflow">catch</span>(<a class="code" href="classunknown__target.html" title="An exception class.">unknown_target</a>&amp; error)
<a name="l00252"></a>00252       {
<a name="l00253"></a>00253         Debug(<a class="code" href="namespaceedragon.html#bfd7060563c54aecc5df0be27066dcd1" title="Debugging function.">edragon::caught</a>(error));
<a name="l00254"></a>00254         <span class="comment">// FIXME: Shouldn't we do something here?</span>
<a name="l00255"></a>00255         <span class="comment">// Client targets an unknown channel. Just pass the message on as-is to the server.</span>
<a name="l00256"></a>00256         <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#19ff70c7a27c9d832cc072ac7f4add8a" title="Queue message msg with default priority without changing it.">queue_msg_as_is</a>(msg);
<a name="l00257"></a>00257       }
<a name="l00258"></a>00258       <span class="keywordflow">break</span>;
<a name="l00259"></a>00259   }
<a name="l00260"></a>00260 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="db9bc35ffd8b4c4df8fcd662701ce1a4"></a><!-- doxytag: member="Identity::new_server_message_received" ref="db9bc35ffd8b4c4df8fcd662701ce1a4" args="(ServerMessageIn const &amp;msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::new_server_message_received           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classServerMessageIn.html">ServerMessageIn</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Called when a new message was received from the associated server. 
<p>

<p>Definition at line <a class="el" href="Identity_8cc-source.html#l00278">278</a> of file <a class="el" href="Identity_8cc-source.html">Identity.cc</a>.</p>

<p>References <a class="el" href="Target_8cc-source.html#l00073">Target::add_joined_nick()</a>, <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="exceptions_8h-source.html#l00127">edragon::caught()</a>, <a class="el" href="Identity_8h-source.html#l00208">client_session()</a>, <a class="el" href="Priority_8cc-source.html#l00023">default_priority()</a>, <a class="el" href="debug_8h-source.html#l00214">DoutEntering</a>, <a class="el" href="WhoRequest_8h-source.html#l00108">WhoOptions::fields()</a>, <a class="el" href="Target_8cc-source.html#l00054">Target::get_joined_nick()</a>, <a class="el" href="Prefix_8h-source.html#l00065">Prefix::get_nick()</a>, <a class="el" href="ServerSession_8cc-source.html#l00537">ServerSession::get_nick()</a>, <a class="el" href="Identity_8h-source.html#l00150">hostname()</a>, <a class="el" href="NickPair_8h-source.html#l00047">NickPair::in_nick()</a>, <a class="el" href="NickPair_8cc-source.html#l00056">NickPair::inuse()</a>, <a class="el" href="MessageIn_8h-source.html#l00100">MessageIn::key()</a>, <a class="el" href="WhoRequest_8h-source.html#l00147">WhoRequest::mask()</a>, <a class="el" href="Identity_8h-source.html#l00135">mynick()</a>, <a class="el" href="Identity_8h-source.html#l00189">network()</a>, <a class="el" href="ServerSession_8h-source.html#l00117">ServerSession::nicks()</a>, <a class="el" href="WhoRequest_8h-source.html#l00149">WhoRequest::options()</a>, <a class="el" href="Prefix_8cc-source.html#l00097">Prefix::out_prefix()</a>, <a class="el" href="MessageIn_8h-source.html#l00109">MessageIn::param()</a>, <a class="el" href="MessageIn_8h-source.html#l00106">MessageIn::params()</a>, <a class="el" href="Identity_8cc-source.html#l00087">pass_as_is_to_client()</a>, <a class="el" href="ServerConnection_8h-source.html#l00041">pong_sent</a>, <a class="el" href="ServerSession_8h-source.html#l00149">ServerSession::pop_who_request()</a>, <a class="el" href="MessageIn_8h-source.html#l00130">MessageIn::prefix()</a>, <a class="el" href="ClientSession_8cc-source.html#l00240">ClientSession::queue_msg()</a>, <a class="el" href="Identity_8h-source.html#l00226">server_connection()</a>, <a class="el" href="MessageIn_8h-source.html#l00234">ServerMessageIn::server_session()</a>, <a class="el" href="Identity_8h-source.html#l00214">server_session()</a>, <a class="el" href="Target_8cc-source.html#l00190">Target::serverside_get_channel()</a>, and <a class="el" href="ServerConnection_8h-source.html#l00120">ServerConnection::state()</a>.</p>

<p>Referenced by <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00279"></a>00279 {
<a name="l00280"></a>00280   <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(!debug::secondary_connection);
<a name="l00281"></a>00281   <a class="code" href="debug_8h.html#3dc350a548c074386c3ec0271d16a7a8" title="Debugging macro.">DoutEntering</a>(dc::debug, <span class="stringliteral">"Identity::new_server_message_received("</span> &lt;&lt; msg &lt;&lt; <span class="stringliteral">")"</span>);
<a name="l00282"></a>00282 
<a name="l00283"></a>00283   <span class="keywordflow">switch</span> (msg.key())
<a name="l00284"></a>00284   {
<a name="l00285"></a>00285     <span class="keyword">using namespace </span>keys;
<a name="l00286"></a>00286     <span class="keywordflow">case</span> 315:   <span class="comment">// End of /WHO list.</span>
<a name="l00287"></a>00287     {
<a name="l00288"></a>00288       <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> prefix(msg);
<a name="l00289"></a>00289       <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(msg.key()));
<a name="l00290"></a>00290       <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#b241a7f7189af7a21af82dff45277a0a" title="Send an output message to this session.">queue_msg</a>(msgout &lt;&lt; prefix &lt;&lt; msg.key() &lt;&lt; <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>() &lt;&lt; msg.params(1));
<a name="l00291"></a>00291 <span class="preprocessor">#ifdef CWDEBUG</span>
<a name="l00292"></a>00292 <span class="preprocessor"></span>      <a class="code" href="classWhoRequest.html" title="A WHO request.">WhoRequest</a> who_request(<a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().current_who_request());
<a name="l00293"></a>00293       <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(who_request.mask() == msg.param(1));
<a name="l00294"></a>00294 <span class="preprocessor">#endif</span>
<a name="l00295"></a>00295 <span class="preprocessor"></span>      <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#e6e767a4bc2fd4a4dc2cd4330144a34a" title="Pop the first element of M_who_queue.">pop_who_request</a>();
<a name="l00296"></a>00296       <span class="keywordflow">break</span>;
<a name="l00297"></a>00297     }
<a name="l00298"></a>00298     <span class="keywordflow">case</span> 324:
<a name="l00299"></a>00299     {
<a name="l00300"></a>00300       <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> prefix(msg);
<a name="l00301"></a>00301       <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(msg.key()));
<a name="l00302"></a>00302       <span class="comment">// Parameter 0 should be my own nick name.</span>
<a name="l00303"></a>00303       std::string my_nick_name(msg.param(0));
<a name="l00304"></a>00304       <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(my_nick_name == <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>()-&gt;in_name(msg.server_session()));
<a name="l00305"></a>00305       <span class="comment">// Write the first part of the message.</span>
<a name="l00306"></a>00306       msgout &lt;&lt; prefix &lt;&lt; msg.key() &lt;&lt; <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>();
<a name="l00307"></a>00307       <span class="comment">// FIXME: decode channel modes.</span>
<a name="l00308"></a>00308       <span class="keywordflow">try</span>
<a name="l00309"></a>00309       {
<a name="l00310"></a>00310         boost::shared_ptr&lt;Channel&gt; channel(<a class="code" href="classTarget.html#2c3e405260ba51be778e93e3830d2a0e" title="Retrieve a shared pointer to the Channel object for channel_name.">Target::serverside_get_channel</a>(*<span class="keyword">this</span>, msg.param(1)));
<a name="l00311"></a>00311         msgout &lt;&lt; channel;
<a name="l00312"></a>00312       }
<a name="l00313"></a>00313       <span class="keywordflow">catch</span> (<a class="code" href="classunknown__target.html" title="An exception class.">unknown_target</a>&amp; error)
<a name="l00314"></a>00314       {
<a name="l00315"></a>00315         Debug(<a class="code" href="namespaceedragon.html#bfd7060563c54aecc5df0be27066dcd1" title="Debugging function.">edragon::caught</a>(error));   
<a name="l00316"></a>00316         msgout &lt;&lt; msg.param(1);
<a name="l00317"></a>00317       }
<a name="l00318"></a>00318       msgout &lt;&lt; msg.params(2);
<a name="l00319"></a>00319       <span class="comment">// Write the message.</span>
<a name="l00320"></a>00320       <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#b241a7f7189af7a21af82dff45277a0a" title="Send an output message to this session.">queue_msg</a>(msgout);
<a name="l00321"></a>00321       <span class="keywordflow">break</span>;
<a name="l00322"></a>00322     }
<a name="l00323"></a>00323     <span class="keywordflow">case</span> 329:   <span class="comment">// Channel timestamp.</span>
<a name="l00324"></a>00324     {
<a name="l00325"></a>00325       <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> prefix(msg);
<a name="l00326"></a>00326       <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(msg.key()));
<a name="l00327"></a>00327       <span class="comment">// Parameter 0 should be my own nick name.</span>
<a name="l00328"></a>00328       std::string my_nick_name(msg.param(0));
<a name="l00329"></a>00329       <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(my_nick_name == <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>()-&gt;in_name(msg.server_session()));
<a name="l00330"></a>00330       <span class="comment">// Write the first part of the message.</span>
<a name="l00331"></a>00331       msgout &lt;&lt; prefix &lt;&lt; msg.key() &lt;&lt; <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>();
<a name="l00332"></a>00332       time_t creation_time = atol(msg.param(2).c_str());
<a name="l00333"></a>00333       <span class="keywordflow">try</span>
<a name="l00334"></a>00334       {
<a name="l00335"></a>00335         boost::shared_ptr&lt;Channel&gt; channel(<a class="code" href="classTarget.html#2c3e405260ba51be778e93e3830d2a0e" title="Retrieve a shared pointer to the Channel object for channel_name.">Target::serverside_get_channel</a>(*<span class="keyword">this</span>, msg.param(1)));
<a name="l00336"></a>00336         channel-&gt;set_creation_time(creation_time);
<a name="l00337"></a>00337         msgout &lt;&lt; channel;
<a name="l00338"></a>00338       }
<a name="l00339"></a>00339       <span class="keywordflow">catch</span> (<a class="code" href="classunknown__target.html" title="An exception class.">unknown_target</a>&amp; error)
<a name="l00340"></a>00340       {
<a name="l00341"></a>00341         Debug(<a class="code" href="namespaceedragon.html#bfd7060563c54aecc5df0be27066dcd1" title="Debugging function.">edragon::caught</a>(error));   
<a name="l00342"></a>00342         msgout &lt;&lt; msg.param(1);
<a name="l00343"></a>00343       }
<a name="l00344"></a>00344       msgout &lt;&lt; creation_time;
<a name="l00345"></a>00345       <span class="comment">// Write the message.</span>
<a name="l00346"></a>00346       <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#b241a7f7189af7a21af82dff45277a0a" title="Send an output message to this session.">queue_msg</a>(msgout);
<a name="l00347"></a>00347       <span class="keywordflow">break</span>;
<a name="l00348"></a>00348     }
<a name="l00349"></a>00349     <span class="keywordflow">case</span> 352:   <span class="comment">// WHO, without fields, reply.</span>
<a name="l00350"></a>00350     {
<a name="l00351"></a>00351       <span class="comment">// Get the corresponding WhoRequest.</span>
<a name="l00352"></a>00352       <a class="code" href="classWhoRequest.html" title="A WHO request.">WhoRequest</a> who_request(<a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().current_who_request());
<a name="l00353"></a>00353       Dout(dc::notice, <span class="stringliteral">"Decoding numeric 352 for WHO request "</span> &lt;&lt; who_request);
<a name="l00354"></a>00354       <span class="comment">// The format of this numeric is:</span>
<a name="l00355"></a>00355       <span class="comment">// 0: My nick</span>
<a name="l00356"></a>00356       <span class="comment">// 1: (first) channel</span>
<a name="l00357"></a>00357       <span class="comment">// 2: username</span>
<a name="l00358"></a>00358       <span class="comment">// 3: hostname</span>
<a name="l00359"></a>00359       <span class="comment">// 4: servername</span>
<a name="l00360"></a>00360       <span class="comment">// 5: nick</span>
<a name="l00361"></a>00361       <span class="comment">// 6: flags</span>
<a name="l00362"></a>00362       <span class="comment">// 7: hop realname</span>
<a name="l00363"></a>00363       <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> prefix(msg);
<a name="l00364"></a>00364       <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(msg.key()));
<a name="l00365"></a>00365       <span class="comment">// Parameter 0 should be my own nick name.</span>
<a name="l00366"></a>00366       std::string my_nick_name(msg.param(0));
<a name="l00367"></a>00367       <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(my_nick_name == <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>()-&gt;in_name(msg.server_session()));
<a name="l00368"></a>00368       <span class="comment">// Write the first part of the message.</span>
<a name="l00369"></a>00369       msgout &lt;&lt; prefix &lt;&lt; msg.key() &lt;&lt; <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>();
<a name="l00370"></a>00370       <span class="keywordflow">try</span>
<a name="l00371"></a>00371       {
<a name="l00372"></a>00372         boost::shared_ptr&lt;Channel&gt; channel(<a class="code" href="classTarget.html#2c3e405260ba51be778e93e3830d2a0e" title="Retrieve a shared pointer to the Channel object for channel_name.">Target::serverside_get_channel</a>(*<span class="keyword">this</span>, msg.param(1)));
<a name="l00373"></a>00373         msgout &lt;&lt; channel;
<a name="l00374"></a>00374       }
<a name="l00375"></a>00375       <span class="keywordflow">catch</span> (<a class="code" href="classunknown__target.html" title="An exception class.">unknown_target</a>&amp; error)
<a name="l00376"></a>00376       {
<a name="l00377"></a>00377         Debug(<a class="code" href="namespaceedragon.html#bfd7060563c54aecc5df0be27066dcd1" title="Debugging function.">edragon::caught</a>(error));   
<a name="l00378"></a>00378         msgout &lt;&lt; msg.param(1); 
<a name="l00379"></a>00379       }
<a name="l00380"></a>00380       std::string username(msg.param(2));
<a name="l00381"></a>00381       std::string <a class="code" href="classIdentity.html#ef9f32c81621f82010e68efea93c3efc" title="Returns a best-guess for the users host name.">hostname</a>(msg.param(3));
<a name="l00382"></a>00382       std::string servername(msg.param(4));
<a name="l00383"></a>00383       std::string flags(msg.param(6));
<a name="l00384"></a>00384       std::string realname(msg.param(7));
<a name="l00385"></a>00385       <span class="keywordtype">int</span> hopcount = atoi(realname.c_str());
<a name="l00386"></a>00386       realname = realname.substr(realname.find(<span class="charliteral">' '</span>) + 1);
<a name="l00387"></a>00387       msgout &lt;&lt; username &lt;&lt; <a class="code" href="classIdentity.html#ef9f32c81621f82010e68efea93c3efc" title="Returns a best-guess for the users host name.">hostname</a> &lt;&lt; servername;
<a name="l00388"></a>00388       <span class="keywordflow">try</span>
<a name="l00389"></a>00389       {
<a name="l00390"></a>00390         boost::shared_ptr&lt;Nick&gt; nick(msg.server_session().get_nick(msg.param(5)));
<a name="l00391"></a>00391         msgout &lt;&lt; nick;
<a name="l00392"></a>00392         nick-&gt;data().set_username(username);
<a name="l00393"></a>00393         nick-&gt;data().set_hostname(<a class="code" href="classIdentity.html#ef9f32c81621f82010e68efea93c3efc" title="Returns a best-guess for the users host name.">hostname</a>);
<a name="l00394"></a>00394         nick-&gt;data().set_realname(realname);
<a name="l00395"></a>00395         nick-&gt;data().set_hopcount(hopcount);
<a name="l00396"></a>00396         nick-&gt;data().set_flags(<a class="code" href="classFlags.html" title="A class to store the relevant part of the flags field from a WHO reply.">Flags</a>(<a class="code" href="classIdentity.html#947c5aff4de5d531cd229df61521f419" title="Return the network object of the connection belonging to this identity.">network</a>(), flags));
<a name="l00397"></a>00397       }
<a name="l00398"></a>00398       <span class="keywordflow">catch</span>(<a class="code" href="classunknown__target.html" title="An exception class.">unknown_target</a>&amp; error)
<a name="l00399"></a>00399       {
<a name="l00400"></a>00400         Debug(<a class="code" href="namespaceedragon.html#bfd7060563c54aecc5df0be27066dcd1" title="Debugging function.">edragon::caught</a>(error));   
<a name="l00401"></a>00401         msgout &lt;&lt; msg.param(5);
<a name="l00402"></a>00402       }
<a name="l00403"></a>00403       msgout &lt;&lt; flags &lt;&lt; msg.params(7);
<a name="l00404"></a>00404       <span class="comment">// Write the message.</span>
<a name="l00405"></a>00405       <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#b241a7f7189af7a21af82dff45277a0a" title="Send an output message to this session.">queue_msg</a>(msgout);
<a name="l00406"></a>00406       <span class="keywordflow">break</span>;
<a name="l00407"></a>00407     }
<a name="l00408"></a>00408     <span class="keywordflow">case</span> 354:   <span class="comment">// WHO, with fields, reply.</span>
<a name="l00409"></a>00409     {
<a name="l00410"></a>00410       <span class="comment">// Get the corresponding WhoRequest.</span>
<a name="l00411"></a>00411       <a class="code" href="classWhoRequest.html" title="A WHO request.">WhoRequest</a> who_request(<a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().current_who_request());
<a name="l00412"></a>00412       Dout(dc::notice, <span class="stringliteral">"Decoding numeric 354 for WHO request "</span> &lt;&lt; who_request);
<a name="l00413"></a>00413       <span class="comment">// The format of this numeric is:</span>
<a name="l00414"></a>00414       <span class="comment">// - t: The left-most three digits of the query type (or 0, if there was none, or non-numeric, or negative).</span>
<a name="l00415"></a>00415       <span class="comment">// - c: The (first) channel name.</span>
<a name="l00416"></a>00416       <span class="comment">// - u: User name with eventual ~.</span>
<a name="l00417"></a>00417       <span class="comment">// - i: IP</span>
<a name="l00418"></a>00418       <span class="comment">// - h: Host name.</span>
<a name="l00419"></a>00419       <span class="comment">// - s: Server name.</span>
<a name="l00420"></a>00420       <span class="comment">// - n: Nick name.</span>
<a name="l00421"></a>00421       <span class="comment">// - f: Flags (all of them).</span>
<a name="l00422"></a>00422       <span class="comment">// - d: Hop count. 3 for non-Opers.</span>
<a name="l00423"></a>00423       <span class="comment">// - l: Idle time (0 for remote users). Also 0 for non-Opers.</span>
<a name="l00424"></a>00424       <span class="comment">// - a: Account name.</span>
<a name="l00425"></a>00425       <span class="comment">// - r: Real name.</span>
<a name="l00426"></a>00426 
<a name="l00427"></a>00427       <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> prefix(msg);
<a name="l00428"></a>00428       <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(msg.key()));
<a name="l00429"></a>00429       <span class="comment">// Parameter 0 should be my own nick name.</span>
<a name="l00430"></a>00430       std::string my_nick_name(msg.param(0));
<a name="l00431"></a>00431       <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(my_nick_name == <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>()-&gt;in_name(msg.server_session()));
<a name="l00432"></a>00432       <span class="comment">// Write the first part of the message.</span>
<a name="l00433"></a>00433       msgout &lt;&lt; prefix &lt;&lt; msg.key() &lt;&lt; <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>();
<a name="l00434"></a>00434 
<a name="l00435"></a>00435       <span class="keywordtype">int</span> n = 0;
<a name="l00436"></a>00436       <span class="comment">// Run over all field flags.</span>
<a name="l00437"></a>00437       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> field = 1; field &lt; field_percentage; field &lt;&lt;= 1)
<a name="l00438"></a>00438       {
<a name="l00439"></a>00439         <span class="keywordflow">if</span> ((who_request.options().fields() &amp; field))
<a name="l00440"></a>00440         {
<a name="l00441"></a>00441           <span class="comment">// Next message parameter.</span>
<a name="l00442"></a>00442           ++n;
<a name="l00443"></a>00443           <span class="comment">// Ok, this field exists. Write it out.</span>
<a name="l00444"></a>00444           <span class="keywordflow">if</span> (field == field_c)         <span class="comment">// A channel name?</span>
<a name="l00445"></a>00445           {
<a name="l00446"></a>00446             <span class="keywordflow">try</span>
<a name="l00447"></a>00447             {
<a name="l00448"></a>00448               boost::shared_ptr&lt;Channel&gt; channel(<a class="code" href="classTarget.html#2c3e405260ba51be778e93e3830d2a0e" title="Retrieve a shared pointer to the Channel object for channel_name.">Target::serverside_get_channel</a>(*<span class="keyword">this</span>, msg.param(n)));
<a name="l00449"></a>00449               msgout &lt;&lt; channel;
<a name="l00450"></a>00450             }
<a name="l00451"></a>00451             <span class="keywordflow">catch</span> (<a class="code" href="classunknown__target.html" title="An exception class.">unknown_target</a>&amp; error)
<a name="l00452"></a>00452             {
<a name="l00453"></a>00453               Debug(<a class="code" href="namespaceedragon.html#bfd7060563c54aecc5df0be27066dcd1" title="Debugging function.">edragon::caught</a>(error));   
<a name="l00454"></a>00454               msgout &lt;&lt; msg.param(n); 
<a name="l00455"></a>00455             }
<a name="l00456"></a>00456           }
<a name="l00457"></a>00457           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (field == field_n)    <span class="comment">// A nick name?</span>
<a name="l00458"></a>00458           {
<a name="l00459"></a>00459             <span class="keywordflow">try</span>
<a name="l00460"></a>00460             {
<a name="l00461"></a>00461               boost::shared_ptr&lt;Nick&gt; nick(msg.server_session().get_nick(msg.param(n)));
<a name="l00462"></a>00462               msgout &lt;&lt; nick;
<a name="l00463"></a>00463               <span class="keywordtype">int</span> n2 = 0;
<a name="l00464"></a>00464               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> field2 = 1; field2 &lt; field_percentage; field2 &lt;&lt;= 1)
<a name="l00465"></a>00465                 <span class="keywordflow">if</span> ((who_request.options().fields() &amp; field2))
<a name="l00466"></a>00466                 {
<a name="l00467"></a>00467                   ++n2;
<a name="l00468"></a>00468                   <span class="keywordflow">switch</span>(field2)
<a name="l00469"></a>00469                   {
<a name="l00470"></a>00470                     <span class="keywordflow">case</span> field_u:
<a name="l00471"></a>00471                       nick-&gt;data().set_username(msg.param(n2));
<a name="l00472"></a>00472                       <span class="keywordflow">break</span>;
<a name="l00473"></a>00473                     <span class="keywordflow">case</span> field_h:
<a name="l00474"></a>00474                       nick-&gt;data().set_hostname(msg.param(n2));
<a name="l00475"></a>00475                       <span class="keywordflow">break</span>;
<a name="l00476"></a>00476                     <span class="keywordflow">case</span> field_i:
<a name="l00477"></a>00477                       nick-&gt;data().set_ip(<a class="code" href="classIPNumber.html" title="An IP number.">IPNumber</a>(msg.param(n2)));
<a name="l00478"></a>00478                       <span class="keywordflow">break</span>;
<a name="l00479"></a>00479                     <span class="keywordflow">case</span> field_r:
<a name="l00480"></a>00480                       nick-&gt;data().set_realname(msg.param(n2));
<a name="l00481"></a>00481                       <span class="keywordflow">break</span>;
<a name="l00482"></a>00482                     <span class="keywordflow">case</span> field_d:
<a name="l00483"></a>00483                       nick-&gt;data().set_hopcount(atoi(msg.param(n2).c_str()));
<a name="l00484"></a>00484                       <span class="keywordflow">break</span>;
<a name="l00485"></a>00485                     <span class="keywordflow">case</span> field_f:
<a name="l00486"></a>00486                       nick-&gt;data().set_flags(<a class="code" href="classFlags.html" title="A class to store the relevant part of the flags field from a WHO reply.">Flags</a>(<a class="code" href="classIdentity.html#947c5aff4de5d531cd229df61521f419" title="Return the network object of the connection belonging to this identity.">network</a>(), msg.param(n2)));
<a name="l00487"></a>00487                       <span class="keywordflow">break</span>;
<a name="l00488"></a>00488                     <span class="keywordflow">case</span> field_s:
<a name="l00489"></a>00489                       nick-&gt;data().set_servername(msg.param(n2));
<a name="l00490"></a>00490                       <span class="keywordflow">break</span>;
<a name="l00491"></a>00491                     <span class="keywordflow">case</span> field_l:
<a name="l00492"></a>00492                       nick-&gt;data().set_idletime(atoi(msg.param(n2).c_str()));
<a name="l00493"></a>00493                       <span class="keywordflow">break</span>;
<a name="l00494"></a>00494                     <span class="keywordflow">case</span> field_a:
<a name="l00495"></a>00495                       nick-&gt;data().set_accountname(msg.param(n2));
<a name="l00496"></a>00496                       <span class="keywordflow">break</span>;
<a name="l00497"></a>00497                   }
<a name="l00498"></a>00498                 }
<a name="l00499"></a>00499             }
<a name="l00500"></a>00500             <span class="keywordflow">catch</span>(<a class="code" href="classunknown__target.html" title="An exception class.">unknown_target</a>&amp; error)
<a name="l00501"></a>00501             {
<a name="l00502"></a>00502               Debug(<a class="code" href="namespaceedragon.html#bfd7060563c54aecc5df0be27066dcd1" title="Debugging function.">edragon::caught</a>(error));   
<a name="l00503"></a>00503               msgout &lt;&lt; msg.param(n);
<a name="l00504"></a>00504             }
<a name="l00505"></a>00505           }
<a name="l00506"></a>00506           <span class="keywordflow">else</span>
<a name="l00507"></a>00507             msgout &lt;&lt; msg.param(n);
<a name="l00508"></a>00508         }
<a name="l00509"></a>00509       }
<a name="l00510"></a>00510       <span class="comment">// Write the message.</span>
<a name="l00511"></a>00511       <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#b241a7f7189af7a21af82dff45277a0a" title="Send an output message to this session.">queue_msg</a>(msgout);
<a name="l00512"></a>00512       <span class="keywordflow">break</span>;
<a name="l00513"></a>00513     }
<a name="l00514"></a>00514     <span class="keywordflow">case</span> 353:   <span class="comment">// NAMES reply</span>
<a name="l00515"></a>00515     {
<a name="l00516"></a>00516       <span class="comment">// Get prefix.</span>
<a name="l00517"></a>00517       <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> prefix(msg);
<a name="l00518"></a>00518       <span class="comment">// Prepare message to be sent to client.</span>
<a name="l00519"></a>00519       <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(msg.key()));
<a name="l00520"></a>00520       <span class="comment">// Lookup the channel.</span>
<a name="l00521"></a>00521       boost::shared_ptr&lt;Channel&gt; channel(<a class="code" href="classTarget.html#2c3e405260ba51be778e93e3830d2a0e" title="Retrieve a shared pointer to the Channel object for channel_name.">Target::serverside_get_channel</a>(*<span class="keyword">this</span>, msg.param(2)));
<a name="l00522"></a>00522       <span class="keywordtype">bool</span> received_first_names = channel-&gt;received_names();
<a name="l00523"></a>00523       <span class="comment">// Parameter 0 should be my own nick name.</span>
<a name="l00524"></a>00524       std::string my_nick_name(msg.param(0));
<a name="l00525"></a>00525       <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(my_nick_name == <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>()-&gt;in_name(msg.server_session()));
<a name="l00526"></a>00526       <span class="comment">// Write first part of message.</span>
<a name="l00527"></a>00527       msgout &lt;&lt; prefix &lt;&lt; msg.key() &lt;&lt; <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>() &lt;&lt; msg.param(1) &lt;&lt; channel;
<a name="l00528"></a>00528       <span class="comment">// Run over each parameter.</span>
<a name="l00529"></a>00529       <a class="code" href="classMsgPart.html" title="Like MessageIn::Part but with a copy of msg_block_ct to keep the message block alive...">MsgPart</a> names_list(msg.params(3));
<a name="l00530"></a>00530       <span class="keywordtype">char</span> <span class="keyword">const</span>* list_start = names_list.start();
<a name="l00531"></a>00531       <span class="keywordflow">if</span> (*list_start == <span class="charliteral">':'</span>)
<a name="l00532"></a>00532         ++list_start;
<a name="l00533"></a>00533       <span class="keywordtype">char</span> <span class="keyword">const</span>* <span class="keyword">const</span> list_end = names_list.end();
<a name="l00534"></a>00534       <span class="keywordtype">char</span> <span class="keyword">const</span>* word_end;
<a name="l00535"></a>00535       <span class="keywordflow">for</span> (<span class="keywordtype">char</span> <span class="keyword">const</span>* word_start = list_start; word_start &lt; list_end; word_start = word_end + 1)
<a name="l00536"></a>00536       {
<a name="l00537"></a>00537         <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(*word_start != <span class="charliteral">' '</span>);
<a name="l00538"></a>00538         <span class="keywordflow">for</span> (word_end = word_start; word_end &lt; list_end &amp;&amp; *word_end != <span class="charliteral">' '</span>; ++word_end);
<a name="l00539"></a>00539         std::string param(word_start, word_end - word_start);
<a name="l00540"></a>00540         <span class="keywordflow">if</span> (!IsNickChar(*word_start))
<a name="l00541"></a>00541         {
<a name="l00542"></a>00542           <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(*word_start == <span class="charliteral">'@'</span> || *word_start == <span class="charliteral">'+'</span>);
<a name="l00543"></a>00543           std::string nick_name(word_start + 1, word_end - word_start - 1);
<a name="l00544"></a>00544           boost::shared_ptr&lt;Nick&gt; nick;
<a name="l00545"></a>00545           <span class="keywordflow">if</span> (received_first_names)
<a name="l00546"></a>00546             nick = <a class="code" href="classTarget.html#18128829aa71a1dd131232505030de93" title="Return a shared pointer to the Nick object with name nick_name that is joined to...">Target::get_joined_nick</a>(*<span class="keyword">this</span>, nick_name, channel);
<a name="l00547"></a>00547           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nick_name == my_nick_name)   <span class="comment">// Was already added by the JOIN.</span>
<a name="l00548"></a>00548             nick = <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>();
<a name="l00549"></a>00549           <span class="keywordflow">else</span>
<a name="l00550"></a>00550             nick = <a class="code" href="classTarget.html#bc965aafc07a935a4ea5d6d84b5b2065" title="Add a new nick with name nick_name to the joined channel with name channel_name.">Target::add_joined_nick</a>(*<span class="keyword">this</span>, nick_name, channel);
<a name="l00551"></a>00551           msgout &lt;&lt; *word_start &lt;&lt; <a class="code" href="classJustInTimeCatenate.html" title="A just-in-time manipulator. This causes the passed token to be catenated to the previous...">JustInTimeCatenate</a>(nick);
<a name="l00552"></a>00552         }
<a name="l00553"></a>00553         <span class="keywordflow">else</span>
<a name="l00554"></a>00554         {
<a name="l00555"></a>00555           std::string nick_name(word_start, word_end - word_start);
<a name="l00556"></a>00556           boost::shared_ptr&lt;Nick&gt; nick;
<a name="l00557"></a>00557           <span class="keywordflow">if</span> (received_first_names)
<a name="l00558"></a>00558             nick = <a class="code" href="classTarget.html#18128829aa71a1dd131232505030de93" title="Return a shared pointer to the Nick object with name nick_name that is joined to...">Target::get_joined_nick</a>(*<span class="keyword">this</span>, nick_name, channel);
<a name="l00559"></a>00559           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nick_name == my_nick_name)   <span class="comment">// Was already added by the JOIN.</span>
<a name="l00560"></a>00560             nick = <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>();
<a name="l00561"></a>00561           <span class="keywordflow">else</span>
<a name="l00562"></a>00562             nick = <a class="code" href="classTarget.html#bc965aafc07a935a4ea5d6d84b5b2065" title="Add a new nick with name nick_name to the joined channel with name channel_name.">Target::add_joined_nick</a>(*<span class="keyword">this</span>, nick_name, channel);
<a name="l00563"></a>00563           msgout &lt;&lt; nick;
<a name="l00564"></a>00564         }
<a name="l00565"></a>00565       }
<a name="l00566"></a>00566       <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#b241a7f7189af7a21af82dff45277a0a" title="Send an output message to this session.">queue_msg</a>(msgout);
<a name="l00567"></a>00567       <span class="keywordflow">break</span>;
<a name="l00568"></a>00568     }
<a name="l00569"></a>00569     <span class="keywordflow">case</span> 366:   <span class="comment">// End of /NAMES list.</span>
<a name="l00570"></a>00570     {
<a name="l00571"></a>00571       <span class="comment">// Get prefix.</span>
<a name="l00572"></a>00572       <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> prefix(msg);
<a name="l00573"></a>00573       <span class="comment">// Prepare message to be sent to client.</span>
<a name="l00574"></a>00574       <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(msg.key()));
<a name="l00575"></a>00575       <span class="comment">// Lookup the channel.</span>
<a name="l00576"></a>00576       boost::shared_ptr&lt;Channel&gt; channel(<a class="code" href="classTarget.html#2c3e405260ba51be778e93e3830d2a0e" title="Retrieve a shared pointer to the Channel object for channel_name.">Target::serverside_get_channel</a>(*<span class="keyword">this</span>, msg.param(1)));
<a name="l00577"></a>00577       <span class="keywordflow">if</span> (!channel-&gt;received_names())
<a name="l00578"></a>00578       {
<a name="l00579"></a>00579         <span class="comment">// Tell channel we received the first 366.</span>
<a name="l00580"></a>00580         channel-&gt;set_received_names();
<a name="l00581"></a>00581       }
<a name="l00582"></a>00582       <span class="comment">// Parameter 0 should be my own nick name.</span>
<a name="l00583"></a>00583       <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(msg.param(0) == <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>()-&gt;in_name(msg.server_session()));
<a name="l00584"></a>00584       <span class="comment">// Pass message on the client.</span>
<a name="l00585"></a>00585       <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#b241a7f7189af7a21af82dff45277a0a" title="Send an output message to this session.">queue_msg</a>(msgout &lt;&lt; prefix &lt;&lt; msg.key() &lt;&lt; <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>() &lt;&lt; channel &lt;&lt; msg.params(2));
<a name="l00586"></a>00586       <span class="keywordflow">break</span>;
<a name="l00587"></a>00587     }
<a name="l00588"></a>00588     <span class="keywordflow">case</span> 433:   <span class="comment">// Nickname is already in use.</span>
<a name="l00589"></a>00589       <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#3bf7aaaf37f650ecae8ede46fddb06e6" title="Server session nick pair.">nicks</a>().<a class="code" href="classNickPair.html#2d354747ac77dc1669ffe01f92bfcf03" title="Called when a 433 is received from the server.">inuse</a>(msg.param(1));
<a name="l00590"></a>00590       <span class="keywordflow">break</span>;
<a name="l00591"></a>00591     <span class="keywordflow">case</span> 451:   <span class="comment">// Register first</span>
<a name="l00592"></a>00592       <span class="keywordflow">if</span> (<a class="code" href="classIdentity.html#bf3c39a512dcf261dff344aa87d4cceb" title="Return the primary server connection object.">server_connection</a>().<a class="code" href="classServerConnection.html#46893748168791f5ec68caca30b07af1" title="Return the state of the connection.">state</a>() == <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2e329594b1df5c5307e5e5126edb1d605" title="PONG and MODE +i sent.">pong_sent</a>)
<a name="l00593"></a>00593       {
<a name="l00594"></a>00594         <span class="comment">// This probably means that something went wrong with the registration part.</span>
<a name="l00595"></a>00595         <span class="comment">// For example Undernet server version 2.10.12.10 has no means to set MODE +xi</span>
<a name="l00596"></a>00596         <span class="comment">// with the USER command, but requires hostname and ident lookup to be finished</span>
<a name="l00597"></a>00597         <span class="comment">// before it considers registration to be finished. Therefore it is not possible</span>
<a name="l00598"></a>00598         <span class="comment">// to send the PONG and the MODE +ix in one packet (as we do) until after the</span>
<a name="l00599"></a>00599         <span class="comment">// hostname and ident look ups actually have finished. However, because we don't</span>
<a name="l00600"></a>00600         <span class="comment">// know if those lookups are merely delayed a lot, or that we aren't connected</span>
<a name="l00601"></a>00601         <span class="comment">// to an undernet server, we send the PONG and MODE anyway after a certain timeout.</span>
<a name="l00602"></a>00602         <span class="comment">// If the MODE failed, we are vulnerable. Disconnect immediately.</span>
<a name="l00603"></a>00603         <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>() &lt;&lt; <span class="stringliteral">"QUIT\r\n"</span> &lt;&lt; std::flush;
<a name="l00604"></a>00604       }
<a name="l00605"></a>00605       <span class="keywordflow">break</span>;
<a name="l00606"></a>00606     <span class="keywordflow">case</span> QUIT:
<a name="l00607"></a>00607       do_quit(msg.prefix().get_nick(), msg.param(0));
<a name="l00608"></a>00608       <span class="keywordflow">break</span>;
<a name="l00609"></a>00609     <span class="keywordflow">case</span> NICK:
<a name="l00610"></a>00610     {
<a name="l00611"></a>00611       <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> prefix(msg);
<a name="l00612"></a>00612       <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> old_prefix(prefix.out_prefix(<a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>()));
<a name="l00613"></a>00613       boost::shared_ptr&lt;Nick&gt; nick(prefix.get_nick());
<a name="l00614"></a>00614       nick-&gt;serverside_nick_changed_to(msg.server_session(), msg.param(0));     <span class="comment">// This updates the maps.</span>
<a name="l00615"></a>00615       <span class="comment">// FIXME: check for collisions etc.</span>
<a name="l00616"></a>00616       nick-&gt;clientside_nick_changed_to(<a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>(), msg.param(0));         <span class="comment">// This is passed as parameter 0 to the client in the message below.</span>
<a name="l00617"></a>00617       <span class="comment">// Pass the message as-is to the client.</span>
<a name="l00618"></a>00618       <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(msg.key()));
<a name="l00619"></a>00619       <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#b241a7f7189af7a21af82dff45277a0a" title="Send an output message to this session.">queue_msg</a>(msgout &lt;&lt; old_prefix &lt;&lt; msg.key() &lt;&lt; nick);
<a name="l00620"></a>00620       <span class="keywordflow">break</span>;
<a name="l00621"></a>00621     }
<a name="l00622"></a>00622     <span class="keywordflow">case</span> NOTICE:                <span class="comment">// Target: channel or nick</span>
<a name="l00623"></a>00623       <span class="keywordflow">if</span> (<a class="code" href="classIdentity.html#bf3c39a512dcf261dff344aa87d4cceb" title="Return the primary server connection object.">server_connection</a>().<a class="code" href="classServerConnection.html#46893748168791f5ec68caca30b07af1" title="Return the state of the connection.">state</a>() &lt;= <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2e329594b1df5c5307e5e5126edb1d605" title="PONG and MODE +i sent.">pong_sent</a>)     <span class="comment">// On the last AUTH message the state is already set to pong_sent.</span>
<a name="l00624"></a>00624         <span class="keywordflow">break</span>;                  <span class="comment">// Ignore NOTICE AUTH messages in the beginning (already handled).</span>
<a name="l00625"></a>00625       <span class="comment">/* FALL-THROUGH */</span>
<a name="l00626"></a>00626     <span class="keywordflow">case</span> PRIVMSG:               <span class="comment">// Target: channel or nick</span>
<a name="l00627"></a>00627     {
<a name="l00628"></a>00628       <span class="keywordflow">if</span> (msg.params().empty())
<a name="l00629"></a>00629         <span class="keywordflow">break</span>;                  <span class="comment">// Should never happen.</span>
<a name="l00630"></a>00630       <span class="keywordtype">char</span> c = *msg.params().front().start();
<a name="l00631"></a>00631       <span class="keywordflow">if</span> (c != <span class="charliteral">'#'</span> &amp;&amp; c != <span class="charliteral">'&amp;'</span> &amp;&amp; c != <span class="charliteral">'@'</span>)
<a name="l00632"></a>00632       {
<a name="l00633"></a>00633         <span class="comment">// We should only receive PRIVMSG, NOTICE and user MODE's for ourselves.</span>
<a name="l00634"></a>00634         <span class="comment">// A NOTICE can be sent to $mask or * as well.</span>
<a name="l00635"></a>00635         <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(c == <span class="charliteral">'$'</span> || msg.param(0) == <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#3bf7aaaf37f650ecae8ede46fddb06e6" title="Server session nick pair.">nicks</a>().<a class="code" href="classNickPair.html#9ac7a7129697b0c86dc1a3131ad8bafd" title="Returns the last NICK received.">in_nick</a>() || (msg.key() == NOTICE &amp;&amp; msg.param(0) == <span class="stringliteral">"*"</span>));
<a name="l00636"></a>00636         <span class="comment">// Received private PRIVMSG or NOTICE.</span>
<a name="l00637"></a>00637         <span class="comment">// Pass to client as-is.</span>
<a name="l00638"></a>00638         <a class="code" href="classPrefix.html" title="A class representing a message prefix.">Prefix</a> prefix(msg);
<a name="l00639"></a>00639         <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(msg.key()));
<a name="l00640"></a>00640         <span class="keywordflow">if</span> (c == <span class="charliteral">'$'</span> || msg.param(0) == <span class="stringliteral">"*"</span>)
<a name="l00641"></a>00641           <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#b241a7f7189af7a21af82dff45277a0a" title="Send an output message to this session.">queue_msg</a>(msgout &lt;&lt; prefix &lt;&lt; msg.key() &lt;&lt; msg.params(0));
<a name="l00642"></a>00642         <span class="keywordflow">else</span>
<a name="l00643"></a>00643           <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#b241a7f7189af7a21af82dff45277a0a" title="Send an output message to this session.">queue_msg</a>(msgout &lt;&lt; prefix &lt;&lt; msg.key() &lt;&lt; <a class="code" href="classIdentity.html#d7db39997b22c1d5f8fb7014eb438a50" title="Returns a pointer to my Nick object.">mynick</a>() &lt;&lt; msg.params(1));
<a name="l00644"></a>00644         <span class="keywordflow">break</span>;
<a name="l00645"></a>00645       } 
<a name="l00646"></a>00646       <span class="comment">/* FALL-THROUGH */</span>
<a name="l00647"></a>00647     }
<a name="l00648"></a>00648     <span class="keywordflow">case</span> MODE:                  <span class="comment">// Target: channel</span>
<a name="l00649"></a>00649     <span class="keywordflow">case</span> PART:                  <span class="comment">// Target: channel</span>
<a name="l00650"></a>00650     <span class="keywordflow">case</span> KICK:                  <span class="comment">// Target: channel</span>
<a name="l00651"></a>00651     <span class="keywordflow">case</span> TOPIC:                 <span class="comment">// Target: channel</span>
<a name="l00652"></a>00652     {
<a name="l00653"></a>00653       <span class="comment">// If we receive a message from the server targetted to a channel, we should already</span>
<a name="l00654"></a>00654       <span class="comment">// be on the channel, so there is no need to catch the unknown_target exception here.</span>
<a name="l00655"></a>00655       <span class="comment">// If it's JOIN we might not be on the channel, but in that case we create it here.</span>
<a name="l00656"></a>00656       <a class="code" href="classTarget.html#2c3e405260ba51be778e93e3830d2a0e" title="Retrieve a shared pointer to the Channel object for channel_name.">Target::serverside_get_channel</a>(*<span class="keyword">this</span>, msg.param(0), msg.key() == JOIN)-&gt;<a class="code" href="classIdentity.html#db9bc35ffd8b4c4df8fcd662701ce1a4" title="Called when a new message was received from the associated server.">new_server_message_received</a>(msg);
<a name="l00657"></a>00657       <span class="keywordflow">break</span>;
<a name="l00658"></a>00658     }
<a name="l00659"></a>00659     <span class="keywordflow">case</span> JOIN:                  <span class="comment">// Target: channel</span>
<a name="l00660"></a>00660     {
<a name="l00661"></a>00661       <a class="code" href="classTarget.html#2c3e405260ba51be778e93e3830d2a0e" title="Retrieve a shared pointer to the Channel object for channel_name.">Target::serverside_get_channel</a>(*<span class="keyword">this</span>, msg.param(0), msg.key() == JOIN)-&gt;<a class="code" href="classIdentity.html#db9bc35ffd8b4c4df8fcd662701ce1a4" title="Called when a new message was received from the associated server.">new_server_message_received</a>(msg);
<a name="l00662"></a>00662       <span class="keywordflow">break</span>;
<a name="l00663"></a>00663     }
<a name="l00664"></a>00664     <span class="keywordflow">default</span>:
<a name="l00665"></a>00665       Dout(dc::warning, <span class="stringliteral">"Unhandled command "</span> &lt;&lt; msg &lt;&lt; <span class="stringliteral">" from server"</span>);
<a name="l00666"></a>00666       <a class="code" href="classIdentity.html#5b6ed690dca4101538b7b8e03b3fb3c7" title="Write ServerMessageIn msg to the client.">pass_as_is_to_client</a>(msg);
<a name="l00667"></a>00667       <span class="keywordflow">break</span>;
<a name="l00668"></a>00668   }
<a name="l00669"></a>00669 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d7db39997b22c1d5f8fb7014eb438a50"></a><!-- doxytag: member="Identity::mynick" ref="d7db39997b22c1d5f8fb7014eb438a50" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classNick.html">Nick</a> const&gt; Identity::mynick           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a pointer to my <a class="el" href="classNick.html" title="A nick name.">Nick</a> object. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00135">135</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, and <a class="el" href="Identity_8h-source.html#l00062">M_mynick</a>.</p>

<p>Referenced by <a class="el" href="ServerSession_8cc-source.html#l00462">ServerSession::detected_network()</a>, <a class="el" href="Identity_8cc-source.html#l00092">new_client_message_received()</a>, <a class="el" href="ClientSession_8cc-source.html#l00247">ClientSession::new_client_nick_received()</a>, <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>, <a class="el" href="Identity_8cc-source.html#l00278">new_server_message_received()</a>, <a class="el" href="ClientSession_8cc-source.html#l00164">ClientSession::queue_msg_me_as_is()</a>, <a class="el" href="Authentication_8cc-source.html#l00101">Authentication::send_authentication()</a>, and <a class="el" href="Target_8cc-source.html#l00169">Target::sub_channel()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00135"></a>00135 { <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(!debug::secondary_connection); <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#7015e844fccbd42d8587e2939403c4e8" title="Pointer to the Nick object representing my own nick.">M_mynick</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="bdb9f4b820206b1ff988eeeb090a2e3d"></a><!-- doxytag: member="Identity::mynick" ref="bdb9f4b820206b1ff988eeeb090a2e3d" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classNick.html">Nick</a>&gt; Identity::mynick           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a pointer to my <a class="el" href="classNick.html" title="A nick name.">Nick</a> object. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00138">138</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, and <a class="el" href="Identity_8h-source.html#l00062">M_mynick</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00138"></a>00138 { <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(!debug::secondary_connection); <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#7015e844fccbd42d8587e2939403c4e8" title="Pointer to the Nick object representing my own nick.">M_mynick</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="44ac5b2b0594d9417659ad191f52bc20"></a><!-- doxytag: member="Identity::server_source" ref="44ac5b2b0594d9417659ad191f52bc20" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string Identity::server_source           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a reasonable servername that can be used as source for client messages. 
<p>
Obtain associated server name. 
<p>Definition at line <a class="el" href="Identity_8cc-source.html#l00759">759</a> of file <a class="el" href="Identity_8cc-source.html">Identity.cc</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00071">M_primary_server_connection</a>.</p>

<p>Referenced by <a class="el" href="PrivateTarget_8cc-source.html#l00218">PrivateTarget::do_names_output()</a>, and <a class="el" href="PrivateTarget_8cc-source.html#l00034">PrivateTarget::new_client_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00760"></a>00760 {
<a name="l00761"></a>00761   std::string result;
<a name="l00762"></a>00762   <span class="keywordflow">if</span> (<a class="code" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e" title="Our link to some server.">M_primary_server_connection</a>-&gt;has_server())
<a name="l00763"></a>00763     result = <a class="code" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e" title="Our link to some server.">M_primary_server_connection</a>-&gt;server()-&gt;get_irc_name();
<a name="l00764"></a>00764   <span class="keywordflow">if</span> (result.empty())
<a name="l00765"></a>00765     result = <span class="stringliteral">"ircproxy.net"</span>;
<a name="l00766"></a>00766   <span class="keywordflow">return</span> result;
<a name="l00767"></a>00767 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="27ccda057e779185cc678a883aaacba7"></a><!-- doxytag: member="Identity::ident" ref="27ccda057e779185cc678a883aaacba7" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string Identity::ident           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a best-guess for the users ident string. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00144">144</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00066">M_ident</a>.</p>

<p>Referenced by <a class="el" href="QuestionTarget_8cc-source.html#l00033">QuestionTarget::new_client_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00144"></a>00144 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#0bfddc02b548d71e42a073e265e26221" title="A best-guess for this users ident.">M_ident</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c797c7fd752ac44476887c01745b2413"></a><!-- doxytag: member="Identity::real_hostname" ref="c797c7fd752ac44476887c01745b2413" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string Identity::real_hostname           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a best-guess for the users host name. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00147">147</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00067">M_real_hostname</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00147"></a>00147 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#639a3cb121a2e8be9ac762260715349c" title="A best-guess for this users real hostname.">M_real_hostname</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ef9f32c81621f82010e68efea93c3efc"></a><!-- doxytag: member="Identity::hostname" ref="ef9f32c81621f82010e68efea93c3efc" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string Identity::hostname           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a best-guess for the users host name. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00150">150</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00068">M_hostname</a>.</p>

<p>Referenced by <a class="el" href="QuestionTarget_8cc-source.html#l00033">QuestionTarget::new_client_message_received()</a>, and <a class="el" href="Identity_8cc-source.html#l00278">new_server_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00150"></a>00150 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#abffc9e26b5ad1094c8dfeecadf97031" title="A best-guess for this users (cloaked) hostname.">M_hostname</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e6b6eb4bf0073ab37c56c4218a2278be"></a><!-- doxytag: member="Identity::real_name" ref="e6b6eb4bf0073ab37c56c4218a2278be" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string Identity::real_name           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a best-guess for the users real name. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00153">153</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00069">M_real_name</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00153"></a>00153 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#737a886f8703407d1344fc4c62d7aff2" title="A best-guess for this users real name.">M_real_name</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="30cae43d74e1e50408f30d2a3eff2025"></a><!-- doxytag: member="Identity::network_name" ref="30cae43d74e1e50408f30d2a3eff2025" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string Identity::network_name           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the network name that this identity corresponds with. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00156">156</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00070">M_network_name</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">ServerConnection::connect()</a>, and <a class="el" href="ServerSession_8cc-source.html#l00389">ServerSession::found_network_name()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00156"></a>00156 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#4f1fe5439749a78e03086cdfe58a9a6f" title="The network name that corresponds to this identity.">M_network_name</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="07a9dbfdd574e3661874ac30e810f699"></a><!-- doxytag: member="Identity::set_ident" ref="07a9dbfdd574e3661874ac30e810f699" args="(std::string const &amp;ident)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::set_ident           </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&nbsp;</td>
          <td class="paramname"> <em>ident</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set ident string as returned by <a class="el" href="classIdentity.html#27ccda057e779185cc678a883aaacba7" title="Returns a best-guess for the users ident string.">ident()</a>. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00159">159</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00066">M_ident</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00392">ServerConnection::received_first_umode()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00160"></a>00160       { Dout(dc::debug, <span class="stringliteral">"Setting ident to \""</span> &lt;&lt; <a class="code" href="classIdentity.html#27ccda057e779185cc678a883aaacba7" title="Returns a best-guess for the users ident string.">ident</a> &lt;&lt; <span class="stringliteral">"\"."</span>); <a class="code" href="classIdentity.html#0bfddc02b548d71e42a073e265e26221" title="A best-guess for this users ident.">M_ident</a> = <a class="code" href="classIdentity.html#27ccda057e779185cc678a883aaacba7" title="Returns a best-guess for the users ident string.">ident</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c82636dc236ae926a782ca602b800ff5"></a><!-- doxytag: member="Identity::set_real_hostname" ref="c82636dc236ae926a782ca602b800ff5" args="(std::string const &amp;real_hostname)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::set_real_hostname           </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&nbsp;</td>
          <td class="paramname"> <em>real_hostname</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set host name string as returned by <a class="el" href="classIdentity.html#c797c7fd752ac44476887c01745b2413" title="Returns a best-guess for the users host name.">real_hostname()</a>. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00163">163</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00067">M_real_hostname</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00392">ServerConnection::received_first_umode()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00164"></a>00164       { Dout(dc::debug, <span class="stringliteral">"Setting real hostname to \""</span> &lt;&lt; <a class="code" href="classIdentity.html#c797c7fd752ac44476887c01745b2413" title="Returns a best-guess for the users host name.">real_hostname</a> &lt;&lt; <span class="stringliteral">"\"."</span>); <a class="code" href="classIdentity.html#639a3cb121a2e8be9ac762260715349c" title="A best-guess for this users real hostname.">M_real_hostname</a> = <a class="code" href="classIdentity.html#c797c7fd752ac44476887c01745b2413" title="Returns a best-guess for the users host name.">real_hostname</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f6e0f1ea7930f0a4365f200e06d9e3ac"></a><!-- doxytag: member="Identity::set_hostname" ref="f6e0f1ea7930f0a4365f200e06d9e3ac" args="(std::string const &amp;hostname)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::set_hostname           </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&nbsp;</td>
          <td class="paramname"> <em>hostname</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set host name string as returned by <a class="el" href="classIdentity.html#ef9f32c81621f82010e68efea93c3efc" title="Returns a best-guess for the users host name.">hostname()</a>. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00167">167</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00068">M_hostname</a>.</p>

<p>Referenced by <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>, and <a class="el" href="ClientSession_8cc-source.html#l00037">ClientSession::new_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00168"></a>00168       { Dout(dc::debug, <span class="stringliteral">"Setting hostname to \""</span> &lt;&lt; <a class="code" href="classIdentity.html#ef9f32c81621f82010e68efea93c3efc" title="Returns a best-guess for the users host name.">hostname</a> &lt;&lt; <span class="stringliteral">"\"."</span>); <a class="code" href="classIdentity.html#abffc9e26b5ad1094c8dfeecadf97031" title="A best-guess for this users (cloaked) hostname.">M_hostname</a> = <a class="code" href="classIdentity.html#ef9f32c81621f82010e68efea93c3efc" title="Returns a best-guess for the users host name.">hostname</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="164492d04ae1322f0015293d32eefd84"></a><!-- doxytag: member="Identity::set_real_name" ref="164492d04ae1322f0015293d32eefd84" args="(std::string const &amp;real_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::set_real_name           </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&nbsp;</td>
          <td class="paramname"> <em>real_name</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set real name string as returned by <a class="el" href="classIdentity.html#e6b6eb4bf0073ab37c56c4218a2278be" title="Returns a best-guess for the users real name.">real_name()</a>. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00171">171</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00069">M_real_name</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00171"></a>00171 { <a class="code" href="classIdentity.html#737a886f8703407d1344fc4c62d7aff2" title="A best-guess for this users real name.">M_real_name</a> = <a class="code" href="classIdentity.html#e6b6eb4bf0073ab37c56c4218a2278be" title="Returns a best-guess for the users real name.">real_name</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="aa9ba940b674bac8361fab2d54575a16"></a><!-- doxytag: member="Identity::set_network_name" ref="aa9ba940b674bac8361fab2d54575a16" args="(std::string const &amp;network_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::set_network_name           </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&nbsp;</td>
          <td class="paramname"> <em>network_name</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set network name string as returned by <a class="el" href="classIdentity.html#e6b6eb4bf0073ab37c56c4218a2278be" title="Returns a best-guess for the users real name.">real_name()</a>. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00174">174</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00070">M_network_name</a>.</p>

<p>Referenced by <a class="el" href="ServerSession_8cc-source.html#l00389">ServerSession::found_network_name()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00174"></a>00174 { <a class="code" href="classIdentity.html#4f1fe5439749a78e03086cdfe58a9a6f" title="The network name that corresponds to this identity.">M_network_name</a> = <a class="code" href="classIdentity.html#30cae43d74e1e50408f30d2a3eff2025" title="Returns the network name that this identity corresponds with.">network_name</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="79172a04e9886a0a4c5e28e92accc04a"></a><!-- doxytag: member="Identity::has_authentication_password" ref="79172a04e9886a0a4c5e28e92accc04a" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Identity::has_authentication_password           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns true if an authentication password is needed. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00177">177</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00063">M_authpass</a>.</p>

<p>Referenced by <a class="el" href="Identity_8h-source.html#l00180">authentication_password()</a>, and <a class="el" href="Authentication_8cc-source.html#l00042">Authentication::decode_pass()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00177"></a>00177 { <span class="keywordflow">return</span> !<a class="code" href="classIdentity.html#1607f2b4aa110ef7b92b07d4daa4cd31" title="Authentication password.">M_authpass</a>.empty(); }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="298362ad4383f7f98400d8e907a6aa02"></a><!-- doxytag: member="Identity::authentication_password" ref="298362ad4383f7f98400d8e907a6aa02" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string const&amp; Identity::authentication_password           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the authentication password. Should only be called if has_authentication_password returns true. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00180">180</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="Identity_8h-source.html#l00177">has_authentication_password()</a>, and <a class="el" href="Identity_8h-source.html#l00063">M_authpass</a>.</p>

<p>Referenced by <a class="el" href="Authentication_8cc-source.html#l00042">Authentication::decode_pass()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00180"></a>00180 { <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classIdentity.html#79172a04e9886a0a4c5e28e92accc04a" title="Returns true if an authentication password is needed.">has_authentication_password</a>()); <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#1607f2b4aa110ef7b92b07d4daa4cd31" title="Authentication password.">M_authpass</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d07e9d448f93a15e480db336e32cdb4a"></a><!-- doxytag: member="Identity::private_network" ref="d07e9d448f93a15e480db336e32cdb4a" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNetwork.html">Network</a> const&amp; Identity::private_network           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the fake network object, private to this identity. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00183">183</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00064">M_private_network</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00183"></a>00183 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#076ec46fbabd783e3712179c5b521fb2" title="Fake network, private to this identity.">M_private_network</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6a4596239b296f51a016e53773a23c0e"></a><!-- doxytag: member="Identity::private_network" ref="6a4596239b296f51a016e53773a23c0e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNetwork.html">Network</a>&amp; Identity::private_network           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the fake network object, private to this identity. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00186">186</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00064">M_private_network</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00186"></a>00186 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#076ec46fbabd783e3712179c5b521fb2" title="Fake network, private to this identity.">M_private_network</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="947c5aff4de5d531cd229df61521f419"></a><!-- doxytag: member="Identity::network" ref="947c5aff4de5d531cd229df61521f419" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNetwork.html">Network</a> const&amp; Identity::network           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the network object of the connection belonging to this identity. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00189">189</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00159">ServerConnection::network()</a>, and <a class="el" href="Identity_8h-source.html#l00226">server_connection()</a>.</p>

<p>Referenced by <a class="el" href="UserAnswer_8cc-source.html#l00070">UserAnswer::is_match()</a>, and <a class="el" href="Identity_8cc-source.html#l00278">new_server_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00189"></a>00189 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#bf3c39a512dcf261dff344aa87d4cceb" title="Return the primary server connection object.">server_connection</a>().<a class="code" href="classServerConnection.html#fa3ed7910bc237f74ac9f6c130797879" title="Return the network object of the current connection.">network</a>(); }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f4856f69e3c26ef1c1fd7cdd6deae295"></a><!-- doxytag: member="Identity::network" ref="f4856f69e3c26ef1c1fd7cdd6deae295" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNetwork.html">Network</a>&amp; Identity::network           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the network object of the connection belonging to this identity. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00192">192</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00159">ServerConnection::network()</a>, and <a class="el" href="Identity_8h-source.html#l00226">server_connection()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00192"></a>00192 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#bf3c39a512dcf261dff344aa87d4cceb" title="Return the primary server connection object.">server_connection</a>().<a class="code" href="classServerConnection.html#fa3ed7910bc237f74ac9f6c130797879" title="Return the network object of the current connection.">network</a>(); }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="21404842b1235f40c7f4068844fcf402"></a><!-- doxytag: member="Identity::set_client_session" ref="21404842b1235f40c7f4068844fcf402" args="(ClientSession *client_session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::set_client_session           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classClientSession.html">ClientSession</a> *&nbsp;</td>
          <td class="paramname"> <em>client_session</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set current <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a> of this <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a>, called by <a class="el" href="classClientSession.html#31a964d687c64a753af87844e6a76b30" title="Incoming event from ClientSessionInput.">ClientSession::new_message_received</a>. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00195">195</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00065">M_client_session</a>.</p>

<p>Referenced by <a class="el" href="ClientSession_8cc-source.html#l00037">ClientSession::new_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00195"></a>00195 { <a class="code" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec" title="Pointer to the current client session.">M_client_session</a> = client_session; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ebf2ebfbca33e8a3f74f035dcf1449ed"></a><!-- doxytag: member="Identity::reset_client_session" ref="ebf2ebfbca33e8a3f74f035dcf1449ed" args="(ClientSession *client_session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::reset_client_session           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classClientSession.html">ClientSession</a> *&nbsp;</td>
          <td class="paramname"> <em>client_session</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reset the <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a> of this <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a>, provided it matches the currently set <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a>. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00198">198</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00065">M_client_session</a>.</p>

<p>Referenced by <a class="el" href="ClientSession_8cc-source.html#l00182">ClientSession::~ClientSession()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00199"></a>00199       { <span class="keywordflow">if</span> (<a class="code" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec" title="Pointer to the current client session.">M_client_session</a> == client_session) <a class="code" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec" title="Pointer to the current client session.">M_client_session</a> = NULL; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b6710a56f4f20332a5b9a10ac8101fb0"></a><!-- doxytag: member="Identity::has_client_session" ref="b6710a56f4f20332a5b9a10ac8101fb0" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Identity::has_client_session           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if this identity is associated with a client session. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00202">202</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00065">M_client_session</a>.</p>

<p>Referenced by <a class="el" href="Identity_8cc-source.html#l00777">~Identity()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00202"></a>00202 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec" title="Pointer to the current client session.">M_client_session</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="07e702de45aded2c55b792c027bff42f"></a><!-- doxytag: member="Identity::has_server_session" ref="07e702de45aded2c55b792c027bff42f" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Identity::has_server_session           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if this identity is associated with a server session. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00205">205</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00071">M_primary_server_connection</a>.</p>

<p>Referenced by <a class="el" href="Identity_8cc-source.html#l00777">~Identity()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00205"></a>00205 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e" title="Our link to some server.">M_primary_server_connection</a>-&gt;has_server_session(); }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="4cd26e4bddc74ee29d48d62eb36998ec"></a><!-- doxytag: member="Identity::client_session" ref="4cd26e4bddc74ee29d48d62eb36998ec" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classClientSession.html">ClientSession</a> const&amp; Identity::client_session           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the current <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a>. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00208">208</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, and <a class="el" href="Identity_8h-source.html#l00065">M_client_session</a>.</p>

<p>Referenced by <a class="el" href="Target_8cc-source.html#l00136">Target::add_channel()</a>, <a class="el" href="Target_8cc-source.html#l00208">Target::clientside_get_channel()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00073">ServerConnection::connect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00149">ServerConnection::do_connect()</a>, <a class="el" href="ServerSession_8cc-source.html#l00389">ServerSession::found_network_name()</a>, <a class="el" href="Identity_8cc-source.html#l00092">new_client_message_received()</a>, <a class="el" href="Channel_8cc-source.html#l00031">Channel::new_client_message_received()</a>, <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>, <a class="el" href="Identity_8cc-source.html#l00278">new_server_message_received()</a>, <a class="el" href="Channel_8cc-source.html#l00082">Channel::new_server_message_received()</a>, <a class="el" href="Identity_8cc-source.html#l00713">notice_target()</a>, <a class="el" href="Identity_8cc-source.html#l00087">pass_as_is_to_client()</a>, <a class="el" href="Identity_8cc-source.html#l00672">received_network_domain_answer()</a>, <a class="el" href="ServerSession_8cc-source.html#l00239">ServerSession::send_rejoins()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00252">ServerConnection::session_lost()</a>, <a class="el" href="Target_8cc-source.html#l00169">Target::sub_channel()</a>, and <a class="el" href="Identity_8cc-source.html#l00777">~Identity()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00208"></a>00208 { <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec" title="Pointer to the current client session.">M_client_session</a> != NULL); <span class="keywordflow">return</span> *<a class="code" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec" title="Pointer to the current client session.">M_client_session</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="291dd9d23c82cbe3aef81139f73c7782"></a><!-- doxytag: member="Identity::client_session" ref="291dd9d23c82cbe3aef81139f73c7782" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classClientSession.html">ClientSession</a>&amp; Identity::client_session           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the current <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a>. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00211">211</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, and <a class="el" href="Identity_8h-source.html#l00065">M_client_session</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00211"></a>00211 { <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec" title="Pointer to the current client session.">M_client_session</a> != NULL); <span class="keywordflow">return</span> *<a class="code" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec" title="Pointer to the current client session.">M_client_session</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="befd26ceb307699d1b4a16082fa51860"></a><!-- doxytag: member="Identity::server_session" ref="befd26ceb307699d1b4a16082fa51860" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classServerSession.html">ServerSession</a> const&amp; Identity::server_session           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the current <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a>. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00214">214</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00071">M_primary_server_connection</a>.</p>

<p>Referenced by <a class="el" href="Target_8cc-source.html#l00136">Target::add_channel()</a>, <a class="el" href="Identity_8cc-source.html#l00092">new_client_message_received()</a>, <a class="el" href="Channel_8cc-source.html#l00031">Channel::new_client_message_received()</a>, <a class="el" href="ClientSession_8cc-source.html#l00247">ClientSession::new_client_nick_received()</a>, <a class="el" href="Identity_8cc-source.html#l00278">new_server_message_received()</a>, <a class="el" href="Channel_8cc-source.html#l00082">Channel::new_server_message_received()</a>, <a class="el" href="Identity_8cc-source.html#l00063">pass_as_is_to_server()</a>, <a class="el" href="Identity_8cc-source.html#l00672">received_network_domain_answer()</a>, <a class="el" href="Target_8cc-source.html#l00190">Target::serverside_get_channel()</a>, <a class="el" href="Target_8cc-source.html#l00169">Target::sub_channel()</a>, and <a class="el" href="Identity_8cc-source.html#l00777">~Identity()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00214"></a>00214 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e" title="Our link to some server.">M_primary_server_connection</a>-&gt;server_session(); }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="499d626ba78f9c6c84adc880608784c0"></a><!-- doxytag: member="Identity::server_session" ref="499d626ba78f9c6c84adc880608784c0" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classServerSession.html">ServerSession</a>&amp; Identity::server_session           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the current <a class="el" href="classClientSession.html" title="A client session, from connect till disconnect.">ClientSession</a>. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00217">217</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00071">M_primary_server_connection</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00217"></a>00217 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e" title="Our link to some server.">M_primary_server_connection</a>-&gt;server_session(); }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5ff271e26dd0e344642033db31bd455a"></a><!-- doxytag: member="Identity::notice_target" ref="5ff271e26dd0e344642033db31bd455a" args="(question_nt number)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt; <a class="el" href="classTarget.html">Target</a> &gt; Identity::notice_target           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="question__nt_8h.html#027b743250267c94e5a1a63e0bbb3846">question_nt</a>&nbsp;</td>
          <td class="paramname"> <em>number</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a target with prefix <em>prefix</em> that is not already in the private network map. 
<p>
Return a target for ircproxy notices related to question <em>number</em>. 
<p>Definition at line <a class="el" href="Identity_8cc-source.html#l00713">713</a> of file <a class="el" href="Identity_8cc-source.html">Identity.cc</a>.</p>

<p>References <a class="el" href="ClientSession_8cc-source.html#l00196">ClientSession::add_private_target()</a>, <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="ClientSession_8h-source.html#l00083">ClientSession::client_out_nick()</a>, <a class="el" href="Identity_8h-source.html#l00208">client_session()</a>, <a class="el" href="PrivateTarget_8cc-source.html#l00218">PrivateTarget::do_names_output()</a>, <a class="el" href="is__channel_8h-source.html#l00027">is_channel()</a>, <a class="el" href="Identity_8h-source.html#l00064">M_private_network</a>, <a class="el" href="question__nt_8h-source.html#l00022">no_related_question</a>, <a class="el" href="ClientSession_8h-source.html#l00101">ClientSession::private_targets()</a>, and <a class="el" href="UserAnswer_8cc-source.html#l00027">question_target_name()</a>.</p>

<p>Referenced by <a class="el" href="Identity_8cc-source.html#l00753">send_notice()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00714"></a>00714 {
<a name="l00715"></a>00715   <span class="keywordtype">char</span> <span class="keyword">const</span>* channel_name;
<a name="l00716"></a>00716 
<a name="l00717"></a>00717   <span class="keywordflow">if</span> (number != <a class="code" href="question__nt_8h.html#027b743250267c94e5a1a63e0bbb384645b1ad115c41609a80578e43267f4cae" title="For ircproxy notices without related questions.">no_related_question</a>)
<a name="l00718"></a>00718   {
<a name="l00719"></a>00719     channel_name = <a class="code" href="UserAnswer_8cc.html#aae7ee220771f4ad3ecc9ac74c87e7b0" title="Convert question index number into the channel name it belongs to.">question_target_name</a>(number);
<a name="l00720"></a>00720     <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="is__channel_8h.html#9211aa8dc88461be45ad52d918f5782e" title="Returns true if name is a channel name.">is_channel</a>(channel_name));
<a name="l00721"></a>00721   }
<a name="l00722"></a>00722 
<a name="l00723"></a>00723   <span class="keywordflow">while</span>(1)
<a name="l00724"></a>00724   {
<a name="l00725"></a>00725     <span class="keywordflow">if</span> (number == <a class="code" href="question__nt_8h.html#027b743250267c94e5a1a63e0bbb384645b1ad115c41609a80578e43267f4cae" title="For ircproxy notices without related questions.">no_related_question</a>)
<a name="l00726"></a>00726       channel_name = <span class="stringliteral">"&amp;notices"</span>;
<a name="l00727"></a>00727     <span class="comment">// Is the client already joined?</span>
<a name="l00728"></a>00728     ClientSession::private_targets_type::iterator iter = <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#077fae5d435ae160b221805648638b4a" title="Return reference to map with private targets.">private_targets</a>().find(channel_name);
<a name="l00729"></a>00729     <span class="keywordflow">if</span> (iter != <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().private_targets().end())
<a name="l00730"></a>00730       <span class="keywordflow">return</span> iter-&gt;second;
<a name="l00731"></a>00731     <span class="keywordflow">if</span> (number == <a class="code" href="question__nt_8h.html#027b743250267c94e5a1a63e0bbb384645b1ad115c41609a80578e43267f4cae" title="For ircproxy notices without related questions.">no_related_question</a>)
<a name="l00732"></a>00732       <span class="keywordflow">break</span>;
<a name="l00733"></a>00733     number = <a class="code" href="question__nt_8h.html#027b743250267c94e5a1a63e0bbb384645b1ad115c41609a80578e43267f4cae" title="For ircproxy notices without related questions.">no_related_question</a>;
<a name="l00734"></a>00734   }
<a name="l00735"></a>00735 
<a name="l00736"></a>00736   <span class="comment">// Create the new NoticeTarget.</span>
<a name="l00737"></a>00737   <a class="code" href="classNoticeTarget.html" title="A fake channel that is used for communication between user and ircproxy.">NoticeTarget</a>* new_notice_target = <span class="keyword">new</span> <a class="code" href="classNoticeTarget.html" title="A fake channel that is used for communication between user and ircproxy.">NoticeTarget</a>(<a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>(), channel_name, <a class="code" href="classIdentity.html#076ec46fbabd783e3712179c5b521fb2" title="Fake network, private to this identity.">M_private_network</a>);
<a name="l00738"></a>00738   AllocTag(new_notice_target, channel_name);
<a name="l00739"></a>00739   <span class="comment">// Add it to the private targets map.</span>
<a name="l00740"></a>00740   boost::shared_ptr&lt;Target&gt; private_target(new_notice_target);
<a name="l00741"></a>00741   <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#a9e5f7a673d2a42a98328b55ffa2864e" title="Add target to the private targets list.">add_private_target</a>(private_target);
<a name="l00742"></a>00742   <span class="comment">// Have the client join it.</span>
<a name="l00743"></a>00743   <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>() &lt;&lt; <span class="stringliteral">":"</span> &lt;&lt; <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#8f4367fccef8c55504cacbe0191e55ca" title="FIXME.">client_out_nick</a>() &lt;&lt; <span class="stringliteral">" JOIN "</span> &lt;&lt; channel_name &lt;&lt; <span class="stringliteral">"\r\n"</span>;
<a name="l00744"></a>00744   new_notice_target-&gt;<a class="code" href="classPrivateTarget.html#6fc110a3a167748ea9ff0bd48ab7b40d" title="Generate the NAMES reply for the associated channel.">do_names_output</a>();
<a name="l00745"></a>00745 
<a name="l00746"></a>00746   <span class="keywordflow">return</span> private_target;
<a name="l00747"></a>00747 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="bf3c39a512dcf261dff344aa87d4cceb"></a><!-- doxytag: member="Identity::server_connection" ref="bf3c39a512dcf261dff344aa87d4cceb" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classServerConnection.html">ServerConnection</a> const&amp; Identity::server_connection           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the primary server connection object. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00226">226</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00071">M_primary_server_connection</a>.</p>

<p>Referenced by <a class="el" href="Target_8cc-source.html#l00136">Target::add_channel()</a>, <a class="el" href="Target_8cc-source.html#l00073">Target::add_joined_nick()</a>, <a class="el" href="Target_8cc-source.html#l00054">Target::get_joined_nick()</a>, <a class="el" href="Identity_8h-source.html#l00189">network()</a>, <a class="el" href="Identity_8cc-source.html#l00092">new_client_message_received()</a>, <a class="el" href="Identity_8cc-source.html#l00278">new_server_message_received()</a>, <a class="el" href="Identity_8cc-source.html#l00063">pass_as_is_to_server()</a>, and <a class="el" href="Authentication_8cc-source.html#l00087">Authentication::received_nick_and_user()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00226"></a>00226 { <span class="keywordflow">return</span> *<a class="code" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e" title="Our link to some server.">M_primary_server_connection</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="1d3694b7ac3fb7700c2936eece7ae1f9"></a><!-- doxytag: member="Identity::server_connection" ref="1d3694b7ac3fb7700c2936eece7ae1f9" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classServerConnection.html">ServerConnection</a>&amp; Identity::server_connection           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the primary server connection object. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00229">229</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00071">M_primary_server_connection</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00229"></a>00229 { <span class="keywordflow">return</span> *<a class="code" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e" title="Our link to some server.">M_primary_server_connection</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="66f02133fc21be71cbfeb3512a130005"></a><!-- doxytag: member="Identity::start_secondary_server_connection" ref="66f02133fc21be71cbfeb3512a130005" args="(boost::shared_ptr&lt; Server &gt; new_server)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::start_secondary_server_connection           </td>
          <td>(</td>
          <td class="paramtype">boost::shared_ptr&lt; <a class="el" href="classServer.html">Server</a> &gt;&nbsp;</td>
          <td class="paramname"> <em>new_server</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Start a secondary server connection, which will take over the primary once connected. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00232">232</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="Identity_8h-source.html#l00271">has_secondary_server_connection()</a>, and <a class="el" href="Identity_8h-source.html#l00072">M_secondary_server_connection</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00233"></a>00233       {
<a name="l00234"></a>00234         <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(!<a class="code" href="classIdentity.html#d40e92b33971cd656d12f417cf90ef73" title="Return true if this identity is associated with a secondary server connection.">has_secondary_server_connection</a>());
<a name="l00235"></a>00235 <span class="preprocessor">#ifdef CWDEBUG</span>
<a name="l00236"></a>00236 <span class="preprocessor"></span>        <span class="comment">// Mark that we are about to start handling a secondary connection.</span>
<a name="l00237"></a>00237         <a class="code" href="structdebug_1_1SecondaryConnection.html">debug::SecondaryConnection</a> dummy(<span class="keyword">true</span>);
<a name="l00238"></a>00238 <span class="preprocessor">#endif</span>
<a name="l00239"></a>00239 <span class="preprocessor"></span>        <a class="code" href="classIdentity.html#3488da7856d81c986421922eff667072" title="Link to a secondary server connection in progress, or NULL when none.">M_secondary_server_connection</a>.reset(NEW(<a class="code" href="classServerConnection.html" title="Object representing the server-side connection.">ServerConnection</a>(<span class="keyword">this</span>, new_server)));
<a name="l00240"></a>00240         <a class="code" href="classIdentity.html#3488da7856d81c986421922eff667072" title="Link to a secondary server connection in progress, or NULL when none.">M_secondary_server_connection</a>-&gt;connect(<span class="keyword">false</span>);
<a name="l00241"></a>00241       } 
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="940746ce01ed023a81ec25b6c942c760"></a><!-- doxytag: member="Identity::swap_primary_and_secondary_connection" ref="940746ce01ed023a81ec25b6c942c760" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::swap_primary_and_secondary_connection           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Swap primary and secondary connection. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00244">244</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00071">M_primary_server_connection</a>, and <a class="el" href="Identity_8h-source.html#l00072">M_secondary_server_connection</a>.</p>

<p>Referenced by <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00245"></a>00245       {
<a name="l00246"></a>00246         std::swap(<a class="code" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e" title="Our link to some server.">M_primary_server_connection</a>, <a class="code" href="classIdentity.html#3488da7856d81c986421922eff667072" title="Link to a secondary server connection in progress, or NULL when none.">M_secondary_server_connection</a>);
<a name="l00247"></a>00247         <a class="code" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e" title="Our link to some server.">M_primary_server_connection</a>-&gt;make_primary();
<a name="l00248"></a>00248         <a class="code" href="classIdentity.html#3488da7856d81c986421922eff667072" title="Link to a secondary server connection in progress, or NULL when none.">M_secondary_server_connection</a>-&gt;make_secondary();
<a name="l00249"></a>00249       }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6d80fc2efac0ed1f575183c3e471488b"></a><!-- doxytag: member="Identity::end_secondary_server_connection" ref="6d80fc2efac0ed1f575183c3e471488b" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::end_secondary_server_connection           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Terminate the secondary connection. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00252">252</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="Identity_8h-source.html#l00271">has_secondary_server_connection()</a>, and <a class="el" href="Identity_8h-source.html#l00072">M_secondary_server_connection</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00253"></a>00253       {
<a name="l00254"></a>00254         <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classIdentity.html#d40e92b33971cd656d12f417cf90ef73" title="Return true if this identity is associated with a secondary server connection.">has_secondary_server_connection</a>());
<a name="l00255"></a>00255 <span class="preprocessor">#ifdef CWDEBUG</span>
<a name="l00256"></a>00256 <span class="preprocessor"></span>        <span class="comment">// Mark that we are about to start handling a secondary connection.</span>
<a name="l00257"></a>00257         <a class="code" href="structdebug_1_1SecondaryConnection.html">debug::SecondaryConnection</a> dummy(<span class="keyword">true</span>);
<a name="l00258"></a>00258 <span class="preprocessor">#endif</span>
<a name="l00259"></a>00259 <span class="preprocessor"></span>        <a class="code" href="classIdentity.html#3488da7856d81c986421922eff667072" title="Link to a secondary server connection in progress, or NULL when none.">M_secondary_server_connection</a>-&gt;disconnect();    <span class="comment">// This will result in ServerConnection::session_lost being called,</span>
<a name="l00260"></a>00260                                                         <span class="comment">// which will call destroy_secondary_server_connection().</span>
<a name="l00261"></a>00261       }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d40e92b33971cd656d12f417cf90ef73"></a><!-- doxytag: member="Identity::has_secondary_server_connection" ref="d40e92b33971cd656d12f417cf90ef73" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Identity::has_secondary_server_connection           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if this identity is associated with a secondary server connection. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00271">271</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00072">M_secondary_server_connection</a>.</p>

<p>Referenced by <a class="el" href="Identity_8h-source.html#l00252">end_secondary_server_connection()</a>, and <a class="el" href="Identity_8h-source.html#l00232">start_secondary_server_connection()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00271"></a>00271 { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#3488da7856d81c986421922eff667072" title="Link to a secondary server connection in progress, or NULL when none.">M_secondary_server_connection</a>.get(); }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="dcace57442141b0264f670f5e944f9a9"></a><!-- doxytag: member="Identity::secondary_server_connection" ref="dcace57442141b0264f670f5e944f9a9" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classServerConnection.html">ServerConnection</a> const&gt; Identity::secondary_server_connection           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the secondary server connection. Only valid if has_secondary_server_connection returns true. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00274">274</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00072">M_secondary_server_connection</a>.</p>

<p>Referenced by <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00275"></a>00275       { <span class="keywordflow">return</span> boost::const_pointer_cast&lt;<a class="code" href="classServerConnection.html" title="Object representing the server-side connection.">ServerConnection</a> <span class="keyword">const</span>&gt;(<a class="code" href="classIdentity.html#3488da7856d81c986421922eff667072" title="Link to a secondary server connection in progress, or NULL when none.">M_secondary_server_connection</a>); }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="68ae8e741b9b8f2ec0db8b427e2ae7b3"></a><!-- doxytag: member="Identity::secondary_server_connection" ref="68ae8e741b9b8f2ec0db8b427e2ae7b3" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classServerConnection.html">ServerConnection</a>&gt; Identity::secondary_server_connection           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the secondary server connection. Only valid if has_secondary_server_connection returns true. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00278">278</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00072">M_secondary_server_connection</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00279"></a>00279       { <span class="keywordflow">return</span> <a class="code" href="classIdentity.html#3488da7856d81c986421922eff667072" title="Link to a secondary server connection in progress, or NULL when none.">M_secondary_server_connection</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b94224aa9917eafb7885d0411cf4bfd9"></a><!-- doxytag: member="Identity::authentication" ref="b94224aa9917eafb7885d0411cf4bfd9" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAuthentication.html">Authentication</a> const&amp; Identity::authentication           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the authentication object. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00282">282</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00061">M_authentication</a>.</p>

<p>Referenced by <a class="el" href="AuthState_8cc-source.html#l00028">AuthState::AuthState()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00377">ServerConnection::invisible_event()</a>, and <a class="el" href="ClientSession_8cc-source.html#l00247">ClientSession::new_client_nick_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00282"></a>00282 { <span class="keywordflow">return</span> *<a class="code" href="classIdentity.html#9d54312b39f830b32eee7b9bbe519695" title="Temporary authentication token, or NULL.">M_authentication</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7c580cba7e4e76f027a848dfca13469c"></a><!-- doxytag: member="Identity::authentication" ref="7c580cba7e4e76f027a848dfca13469c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAuthentication.html">Authentication</a>&amp; Identity::authentication           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the authentication object. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00285">285</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00061">M_authentication</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00285"></a>00285 { <span class="keywordflow">return</span> *<a class="code" href="classIdentity.html#9d54312b39f830b32eee7b9bbe519695" title="Temporary authentication token, or NULL.">M_authentication</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ad20e55e2b6fbe3022e63c3223abae08"></a><!-- doxytag: member="Identity::send_notice" ref="ad20e55e2b6fbe3022e63c3223abae08" args="(std::string const &amp;notice, question_nt number=no_related_question)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::send_notice           </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&nbsp;</td>
          <td class="paramname"> <em>notice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="question__nt_8h.html#027b743250267c94e5a1a63e0bbb3846">question_nt</a>&nbsp;</td>
          <td class="paramname"> <em>number</em> = <code>no_related_question</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send a notice to the client. 
<p>

<p>Definition at line <a class="el" href="Identity_8cc-source.html#l00753">753</a> of file <a class="el" href="Identity_8cc-source.html">Identity.cc</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00065">M_client_session</a>, and <a class="el" href="Identity_8cc-source.html#l00713">notice_target()</a>.</p>

<p>Referenced by <a class="el" href="ServerSession_8cc-source.html#l00442">ServerSession::construct_network_object()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00149">ServerConnection::do_connect()</a>, <a class="el" href="ServerSession_8cc-source.html#l00389">ServerSession::found_network_name()</a>, <a class="el" href="ServerSession_8cc-source.html#l00521">ServerSession::network_connection_terminated()</a>, and <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00754"></a>00754 {
<a name="l00755"></a>00755   *<a class="code" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec" title="Pointer to the current client session.">M_client_session</a> &lt;&lt; <span class="stringliteral">":Leandro PRIVMSG "</span> &lt;&lt; <a class="code" href="classIdentity.html#5ff271e26dd0e344642033db31bd455a" title="Return a target with prefix prefix that is not already in the private network map...">notice_target</a>(number)-&gt;out_name(*<a class="code" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec" title="Pointer to the current client session.">M_client_session</a>)  &lt;&lt; <span class="stringliteral">" :"</span> &lt;&lt; notice &lt;&lt; <span class="stringliteral">"\r\n"</span>;
<a name="l00756"></a>00756 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="aa0444d422ef667a1c57b9c883b0d3e3"></a><!-- doxytag: member="Identity::received_network_domain_answer" ref="aa0444d422ef667a1c57b9c883b0d3e3" args="(UserAnswerEventType const &amp;event_type, std::pair&lt; std::string, std::string &gt; network_domain)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::received_network_domain_answer           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classUserAnswerEventType.html">UserAnswerEventType</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>event_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::pair&lt; std::string, std::string &gt;&nbsp;</td>
          <td class="paramname"> <em>network_domain</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Event call back: network domain answer received. Process it. 
<p>

<p>Definition at line <a class="el" href="Identity_8cc-source.html#l00672">672</a> of file <a class="el" href="Identity_8cc-source.html">Identity.cc</a>.</p>

<p>References <a class="el" href="UserAnswer_8h-source.html#l00041">UserAnswer::answer()</a>, <a class="el" href="Identity_8h-source.html#l00208">client_session()</a>, <a class="el" href="ServerSession_8cc-source.html#l00442">ServerSession::construct_network_object()</a>, <a class="el" href="debug_8h-source.html#l00214">DoutEntering</a>, <a class="el" href="IRC__compare_8cc-source.html#l00025">IRCStringCompare()</a>, <a class="el" href="question__nt_8h-source.html#l00024">network_domain_question</a>, <a class="el" href="Identity_8h-source.html#l00214">server_session()</a>, and <a class="el" href="ClientSession_8h-source.html#l00062">ClientSession::user_answer_event_server</a>.</p>

<p>Referenced by <a class="el" href="ServerSession_8cc-source.html#l00389">ServerSession::found_network_name()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00674"></a>00674 {
<a name="l00675"></a>00675   <a class="code" href="debug_8h.html#3dc350a548c074386c3ec0271d16a7a8" title="Debugging macro.">DoutEntering</a>(dc::debug, <span class="stringliteral">"Identity::received_network_domain_answer("</span> &lt;&lt; event_type);
<a name="l00676"></a>00676   std::string answer = event_type.answer();
<a name="l00677"></a>00677   <span class="keywordtype">bool</span> yes = <a class="code" href="IRC__compare_8cc.html#e5bfa2bc25ca9272eb0ec51ad508e369" title="Compare two whole IRC strings in a &amp;#39;case insensitive&amp;#39; way.">IRCStringCompare</a>(answer, <span class="stringliteral">"Yes"</span>) == 0;
<a name="l00678"></a>00678   <span class="keywordtype">bool</span> no = <a class="code" href="IRC__compare_8cc.html#e5bfa2bc25ca9272eb0ec51ad508e369" title="Compare two whole IRC strings in a &amp;#39;case insensitive&amp;#39; way.">IRCStringCompare</a>(answer, <span class="stringliteral">"No"</span>) == 0;
<a name="l00679"></a>00679   <span class="keywordflow">if</span> (!yes &amp;&amp; !no)
<a name="l00680"></a>00680   {
<a name="l00681"></a>00681     std::ostringstream the_question;
<a name="l00682"></a>00682     the_question &lt;&lt; <span class="stringliteral">"Does the "</span> &lt;&lt; network_domain.first &lt;&lt; <span class="stringliteral">" IRC network use \""</span> &lt;&lt;
<a name="l00683"></a>00683         network_domain.second &lt;&lt; <span class="stringliteral">"\" as common domain for all servers (type: Yes|No)?"</span>;
<a name="l00684"></a>00684     <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#c6c444fa618e12e0be321c5e75f20a84" title="The UserAnswer event server.">user_answer_event_server</a>
<a name="l00685"></a>00685         (<a class="code" href="classUserAnswerRequestData.html" title="Request data passed to the event server.">UserAnswerRequestData</a>(<a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>(), <a class="code" href="question__nt_8h.html#027b743250267c94e5a1a63e0bbb3846eb206c8874855d785e917a62c3181851" title="Does this network use s as common domain for all servers (type: Yes | No)?">network_domain_question</a>, the_question.str()),
<a name="l00686"></a>00686         *<span class="keyword">this</span>, &amp;<a class="code" href="classIdentity.html#aa0444d422ef667a1c57b9c883b0d3e3" title="Event call back: network domain answer received. Process it.">Identity::received_network_domain_answer</a>, network_domain);
<a name="l00687"></a>00687   }
<a name="l00688"></a>00688   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (no)
<a name="l00689"></a>00689     <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#924f17d7e20c4ed84a13f2212a52a84a" title="Create a new network object with name network_name and domain domain (if any).">construct_network_object</a>(network_domain.first, <span class="stringliteral">""</span>);
<a name="l00690"></a>00690   <span class="keywordflow">else</span>
<a name="l00691"></a>00691     <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>().<a class="code" href="classServerSession.html#924f17d7e20c4ed84a13f2212a52a84a" title="Create a new network object with name network_name and domain domain (if any).">construct_network_object</a>(network_domain.first, network_domain.second);
<a name="l00692"></a>00692 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6322ad040f46c004b07acedc6a4d8e89"></a><!-- doxytag: member="Identity::pass_as_is_to_server" ref="6322ad040f46c004b07acedc6a4d8e89" args="(ClientMessageIn const &amp;msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::pass_as_is_to_server           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classClientMessageIn.html">ClientMessageIn</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write <a class="el" href="classClientMessageIn.html" title="An IRC message as received from a client.">ClientMessageIn</a> <em>msg</em> to the server. 
<p>

<p>Definition at line <a class="el" href="Identity_8cc-source.html#l00063">63</a> of file <a class="el" href="Identity_8cc-source.html">Identity.cc</a>.</p>

<p>References <a class="el" href="MessageIn_8h-source.html#l00100">MessageIn::key()</a>, <a class="el" href="Identity_8cc-source.html#l00040">pass_as_is_to()</a>, <a class="el" href="ServerConnection_8h-source.html#l00043">real_nick_sent</a>, <a class="el" href="Identity_8h-source.html#l00226">server_connection()</a>, <a class="el" href="Identity_8h-source.html#l00214">server_session()</a>, <a class="el" href="ServerConnection_8h-source.html#l00120">ServerConnection::state()</a>, and <a class="el" href="exceptions_8h-source.html#l00110">THROW_EXCEPTION</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00064"></a>00064 {
<a name="l00065"></a>00065   <span class="keywordtype">bool</span> blocked = <span class="keyword">true</span>;
<a name="l00066"></a>00066   <span class="keywordflow">switch</span> (msg.key())
<a name="l00067"></a>00067   {
<a name="l00068"></a>00068     <span class="keyword">using namespace </span>keys;
<a name="l00069"></a>00069     <span class="keywordflow">case</span> WHO:                   <span class="comment">// Query</span>
<a name="l00070"></a>00070     <span class="keywordflow">case</span> WHOIS:                 <span class="comment">// Query</span>
<a name="l00071"></a>00071     <span class="keywordflow">case</span> WHOWAS:                <span class="comment">// Query</span>
<a name="l00072"></a>00072       blocked = <span class="keyword">false</span>;
<a name="l00073"></a>00073       <span class="keywordflow">break</span>;
<a name="l00074"></a>00074     <span class="keywordflow">default</span>:
<a name="l00075"></a>00075       <span class="keywordflow">break</span>;
<a name="l00076"></a>00076   }
<a name="l00077"></a>00077   <span class="keywordflow">if</span> (blocked &amp;&amp; <a class="code" href="classIdentity.html#bf3c39a512dcf261dff344aa87d4cceb" title="Return the primary server connection object.">server_connection</a>().<a class="code" href="classServerConnection.html#46893748168791f5ec68caca30b07af1" title="Return the state of the connection.">state</a>() &lt; <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef23fcdc806883284d1121056468515dc4d" title="NICK with real nick name sent.">real_nick_sent</a>)
<a name="l00078"></a>00078     <a class="code" href="exceptions_8h.html#038a5f95e87598cdf451fa27eca0601c" title="Throw an exception.">THROW_EXCEPTION</a>(<a class="code" href="classFatalError.html" title="An exception class.">FatalError</a>(<span class="stringliteral">"Message to be passed as-is is blocked!"</span>),
<a name="l00079"></a>00079         <span class="stringliteral">"Identity::pass_as_is_to_server("</span> &lt;&lt; msg &lt;&lt; <span class="stringliteral">") called while server connection in state "</span> &lt;&lt; <a class="code" href="classIdentity.html#bf3c39a512dcf261dff344aa87d4cceb" title="Return the primary server connection object.">server_connection</a>().<a class="code" href="classServerConnection.html#46893748168791f5ec68caca30b07af1" title="Return the state of the connection.">state</a>() &lt;&lt; <span class="charliteral">'!'</span>);
<a name="l00080"></a>00080   <a class="code" href="classIdentity.html#332b96a519b9fc1475904db577f3c280" title="Write MessageIn msg to the ostream os.">pass_as_is_to</a>(msg, <a class="code" href="classIdentity.html#befd26ceb307699d1b4a16082fa51860" title="Return the current ClientSession.">server_session</a>());
<a name="l00081"></a>00081 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5b6ed690dca4101538b7b8e03b3fb3c7"></a><!-- doxytag: member="Identity::pass_as_is_to_client" ref="5b6ed690dca4101538b7b8e03b3fb3c7" args="(ServerMessageIn const &amp;msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::pass_as_is_to_client           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classServerMessageIn.html">ServerMessageIn</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write <a class="el" href="classServerMessageIn.html" title="An IRC message as received from a server.">ServerMessageIn</a> <em>msg</em> to the client. 
<p>

<p>Definition at line <a class="el" href="Identity_8cc-source.html#l00087">87</a> of file <a class="el" href="Identity_8cc-source.html">Identity.cc</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00208">client_session()</a>, and <a class="el" href="Identity_8cc-source.html#l00040">pass_as_is_to()</a>.</p>

<p>Referenced by <a class="el" href="Identity_8cc-source.html#l00278">new_server_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00088"></a>00088 {
<a name="l00089"></a>00089   <a class="code" href="classIdentity.html#332b96a519b9fc1475904db577f3c280" title="Write MessageIn msg to the ostream os.">pass_as_is_to</a>(msg, <a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>());
<a name="l00090"></a>00090 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="332b96a519b9fc1475904db577f3c280"></a><!-- doxytag: member="Identity::pass_as_is_to" ref="332b96a519b9fc1475904db577f3c280" args="(MessageIn const &amp;msg, std::ostream &amp;os)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Identity::pass_as_is_to           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMessageIn.html">MessageIn</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>os</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write <a class="el" href="classMessageIn.html" title="An IRC message as received from client or server.">MessageIn</a> <em>msg</em> to the ostream <em>os</em>. 
<p>

<p>Definition at line <a class="el" href="Identity_8cc-source.html#l00040">40</a> of file <a class="el" href="Identity_8cc-source.html">Identity.cc</a>.</p>

<p>References <a class="el" href="MessageIn_8h-source.html#l00121">MessageIn::has_prefix()</a>, <a class="el" href="MessageIn_8h-source.html#l00094">MessageIn::is_numeric()</a>, <a class="el" href="MessageIn_8h-source.html#l00097">MessageIn::numeric()</a>, <a class="el" href="MessageIn_8h-source.html#l00109">MessageIn::param()</a>, <a class="el" href="MessageIn_8h-source.html#l00103">MessageIn::params_size()</a>, <a class="el" href="MessageIn_8h-source.html#l00124">MessageIn::prefix_str()</a>, and <a class="el" href="MessageIn_8h-source.html#l00140">MessageIn::uppercase_command()</a>.</p>

<p>Referenced by <a class="el" href="Identity_8cc-source.html#l00087">pass_as_is_to_client()</a>, and <a class="el" href="Identity_8cc-source.html#l00063">pass_as_is_to_server()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00041"></a>00041 {
<a name="l00042"></a>00042   <span class="keywordflow">if</span> (msg.has_prefix())
<a name="l00043"></a>00043     os &lt;&lt; <span class="charliteral">':'</span> &lt;&lt; msg.prefix_str() &lt;&lt; <span class="charliteral">' '</span>;
<a name="l00044"></a>00044   <span class="keywordflow">if</span> (msg.is_numeric())
<a name="l00045"></a>00045     os &lt;&lt; msg.numeric();
<a name="l00046"></a>00046   <span class="keywordflow">else</span>
<a name="l00047"></a>00047     os &lt;&lt; msg.uppercase_command();
<a name="l00048"></a>00048   <span class="keywordtype">int</span> number_of_parameters = msg.params_size();
<a name="l00049"></a>00049   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> param = 0; param &lt; number_of_parameters; ++param)
<a name="l00050"></a>00050   {
<a name="l00051"></a>00051     os &lt;&lt; <span class="charliteral">' '</span>;
<a name="l00052"></a>00052     <span class="keywordflow">if</span> (param == number_of_parameters - 1)
<a name="l00053"></a>00053       os &lt;&lt; <span class="charliteral">':'</span>;
<a name="l00054"></a>00054     os &lt;&lt; msg.param(param);
<a name="l00055"></a>00055   }
<a name="l00056"></a>00056   os &lt;&lt; <span class="stringliteral">"\r\n"</span>;
<a name="l00057"></a>00057 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Friends And Related Function Documentation</h2>
<a class="anchor" name="3771af741a704fd3fc316a63ad6d0269"></a><!-- doxytag: member="Identity::operator&lt;&lt;" ref="3771af741a704fd3fc316a63ad6d0269" args="(std::ostream &amp;os, Identity const &amp;identity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt;           </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classIdentity.html">Identity</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>identity</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
For debugging purposes. Write a <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a> to <em>os</em>. 
<p>

<p>Definition at line <a class="el" href="debug__ostream__operators_8cc-source.html#l00294">294</a> of file <a class="el" href="debug__ostream__operators_8cc-source.html">debug_ostream_operators.cc</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00295"></a>00295 {
<a name="l00296"></a>00296   os &lt;&lt; <span class="stringliteral">"{key:"</span> &lt;&lt; identity.M_key;
<a name="l00297"></a>00297 <span class="preprocessor">#ifdef VERBOSE_IDENTITY</span>
<a name="l00298"></a>00298 <span class="preprocessor"></span><span class="preprocessor">#ifdef PRINT_AUTHENTICATION</span>
<a name="l00299"></a>00299 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (identity.M_authentication.get())
<a name="l00300"></a>00300     os &lt;&lt; <span class="stringliteral">", authentication:"</span> &lt;&lt; *identity.M_authentication.get();
<a name="l00301"></a>00301   os &lt;&lt; <span class="stringliteral">", server_connection:"</span> &lt;&lt; identity.M_server_connection;
<a name="l00302"></a>00302   <span class="keywordflow">if</span> (!identity.M_authpass.empty())
<a name="l00303"></a>00303     os &lt;&lt; <span class="stringliteral">", authpass:"</span> &lt;&lt; identity.M_authpass;
<a name="l00304"></a>00304 #endif
<a name="l00305"></a>00305   os &lt;&lt; <span class="stringliteral">", private_network:"</span> &lt;&lt; identity.M_private_network;
<a name="l00306"></a>00306   if (identity.M_client_session)
<a name="l00307"></a>00307     os &lt;&lt; <span class="stringliteral">", client_session:"</span> &lt;&lt; *identity.M_client_session;
<a name="l00308"></a>00308   os &lt;&lt; <span class="stringliteral">", ident:\""</span> &lt;&lt; identity.M_ident &lt;&lt;
<a name="l00309"></a>00309         <span class="stringliteral">"\", hostname:\""</span> &lt;&lt; identity.M_hostname &lt;&lt;
<a name="l00310"></a>00310         <span class="stringliteral">"\", real_name:\""</span> &lt;&lt; identity.M_real_name &lt;&lt;
<a name="l00311"></a>00311         <span class="stringliteral">"\", network_name:\""</span> &lt;&lt; identity.M_network_name &lt;&lt; <span class="charliteral">'"'</span>;
<a name="l00312"></a>00312 <span class="preprocessor">#endif</span>
<a name="l00313"></a>00313 <span class="preprocessor"></span>  os &lt;&lt; <span class="charliteral">'}'</span>;
<a name="l00314"></a>00314   <span class="keywordflow">return</span> os;
<a name="l00315"></a>00315 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="97c1e362cf7d2b6af2795157fc224dbc"></a><!-- doxytag: member="Identity::M_key" ref="97c1e362cf7d2b6af2795157fc224dbc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classIdentity.html#97c1e362cf7d2b6af2795157fc224dbc">Identity::M_key</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The unique identity key as used with the identity map. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00060">60</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>Referenced by <a class="el" href="Identity_8h-source.html#l00126">key()</a>, <a class="el" href="debug__ostream__operators_8cc-source.html#l00294">operator&lt;&lt;()</a>, and <a class="el" href="Identity_8cc-source.html#l00770">serialize()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9d54312b39f830b32eee7b9bbe519695"></a><!-- doxytag: member="Identity::M_authentication" ref="9d54312b39f830b32eee7b9bbe519695" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classAuthentication.html">Authentication</a>&gt; <a class="el" href="classIdentity.html#9d54312b39f830b32eee7b9bbe519695">Identity::M_authentication</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Temporary authentication token, or NULL. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00061">61</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>Referenced by <a class="el" href="Identity_8h-source.html#l00282">authentication()</a>, <a class="el" href="Identity_8cc-source.html#l00092">new_client_message_received()</a>, and <a class="el" href="debug__ostream__operators_8cc-source.html#l00294">operator&lt;&lt;()</a>.</p>

</div>
</div><p>
<a class="anchor" name="7015e844fccbd42d8587e2939403c4e8"></a><!-- doxytag: member="Identity::M_mynick" ref="7015e844fccbd42d8587e2939403c4e8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classNick.html">Nick</a>&gt; <a class="el" href="classIdentity.html#7015e844fccbd42d8587e2939403c4e8">Identity::M_mynick</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pointer to the <a class="el" href="classNick.html" title="A nick name.">Nick</a> object representing my own nick. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00062">62</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>Referenced by <a class="el" href="Identity_8h-source.html#l00106">Identity()</a>, and <a class="el" href="Identity_8h-source.html#l00135">mynick()</a>.</p>

</div>
</div><p>
<a class="anchor" name="1607f2b4aa110ef7b92b07d4daa4cd31"></a><!-- doxytag: member="Identity::M_authpass" ref="1607f2b4aa110ef7b92b07d4daa4cd31" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classIdentity.html#1607f2b4aa110ef7b92b07d4daa4cd31">Identity::M_authpass</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="classAuthentication.html" title="Authentication token.">Authentication</a> password. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00063">63</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>Referenced by <a class="el" href="Identity_8h-source.html#l00180">authentication_password()</a>, <a class="el" href="Identity_8h-source.html#l00177">has_authentication_password()</a>, <a class="el" href="debug__ostream__operators_8cc-source.html#l00294">operator&lt;&lt;()</a>, and <a class="el" href="Identity_8cc-source.html#l00770">serialize()</a>.</p>

</div>
</div><p>
<a class="anchor" name="076ec46fbabd783e3712179c5b521fb2"></a><!-- doxytag: member="Identity::M_private_network" ref="076ec46fbabd783e3712179c5b521fb2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNetwork.html">Network</a> <a class="el" href="classIdentity.html#076ec46fbabd783e3712179c5b521fb2">Identity::M_private_network</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Fake network, private to this identity. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00064">64</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>Referenced by <a class="el" href="Identity_8cc-source.html#l00713">notice_target()</a>, <a class="el" href="debug__ostream__operators_8cc-source.html#l00294">operator&lt;&lt;()</a>, and <a class="el" href="Identity_8h-source.html#l00183">private_network()</a>.</p>

</div>
</div><p>
<a class="anchor" name="f1854ef005559a4a7bfa10e0f037e7ec"></a><!-- doxytag: member="Identity::M_client_session" ref="f1854ef005559a4a7bfa10e0f037e7ec" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classClientSession.html">ClientSession</a>* <a class="el" href="classIdentity.html#f1854ef005559a4a7bfa10e0f037e7ec">Identity::M_client_session</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pointer to the current client session. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00065">65</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>Referenced by <a class="el" href="Identity_8h-source.html#l00208">client_session()</a>, <a class="el" href="Identity_8h-source.html#l00202">has_client_session()</a>, <a class="el" href="debug__ostream__operators_8cc-source.html#l00294">operator&lt;&lt;()</a>, <a class="el" href="Identity_8h-source.html#l00198">reset_client_session()</a>, <a class="el" href="Identity_8cc-source.html#l00753">send_notice()</a>, and <a class="el" href="Identity_8h-source.html#l00195">set_client_session()</a>.</p>

</div>
</div><p>
<a class="anchor" name="0bfddc02b548d71e42a073e265e26221"></a><!-- doxytag: member="Identity::M_ident" ref="0bfddc02b548d71e42a073e265e26221" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classIdentity.html#0bfddc02b548d71e42a073e265e26221">Identity::M_ident</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
A best-guess for this users ident. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00066">66</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>Referenced by <a class="el" href="Identity_8h-source.html#l00144">ident()</a>, <a class="el" href="Identity_8cc-source.html#l00092">new_client_message_received()</a>, <a class="el" href="debug__ostream__operators_8cc-source.html#l00294">operator&lt;&lt;()</a>, and <a class="el" href="Identity_8h-source.html#l00159">set_ident()</a>.</p>

</div>
</div><p>
<a class="anchor" name="639a3cb121a2e8be9ac762260715349c"></a><!-- doxytag: member="Identity::M_real_hostname" ref="639a3cb121a2e8be9ac762260715349c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classIdentity.html#639a3cb121a2e8be9ac762260715349c">Identity::M_real_hostname</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
A best-guess for this users real hostname. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00067">67</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>Referenced by <a class="el" href="Identity_8h-source.html#l00147">real_hostname()</a>, and <a class="el" href="Identity_8h-source.html#l00163">set_real_hostname()</a>.</p>

</div>
</div><p>
<a class="anchor" name="abffc9e26b5ad1094c8dfeecadf97031"></a><!-- doxytag: member="Identity::M_hostname" ref="abffc9e26b5ad1094c8dfeecadf97031" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classIdentity.html#abffc9e26b5ad1094c8dfeecadf97031">Identity::M_hostname</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
A best-guess for this users (cloaked) hostname. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00068">68</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>Referenced by <a class="el" href="Identity_8h-source.html#l00150">hostname()</a>, <a class="el" href="debug__ostream__operators_8cc-source.html#l00294">operator&lt;&lt;()</a>, and <a class="el" href="Identity_8h-source.html#l00167">set_hostname()</a>.</p>

</div>
</div><p>
<a class="anchor" name="737a886f8703407d1344fc4c62d7aff2"></a><!-- doxytag: member="Identity::M_real_name" ref="737a886f8703407d1344fc4c62d7aff2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classIdentity.html#737a886f8703407d1344fc4c62d7aff2">Identity::M_real_name</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
A best-guess for this users real name. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00069">69</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>Referenced by <a class="el" href="Identity_8cc-source.html#l00092">new_client_message_received()</a>, <a class="el" href="debug__ostream__operators_8cc-source.html#l00294">operator&lt;&lt;()</a>, <a class="el" href="Identity_8h-source.html#l00153">real_name()</a>, and <a class="el" href="Identity_8h-source.html#l00171">set_real_name()</a>.</p>

</div>
</div><p>
<a class="anchor" name="4f1fe5439749a78e03086cdfe58a9a6f"></a><!-- doxytag: member="Identity::M_network_name" ref="4f1fe5439749a78e03086cdfe58a9a6f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classIdentity.html#4f1fe5439749a78e03086cdfe58a9a6f">Identity::M_network_name</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The network name that corresponds to this identity. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00070">70</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>Referenced by <a class="el" href="Identity_8h-source.html#l00156">network_name()</a>, <a class="el" href="debug__ostream__operators_8cc-source.html#l00294">operator&lt;&lt;()</a>, <a class="el" href="Identity_8cc-source.html#l00770">serialize()</a>, and <a class="el" href="Identity_8h-source.html#l00174">set_network_name()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b66b41d74f2cce6a8937974eba2f052e"></a><!-- doxytag: member="Identity::M_primary_server_connection" ref="b66b41d74f2cce6a8937974eba2f052e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classServerConnection.html">ServerConnection</a>&gt; <a class="el" href="classIdentity.html#b66b41d74f2cce6a8937974eba2f052e">Identity::M_primary_server_connection</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Our link to some server. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00071">71</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>Referenced by <a class="el" href="Identity_8h-source.html#l00205">has_server_session()</a>, <a class="el" href="Identity_8h-source.html#l00226">server_connection()</a>, <a class="el" href="Identity_8h-source.html#l00214">server_session()</a>, <a class="el" href="Identity_8cc-source.html#l00759">server_source()</a>, and <a class="el" href="Identity_8h-source.html#l00244">swap_primary_and_secondary_connection()</a>.</p>

</div>
</div><p>
<a class="anchor" name="3488da7856d81c986421922eff667072"></a><!-- doxytag: member="Identity::M_secondary_server_connection" ref="3488da7856d81c986421922eff667072" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classServerConnection.html">ServerConnection</a>&gt; <a class="el" href="classIdentity.html#3488da7856d81c986421922eff667072">Identity::M_secondary_server_connection</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Link to a secondary server connection in progress, or NULL when none. 
<p>

<p>Definition at line <a class="el" href="Identity_8h-source.html#l00072">72</a> of file <a class="el" href="Identity_8h-source.html">Identity.h</a>.</p>

<p>Referenced by <a class="el" href="Identity_8h-source.html#l00252">end_secondary_server_connection()</a>, <a class="el" href="Identity_8h-source.html#l00271">has_secondary_server_connection()</a>, <a class="el" href="Identity_8h-source.html#l00106">Identity()</a>, <a class="el" href="Identity_8h-source.html#l00274">secondary_server_connection()</a>, <a class="el" href="Identity_8h-source.html#l00232">start_secondary_server_connection()</a>, and <a class="el" href="Identity_8h-source.html#l00244">swap_primary_and_secondary_connection()</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="Identity_8h-source.html">Identity.h</a><li><a class="el" href="Identity_8cc-source.html">Identity.cc</a></ul>
</div>
<hr>

<TABLE WIDTH=100% BORDER=0 CELLSPACING=0 CELLPADDING=0>
<TR>
<TH ALIGN=left BGCOLOR="#e8feff"><ADDRESS>Copyright &copy; 2005-2007 Carlo Wood.&nbsp; All rights reserved.</ADDRESS></TH>
</TR>
</TABLE>

</DIV>
</BODY>
</HTML>

