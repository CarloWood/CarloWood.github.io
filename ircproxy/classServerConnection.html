<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML LANG="en-us">
 
<HEAD>
<META name="Author" content="Carlo Wood">
<META name="description" content="IRC proxy">
<META name="keywords" content="IRC, proxy, bnc, security, protection">
<META http-equiv="content-type" content="text/html; charset=iso-8859-1">
<TITLE>ircproxy documentation</TITLE>
<LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
<LINK HREF="main.css" REL="stylesheet" TYPE="text/css">
</HEAD>

<BODY>

<TABLE class="header" BORDER=0 CELLSPACING=0 CELLPADDING=0>
<TR>
<TD WIDTH=120><IMG SRC="images/ircproxy.png" BORDER=0></TD>
<TD VALIGN=center ALIGN=center BGCOLOR="#0A0607"><FONT size=+4 color="#ffffff"><B>&nbsp;ircproxy</B>&nbsp;</FONT>
<FONT size=+3 color="#ffffff">The&nbsp;Ultimate&nbsp;Cyborg</FONT></TD>
</TR>
</TABLE>

<DIV class="normal">
<hr>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>ServerConnection Class Reference</h1><!-- doxytag: class="ServerConnection" --><!-- doxytag: inherits="IdentityReference,event_client_ct" --><code>#include &lt;<a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>&gt;</code>
<p>
<div class="dynheader">
Inheritance diagram for ServerConnection:</div>
<div class="dynsection">

<p><center><img src="classServerConnection.png" usemap="#ServerConnection_map" border="0" alt=""></center>
<map name="ServerConnection_map">
<area href="classIdentityReference.html" alt="IdentityReference" shape="rect" coords="0,0,115,24">
</map>
</div>

<p>
<a href="classServerConnection-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Object representing the server-side connection. 
<p>
This object is owned by an <a class="el" href="classIdentity.html" title="A Nick/Network identity.">Identity</a> (and therefore has the same life time). The actual server connection is a <a class="el" href="classServerSession.html" title="A server session, from connect till disconnect.">ServerSession</a> object that is created and managed by this object. Administrative information about the specific server itself (name, network, ports etc) is stored in a <a class="el" href="classServer.html" title="An IRC server.">Server</a> object. 
<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00054">54</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#03d14fba4956796995bd1b888854dbc6">ServerConnection</a> (<a class="el" href="classIdentity.html">Identity</a> *identity)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor.  <a href="#03d14fba4956796995bd1b888854dbc6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#1a063921dfa06baccd932b6ac3c13e2d">ServerConnection</a> (<a class="el" href="classIdentity.html">Identity</a> *identity, boost::shared_ptr&lt; <a class="el" href="classServer.html">Server</a> &gt; server)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor for secondary connection.  <a href="#1a063921dfa06baccd932b6ac3c13e2d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#f919491d0e2ff066b0a58cc50fc0d90d">~ServerConnection</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor.  <a href="#f919491d0e2ff066b0a58cc50fc0d90d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2">state_nt</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#46893748168791f5ec68caca30b07af1">state</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the state of the connection.  <a href="#46893748168791f5ec68caca30b07af1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#9c9bc8e0255bda21c78f1cf8b21fe285">secondary_connection</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return true if this is a secondary connection.  <a href="#9c9bc8e0255bda21c78f1cf8b21fe285"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#8ae21901f92d8128aadcbe6076c8cc57">set_my_serverside_nick_name</a> (std::string const &amp;my_serverside_nick_name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set a new serverside nick name for myself. May only be called for a secondary connection.  <a href="#8ae21901f92d8128aadcbe6076c8cc57"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string const &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#3b1b11d36d3017fb868f43143ee6b4f9">my_serverside_nick_name</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get my serverside nick name. Only valid for secondary connection.  <a href="#3b1b11d36d3017fb868f43143ee6b4f9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#7a4001d7bc147f108c7214dbe3332bae">change_state</a> (<a class="el" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2">state_nt</a>, <a class="el" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2">state_nt</a> to)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Change the state of the connection from <em>from</em> to <em>to</em>.  <a href="#7a4001d7bc147f108c7214dbe3332bae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#5386bd208b67215459af782ab85c4631">has_server</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return true if we have a server object.  <a href="#5386bd208b67215459af782ab85c4631"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classServer.html">Server</a> const  &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#c31da41babaae4b0f781f6e6f1e177ad">server</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the server that we are connected with or connecting to.  <a href="#c31da41babaae4b0f781f6e6f1e177ad"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classServer.html">Server</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#e4cbaa0142e62e547b7f2d13d2a3d9e3">server</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the server that we are connected with or connecting to.  <a href="#e4cbaa0142e62e547b7f2d13d2a3d9e3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#75f5c82f132013aa4dca7dd8d514dbb6">has_server_session</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return true if we have a server session object.  <a href="#75f5c82f132013aa4dca7dd8d514dbb6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classServerSession.html">ServerSession</a> const &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#832a5728134205d1bcd2ef367b136c04">server_session</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the <a class="el" href="classServerSession.html" title="A server session, from connect till disconnect.">ServerSession</a>.  <a href="#832a5728134205d1bcd2ef367b136c04"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classServerSession.html">ServerSession</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#bfe33e4cfbab5d7c311acfbc972366af">server_session</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the <a class="el" href="classServerSession.html" title="A server session, from connect till disconnect.">ServerSession</a>.  <a href="#bfe33e4cfbab5d7c311acfbc972366af"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classNetwork.html">Network</a> const &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#fa3ed7910bc237f74ac9f6c130797879">network</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the network object of the current connection.  <a href="#fa3ed7910bc237f74ac9f6c130797879"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classNetwork.html">Network</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#09968b1cb47b4466a7e6194e5925d500">network</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the network object of the current connection.  <a href="#09968b1cb47b4466a7e6194e5925d500"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#a5c1bf21b5efcc2b80985b397d3ee57f">connect</a> (bool auto_reconnect)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Connect to the server and stay connected.  <a href="#a5c1bf21b5efcc2b80985b397d3ee57f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#00dd03d4df481351061cafa48f74b6ed">disconnect</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disconnect from the server.  <a href="#00dd03d4df481351061cafa48f74b6ed"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#4cb8d6fa95cdc9a4042978d5f290b1b7">session_lost</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called when the <a class="el" href="classServerSession.html" title="A server session, from connect till disconnect.">ServerSession</a> object is destroyed.  <a href="#4cb8d6fa95cdc9a4042978d5f290b1b7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#8107012a4c7d6b008c1d9401f78851f1">delayed_connect</a> (timer_event_type_ct const &amp;expired_at)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called when the timer for a delayed connect expired.  <a href="#8107012a4c7d6b008c1d9401f78851f1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#f7186fd0672f082a283600406f86fd1b">received_server_port_answer</a> (<a class="el" href="classUserAnswerEventType.html">UserAnswerEventType</a> const &amp;event_type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called when an answer to the server/port question is received.  <a href="#f7186fd0672f082a283600406f86fd1b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#2779cc22d1b308d478c74fd4105d8ec3">error_message_received</a> (<a class="el" href="classServerMessageIn.html">ServerMessageIn</a> const &amp;msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called if an ERROR message is received.  <a href="#2779cc22d1b308d478c74fd4105d8ec3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#5b7a006c3d2be22e831a6e29b054592c">successful_connection</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called when the first message is received from the server.  <a href="#5b7a006c3d2be22e831a6e29b054592c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#61f1caf7c83a2bdef5d6d75968754fcd">decode_ping</a> (<a class="el" href="classServerMessageIn.html">ServerMessageIn</a> const &amp;pong_msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called when a PING message is received.  <a href="#61f1caf7c83a2bdef5d6d75968754fcd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#5d35def1ca0c87f06ba7d7f685f64e72">send_pong_and_mode</a> (<a class="el" href="classExpressionEventType.html">ExpressionEventType</a> const &amp;event_type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called when it is safe to call it.  <a href="#5d35def1ca0c87f06ba7d7f685f64e72"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#f8258e3de592f47fab265f0d1a0abd44">received_first_umode</a> (<a class="el" href="classMatcherEventType.html">MatcherEventType</a> const &amp;event_type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called for the first MODE &lt;mynick&gt; received from the server.  <a href="#f8258e3de592f47fab265f0d1a0abd44"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#8d362234844f0be20b157f1f8d8756e7">is_connected</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return true if we are connected with a server.  <a href="#8d362234844f0be20b157f1f8d8756e7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#c1772a42084aa68f59995d694b1ecf85">reconnect</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return true if we try to (stay) connect(ed).  <a href="#c1772a42084aa68f59995d694b1ecf85"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">timeval&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#fc6d34c855c60f8bf8309657345e8bdf">connect_delay</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Accessor for M_connect_delay.  <a href="#fc6d34c855c60f8bf8309657345e8bdf"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#c05da809200d6c4dd415e36e9c0be9a1">timed_out</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Accessor for M_timed_out.  <a href="#c05da809200d6c4dd415e36e9c0be9a1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#8edbdbceff10b2fc18ab0eb056489430">timed_out_count</a> (void) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Accessor for M_timed_out_count.  <a href="#8edbdbceff10b2fc18ab0eb056489430"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#4c6cc9ba1f2ebf73e0173d00df30cac3">invisible_event</a> (<a class="el" href="classExpressionEventType.html">ExpressionEventType</a> const &amp;)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called when we first turn invisible.  <a href="#4c6cc9ba1f2ebf73e0173d00df30cac3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#dcd89496205b529710f2159fb29a3fd5">make_primary</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#7d0a881ff795d8189da0dacd839ba01d">make_secondary</a> (void)</td></tr>

<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#0bb470a3215a2780f846e806897359c5">do_connect</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Attempt an immediate connect to the server.  <a href="#0bb470a3215a2780f846e806897359c5"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classServer.html">Server</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834">M_server</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The server that we are connected to or trying to connect to, or NULL when the server is still unknown.  <a href="#32cfadcb86d87c251daca5574a492834"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classServerSession.html">ServerSession</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66">M_server_session</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A pointer to the current server session, or NULL when there is none.  <a href="#54a242749c6d8c4f074d54cb034c7b66"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#da968ead31fd07d9964f251530cc81d3">M_reconnect</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True if we should try to (re)connect.  <a href="#da968ead31fd07d9964f251530cc81d3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#a0d3f683f7af15bbc0a84203bde206b9">M_connected</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2">state_nt</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea">M_state</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The state of the connection.  <a href="#8ee9481e0fce407147dc1b3a0a6afbea"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">timeval&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#0bd8fa9e9cfbfae860406eae4b270885">M_connect_delay</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The next connect delay.  <a href="#0bd8fa9e9cfbfae860406eae4b270885"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#f242a50989467275c426f9e25ad74b6b">M_timed_out</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set if the last connection attempted timed out.  <a href="#f242a50989467275c426f9e25ad74b6b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#325de08b35f8b26eaea50b2edb0c4c36">M_timed_out_count</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The number of connect attempts left that will time out, until we stop trying.  <a href="#325de08b35f8b26eaea50b2edb0c4c36"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb">M_secondary_connection</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True if this connection is a secondary connection, while the primary still exists.  <a href="#c8237a669a8f97c83d51e5bdfd0189cb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#babd0c0817882b21608aac804d267293">M_my_serverside_nick_name</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This is my serverside nick name for as long as this is a secondary connection.  <a href="#babd0c0817882b21608aac804d267293"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static timeval&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#119910e5efed5d10039adf7f13fb1167">S_connect_delay_init</a> = { 1, 0 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The initial connect delay.  <a href="#119910e5efed5d10039adf7f13fb1167"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Friends</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::ostream &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classServerConnection.html#854fdc699d94494e229e845d6e75e5f1">operator&lt;&lt;</a> (std::ostream &amp;os, <a class="el" href="classServerConnection.html">ServerConnection</a> const &amp;server_connection)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For debugging purposes. Write a <a class="el" href="classServerConnection.html" title="Object representing the server-side connection.">ServerConnection</a> to <em>os</em>.  <a href="#854fdc699d94494e229e845d6e75e5f1"></a><br></td></tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="03d14fba4956796995bd1b888854dbc6"></a><!-- doxytag: member="ServerConnection::ServerConnection" ref="03d14fba4956796995bd1b888854dbc6" args="(Identity *identity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ServerConnection::ServerConnection           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classIdentity.html">Identity</a> *&nbsp;</td>
          <td class="paramname"> <em>identity</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00090">90</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="debug_8cc-source.html#l00045">debug::channels::dc::objects</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00090"></a>00090                                        :
<a name="l00091"></a>00091       event_client_ct(), <a class="code" href="classIdentityReference.html#9f35ea99263f016b6368f762be19cd4f" title="Default constructor.">IdentityReference</a>(identity), <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>(NULL), <a class="code" href="classServerConnection.html#da968ead31fd07d9964f251530cc81d3" title="True if we should try to (re)connect.">M_reconnect</a>(<span class="keyword">false</span>),
<a name="l00092"></a>00092       <a class="code" href="classServerConnection.html#a0d3f683f7af15bbc0a84203bde206b9">M_connected</a>(<span class="keyword">false</span>), <a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a>(<a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2519f950c18a0ec32082cf9984cd2b225" title="Disconnected.">disconnected</a>),
<a name="l00093"></a>00093       <a class="code" href="classServerConnection.html#0bd8fa9e9cfbfae860406eae4b270885" title="The next connect delay.">M_connect_delay</a>(<a class="code" href="classServerConnection.html#119910e5efed5d10039adf7f13fb1167" title="The initial connect delay.">S_connect_delay_init</a>), <a class="code" href="classServerConnection.html#f242a50989467275c426f9e25ad74b6b" title="Set if the last connection attempted timed out.">M_timed_out</a>(<span class="keyword">false</span>), <a class="code" href="classServerConnection.html#325de08b35f8b26eaea50b2edb0c4c36" title="The number of connect attempts left that will time out, until we stop trying.">M_timed_out_count</a>(0),
<a name="l00094"></a>00094       <a class="code" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb" title="True if this connection is a secondary connection, while the primary still exists...">M_secondary_connection</a>(<span class="keyword">false</span>)
<a name="l00095"></a>00095       {
<a name="l00096"></a>00096         Dout(<a class="code" href="namespacedebug_1_1channels_1_1dc.html#4fad4911d56fc2bccbb8ed9041454394" title="This debug channel is used for object construction/destruction tracking.">dc::objects</a>, <span class="stringliteral">"Constructing ServerConnection("</span> &lt;&lt; (<span class="keywordtype">void</span>*)identity &lt;&lt; <span class="stringliteral">")"</span>);
<a name="l00097"></a>00097       }

</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="1a063921dfa06baccd932b6ac3c13e2d"></a><!-- doxytag: member="ServerConnection::ServerConnection" ref="1a063921dfa06baccd932b6ac3c13e2d" args="(Identity *identity, boost::shared_ptr&lt; Server &gt; server)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ServerConnection::ServerConnection           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classIdentity.html">Identity</a> *&nbsp;</td>
          <td class="paramname"> <em>identity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::shared_ptr&lt; <a class="el" href="classServer.html">Server</a> &gt;&nbsp;</td>
          <td class="paramname"> <em>server</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor for secondary connection. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00100">100</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="debug_8cc-source.html#l00045">debug::channels::dc::objects</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00100"></a>00100                                                                        :
<a name="l00101"></a>00101       event_client_ct(), <a class="code" href="classIdentityReference.html#9f35ea99263f016b6368f762be19cd4f" title="Default constructor.">IdentityReference</a>(identity),
<a name="l00102"></a>00102       <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>(<a class="code" href="classServerConnection.html#c31da41babaae4b0f781f6e6f1e177ad" title="Returns the server that we are connected with or connecting to.">server</a>), <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>(NULL),
<a name="l00103"></a>00103       <a class="code" href="classServerConnection.html#da968ead31fd07d9964f251530cc81d3" title="True if we should try to (re)connect.">M_reconnect</a>(<span class="keyword">false</span>), <a class="code" href="classServerConnection.html#a0d3f683f7af15bbc0a84203bde206b9">M_connected</a>(<span class="keyword">false</span>), <a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a>(<a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2519f950c18a0ec32082cf9984cd2b225" title="Disconnected.">disconnected</a>),
<a name="l00104"></a>00104       <a class="code" href="classServerConnection.html#0bd8fa9e9cfbfae860406eae4b270885" title="The next connect delay.">M_connect_delay</a>(<a class="code" href="classServerConnection.html#119910e5efed5d10039adf7f13fb1167" title="The initial connect delay.">S_connect_delay_init</a>), <a class="code" href="classServerConnection.html#f242a50989467275c426f9e25ad74b6b" title="Set if the last connection attempted timed out.">M_timed_out</a>(<span class="keyword">false</span>), <a class="code" href="classServerConnection.html#325de08b35f8b26eaea50b2edb0c4c36" title="The number of connect attempts left that will time out, until we stop trying.">M_timed_out_count</a>(0),
<a name="l00105"></a>00105       <a class="code" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb" title="True if this connection is a secondary connection, while the primary still exists...">M_secondary_connection</a>(<span class="keyword">true</span>), <a class="code" href="classServerConnection.html#babd0c0817882b21608aac804d267293" title="This is my serverside nick name for as long as this is a secondary connection.">M_my_serverside_nick_name</a>(random_nick())
<a name="l00106"></a>00106       {
<a name="l00107"></a>00107         Dout(<a class="code" href="namespacedebug_1_1channels_1_1dc.html#4fad4911d56fc2bccbb8ed9041454394" title="This debug channel is used for object construction/destruction tracking.">dc::objects</a>, <span class="stringliteral">"Constructing secondary ServerConnection("</span> &lt;&lt; (<span class="keywordtype">void</span>*)identity &lt;&lt; <span class="stringliteral">")"</span>);
<a name="l00108"></a>00108       }

</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f919491d0e2ff066b0a58cc50fc0d90d"></a><!-- doxytag: member="ServerConnection::~ServerConnection" ref="f919491d0e2ff066b0a58cc50fc0d90d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ServerConnection::~ServerConnection           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destructor. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00111">111</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00168">disconnect()</a>, <a class="el" href="ServerConnection_8h-source.html#l00060">M_server_session</a>, and <a class="el" href="debug_8cc-source.html#l00045">debug::channels::dc::objects</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00112"></a>00112       {
<a name="l00113"></a>00113         Dout(<a class="code" href="namespacedebug_1_1channels_1_1dc.html#4fad4911d56fc2bccbb8ed9041454394" title="This debug channel is used for object construction/destruction tracking.">dc::objects</a>, <span class="stringliteral">"Destructing ServerConnection"</span> &lt;&lt; *<span class="keyword">this</span>);
<a name="l00114"></a>00114         cancel_all_requests();
<a name="l00115"></a>00115         <span class="keywordflow">if</span> (<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>)
<a name="l00116"></a>00116           <a class="code" href="classServerConnection.html#00dd03d4df481351061cafa48f74b6ed" title="Disconnect from the server.">disconnect</a>();
<a name="l00117"></a>00117       }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="46893748168791f5ec68caca30b07af1"></a><!-- doxytag: member="ServerConnection::state" ref="46893748168791f5ec68caca30b07af1" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2">state_nt</a> ServerConnection::state           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the state of the connection. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00120">120</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00071">M_state</a>.</p>

<p>Referenced by <a class="el" href="Queue_8cc-source.html#l00033">Queue::flush()</a>, <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>, <a class="el" href="Identity_8cc-source.html#l00278">Identity::new_server_message_received()</a>, <a class="el" href="debug__ostream__operators_8cc-source.html#l00318">operator&lt;&lt;()</a>, and <a class="el" href="Identity_8cc-source.html#l00063">Identity::pass_as_is_to_server()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00120"></a>00120 { <span class="keywordflow">return</span> <a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="9c9bc8e0255bda21c78f1cf8b21fe285"></a><!-- doxytag: member="ServerConnection::secondary_connection" ref="9c9bc8e0255bda21c78f1cf8b21fe285" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ServerConnection::secondary_connection           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if this is a secondary connection. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00123">123</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00083">M_secondary_connection</a>.</p>

<p>Referenced by <a class="el" href="AuthState_8cc-source.html#l00103">AuthState::auth_notice_looking_up_hostname()</a>, <a class="el" href="AuthState_8cc-source.html#l00128">AuthState::auth_notice_looking_up_ident()</a>, <a class="el" href="AuthState_8cc-source.html#l00028">AuthState::AuthState()</a>, <a class="el" href="ServerSession_8cc-source.html#l00462">ServerSession::detected_network()</a>, <a class="el" href="ServerSession_8cc-source.html#l00521">ServerSession::network_connection_terminated()</a>, <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>, <a class="el" href="debug__ostream__operators_8cc-source.html#l00318">operator&lt;&lt;()</a>, and <a class="el" href="ServerSession_8cc-source.html#l00334">ServerSession::~ServerSession()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00123"></a>00123 { <span class="keywordflow">return</span> <a class="code" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb" title="True if this connection is a secondary connection, while the primary still exists...">M_secondary_connection</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8ae21901f92d8128aadcbe6076c8cc57"></a><!-- doxytag: member="ServerConnection::set_my_serverside_nick_name" ref="8ae21901f92d8128aadcbe6076c8cc57" args="(std::string const &amp;my_serverside_nick_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::set_my_serverside_nick_name           </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&nbsp;</td>
          <td class="paramname"> <em>my_serverside_nick_name</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set a new serverside nick name for myself. May only be called for a secondary connection. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00126">126</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="ServerConnection_8h-source.html#l00086">M_my_serverside_nick_name</a>, and <a class="el" href="ServerConnection_8h-source.html#l00083">M_secondary_connection</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00127"></a>00127       { <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb" title="True if this connection is a secondary connection, while the primary still exists...">M_secondary_connection</a>); <a class="code" href="classServerConnection.html#babd0c0817882b21608aac804d267293" title="This is my serverside nick name for as long as this is a secondary connection.">M_my_serverside_nick_name</a> = <a class="code" href="classServerConnection.html#3b1b11d36d3017fb868f43143ee6b4f9" title="Get my serverside nick name. Only valid for secondary connection.">my_serverside_nick_name</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3b1b11d36d3017fb868f43143ee6b4f9"></a><!-- doxytag: member="ServerConnection::my_serverside_nick_name" ref="3b1b11d36d3017fb868f43143ee6b4f9" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string const&amp; ServerConnection::my_serverside_nick_name           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get my serverside nick name. Only valid for secondary connection. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00130">130</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="ServerConnection_8h-source.html#l00086">M_my_serverside_nick_name</a>, and <a class="el" href="ServerConnection_8h-source.html#l00083">M_secondary_connection</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00131"></a>00131       { <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb" title="True if this connection is a secondary connection, while the primary still exists...">M_secondary_connection</a>); <span class="keywordflow">return</span> <a class="code" href="classServerConnection.html#babd0c0817882b21608aac804d267293" title="This is my serverside nick name for as long as this is a secondary connection.">M_my_serverside_nick_name</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7a4001d7bc147f108c7214dbe3332bae"></a><!-- doxytag: member="ServerConnection::change_state" ref="7a4001d7bc147f108c7214dbe3332bae" args="(state_nt, state_nt to)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::change_state           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2">state_nt</a>&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2">state_nt</a>&nbsp;</td>
          <td class="paramname"> <em>to</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Change the state of the connection from <em>from</em> to <em>to</em>. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00134">134</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, and <a class="el" href="ServerConnection_8h-source.html#l00071">M_state</a>.</p>

<p>Referenced by <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00135"></a>00135       {
<a name="l00136"></a>00136         Debug(<a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> == from));
<a name="l00137"></a>00137         <a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> = to;
<a name="l00138"></a>00138       }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5386bd208b67215459af782ab85c4631"></a><!-- doxytag: member="ServerConnection::has_server" ref="5386bd208b67215459af782ab85c4631" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ServerConnection::has_server           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if we have a server object. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00141">141</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00057">M_server</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00138">delayed_connect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00201">received_server_port_answer()</a>, and <a class="el" href="ServerConnection_8h-source.html#l00144">server()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00141"></a>00141 { <span class="keywordflow">return</span> <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>.get(); }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c31da41babaae4b0f781f6e6f1e177ad"></a><!-- doxytag: member="ServerConnection::server" ref="c31da41babaae4b0f781f6e6f1e177ad" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classServer.html">Server</a> const&gt; ServerConnection::server           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the server that we are connected with or connecting to. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00144">144</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="ServerConnection_8h-source.html#l00141">has_server()</a>, and <a class="el" href="ServerConnection_8h-source.html#l00057">M_server</a>.</p>

<p>Referenced by <a class="el" href="ServerSession_8cc-source.html#l00462">ServerSession::detected_network()</a>, <a class="el" href="ServerSession_8cc-source.html#l00389">ServerSession::found_network_name()</a>, <a class="el" href="Matcher_8cc-source.html#l00027">Matcher_noarg::match_impl()</a>, <a class="el" href="ServerConnection_8h-source.html#l00159">network()</a>, <a class="el" href="ServerSession_8cc-source.html#l00521">ServerSession::network_connection_terminated()</a>, <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>, and <a class="el" href="ServerConnection_8cc-source.html#l00201">received_server_port_answer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00144"></a>00144 { <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classServerConnection.html#5386bd208b67215459af782ab85c4631" title="Return true if we have a server object.">has_server</a>()); <span class="keywordflow">return</span> boost::const_pointer_cast&lt;<a class="code" href="classServer.html" title="An IRC server.">Server</a> <span class="keyword">const</span>&gt;(<a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>); }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e4cbaa0142e62e547b7f2d13d2a3d9e3"></a><!-- doxytag: member="ServerConnection::server" ref="e4cbaa0142e62e547b7f2d13d2a3d9e3" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classServer.html">Server</a>&gt; ServerConnection::server           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the server that we are connected with or connecting to. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00147">147</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="ServerConnection_8h-source.html#l00141">has_server()</a>, and <a class="el" href="ServerConnection_8h-source.html#l00057">M_server</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00147"></a>00147 { <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classServerConnection.html#5386bd208b67215459af782ab85c4631" title="Return true if we have a server object.">has_server</a>()); <span class="keywordflow">return</span> <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="75f5c82f132013aa4dca7dd8d514dbb6"></a><!-- doxytag: member="ServerConnection::has_server_session" ref="75f5c82f132013aa4dca7dd8d514dbb6" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ServerConnection::has_server_session           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if we have a server session object. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00150">150</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00060">M_server_session</a>.</p>

<p>Referenced by <a class="el" href="debug__ostream__operators_8cc-source.html#l00318">operator&lt;&lt;()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00150"></a>00150 { <span class="keywordflow">return</span> <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="832a5728134205d1bcd2ef367b136c04"></a><!-- doxytag: member="ServerConnection::server_session" ref="832a5728134205d1bcd2ef367b136c04" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classServerSession.html">ServerSession</a> const&amp; ServerConnection::server_session           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the <a class="el" href="classServerSession.html" title="A server session, from connect till disconnect.">ServerSession</a>. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00153">153</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00060">M_server_session</a>.</p>

<p>Referenced by <a class="el" href="AuthState_8cc-source.html#l00103">AuthState::auth_notice_looking_up_hostname()</a>, <a class="el" href="AuthState_8cc-source.html#l00128">AuthState::auth_notice_looking_up_ident()</a>, <a class="el" href="AuthState_8cc-source.html#l00028">AuthState::AuthState()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00312">decode_ping()</a>, <a class="el" href="ISupport_8cc-source.html#l00029">ISupport::end()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00281">error_message_received()</a>, <a class="el" href="Queue_8cc-source.html#l00033">Queue::flush()</a>, <a class="el" href="debug__ostream__operators_8cc-source.html#l00318">operator&lt;&lt;()</a>, and <a class="el" href="Authentication_8cc-source.html#l00101">Authentication::send_authentication()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00153"></a>00153 { <span class="keywordflow">return</span> *<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="bfe33e4cfbab5d7c311acfbc972366af"></a><!-- doxytag: member="ServerConnection::server_session" ref="bfe33e4cfbab5d7c311acfbc972366af" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classServerSession.html">ServerSession</a>&amp; ServerConnection::server_session           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the <a class="el" href="classServerSession.html" title="A server session, from connect till disconnect.">ServerSession</a>. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00156">156</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00060">M_server_session</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00156"></a>00156 { <span class="keywordflow">return</span> *<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="fa3ed7910bc237f74ac9f6c130797879"></a><!-- doxytag: member="ServerConnection::network" ref="fa3ed7910bc237f74ac9f6c130797879" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNetwork.html">Network</a> const&amp; ServerConnection::network           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the network object of the current connection. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00159">159</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00144">server()</a>.</p>

<p>Referenced by <a class="el" href="Target_8cc-source.html#l00136">Target::add_channel()</a>, <a class="el" href="Target_8cc-source.html#l00073">Target::add_joined_nick()</a>, <a class="el" href="Target_8cc-source.html#l00054">Target::get_joined_nick()</a>, <a class="el" href="Identity_8h-source.html#l00189">Identity::network()</a>, and <a class="el" href="Target_8cc-source.html#l00116">Target::serverside_add_channel()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00159"></a>00159 { <span class="keywordflow">return</span> <a class="code" href="classServerConnection.html#c31da41babaae4b0f781f6e6f1e177ad" title="Returns the server that we are connected with or connecting to.">server</a>()-&gt;network(); }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="09968b1cb47b4466a7e6194e5925d500"></a><!-- doxytag: member="ServerConnection::network" ref="09968b1cb47b4466a7e6194e5925d500" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNetwork.html">Network</a>&amp; ServerConnection::network           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the network object of the current connection. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00162">162</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00144">server()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00162"></a>00162 { <span class="keywordflow">return</span> <a class="code" href="classServerConnection.html#c31da41babaae4b0f781f6e6f1e177ad" title="Returns the server that we are connected with or connecting to.">server</a>()-&gt;network(); }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="a5c1bf21b5efcc2b80985b397d3ee57f"></a><!-- doxytag: member="ServerConnection::connect" ref="a5c1bf21b5efcc2b80985b397d3ee57f" args="(bool auto_reconnect)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::connect           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>auto_reconnect</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Connect to the server and stay connected. 
<p>
This function should be called only after the <a class="el" href="classServerConnection.html" title="Object representing the server-side connection.">ServerConnection</a> was just created, or after calling <a class="el" href="classServerConnection.html#00dd03d4df481351061cafa48f74b6ed" title="Disconnect from the server.">ServerConnection::disconnect</a>.<p>
This function will start the procedure of connecting to a server, either the one already specified by <a class="el" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">ServerConnection::M_server</a> or, if none is known, it will first ask the user for a server name and port.<p>
It will continue to attempt to connect to a server (with appropriate connect delays if necessary) until connected. After a connection is successful then the authentication sequence is started (handled by <a class="el" href="classAuthentication.html" title="Authentication token.">Authentication</a>).<p>
If a connection is lost, at any time, then a new connection is automatically attempted. 
<p>Definition at line <a class="el" href="ServerConnection_8cc-source.html#l00073">73</a> of file <a class="el" href="ServerConnection_8cc-source.html">ServerConnection.cc</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="Identity_8h-source.html#l00208">Identity::client_session()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00138">delayed_connect()</a>, <a class="el" href="ServerConnection_8h-source.html#l00168">disconnect()</a>, <a class="el" href="ServerConnection_8h-source.html#l00038">disconnected</a>, <a class="el" href="ServerConnection_8cc-source.html#l00149">do_connect()</a>, <a class="el" href="debug_8h-source.html#l00214">DoutEntering</a>, <a class="el" href="ServerConnection_8h-source.html#l00141">has_server()</a>, <a class="el" href="IdentityReference_8h-source.html#l00037">IdentityReference::identity()</a>, <a class="el" href="ServerConnection_8h-source.html#l00190">is_connected()</a>, <a class="el" href="ServerConnection_8h-source.html#l00073">M_connect_delay</a>, <a class="el" href="ServerConnection_8h-source.html#l00063">M_reconnect</a>, <a class="el" href="ServerConnection_8h-source.html#l00083">M_secondary_connection</a>, <a class="el" href="ServerConnection_8h-source.html#l00057">M_server</a>, <a class="el" href="ServerConnection_8h-source.html#l00060">M_server_session</a>, <a class="el" href="ServerConnection_8h-source.html#l00071">M_state</a>, <a class="el" href="ServerConnection_8h-source.html#l00077">M_timed_out</a>, <a class="el" href="ServerConnection_8h-source.html#l00080">M_timed_out_count</a>, <a class="el" href="Identity_8h-source.html#l00156">Identity::network_name()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00201">received_server_port_answer()</a>, <a class="el" href="question__nt_8h-source.html#l00023">server_port_question</a>, and <a class="el" href="ClientSession_8h-source.html#l00062">ClientSession::user_answer_event_server</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00149">do_connect()</a>, <a class="el" href="Authentication_8cc-source.html#l00087">Authentication::received_nick_and_user()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00201">received_server_port_answer()</a>, and <a class="el" href="ServerConnection_8cc-source.html#l00252">session_lost()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00074"></a>00074 {
<a name="l00075"></a>00075   <a class="code" href="debug_8h.html#3dc350a548c074386c3ec0271d16a7a8" title="Debugging macro.">DoutEntering</a>(dc::debug, <span class="stringliteral">"ServerConnection::connect() for "</span> &lt;&lt; *<span class="keyword">this</span>);
<a name="l00076"></a>00076   <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(!<a class="code" href="classServerConnection.html#8d362234844f0be20b157f1f8d8756e7" title="Return true if we are connected with a server.">is_connected</a>());
<a name="l00077"></a>00077   <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> == <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2519f950c18a0ec32082cf9984cd2b225" title="Disconnected.">disconnected</a>);
<a name="l00078"></a>00078   <span class="keywordflow">if</span> (!<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>)        <span class="comment">// Could already be allocated if has_server() was false</span>
<a name="l00079"></a>00079                                 <span class="comment">// and we get here a second time because the ClientSession</span>
<a name="l00080"></a>00080                                 <span class="comment">// was destroyed after requesting an answer.</span>
<a name="l00081"></a>00081   {
<a name="l00082"></a>00082     <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a> = <span class="keyword">new</span> <a class="code" href="classServerSession.html" title="A server session, from connect till disconnect.">ServerSession</a>(<a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>(), *<span class="keyword">this</span>);
<a name="l00083"></a>00083     AllocTag(<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>, (<a class="code" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb" title="True if this connection is a secondary connection, while the primary still exists...">M_secondary_connection</a> ? <span class="stringliteral">"Secondary Server session of "</span> : <span class="stringliteral">"Server session of "</span>) &lt;&lt; <a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().key());
<a name="l00084"></a>00084   }
<a name="l00085"></a>00085   <span class="keywordflow">if</span> (auto_reconnect)
<a name="l00086"></a>00086   {
<a name="l00087"></a>00087     <span class="comment">// See if we can find a network that this Identity belongs to.</span>
<a name="l00088"></a>00088     <span class="keywordflow">for</span> (networks_type::iterator network_iter = Application::instance().networks().begin(); network_iter != Application::instance().networks().end(); ++network_iter)
<a name="l00089"></a>00089       <span class="keywordflow">if</span> (network_iter-&gt;name() == <a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().<a class="code" href="classIdentity.html#30cae43d74e1e50408f30d2a3eff2025" title="Returns the network name that this identity corresponds with.">network_name</a>())
<a name="l00090"></a>00090       {
<a name="l00091"></a>00091         <span class="keywordflow">if</span> (<a class="code" href="classServerConnection.html#5386bd208b67215459af782ab85c4631" title="Return true if we have a server object.">has_server</a>())
<a name="l00092"></a>00092         {
<a name="l00093"></a>00093           <span class="keywordflow">if</span> (!<a class="code" href="classServerConnection.html#325de08b35f8b26eaea50b2edb0c4c36" title="The number of connect attempts left that will time out, until we stop trying.">M_timed_out_count</a>)
<a name="l00094"></a>00094           {
<a name="l00095"></a>00095             <a class="code" href="classServerConnection.html#325de08b35f8b26eaea50b2edb0c4c36" title="The number of connect attempts left that will time out, until we stop trying.">M_timed_out_count</a> = 3 * network_iter-&gt;servers().size();
<a name="l00096"></a>00096             <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classServerConnection.html#325de08b35f8b26eaea50b2edb0c4c36" title="The number of connect attempts left that will time out, until we stop trying.">M_timed_out_count</a> != 0);     <span class="comment">// We have at least one server because has_server() is true.</span>
<a name="l00097"></a>00097           }
<a name="l00098"></a>00098           <span class="keywordflow">if</span> (<a class="code" href="classServerConnection.html#f242a50989467275c426f9e25ad74b6b" title="Set if the last connection attempted timed out.">M_timed_out</a>)
<a name="l00099"></a>00099             --<a class="code" href="classServerConnection.html#325de08b35f8b26eaea50b2edb0c4c36" title="The number of connect attempts left that will time out, until we stop trying.">M_timed_out_count</a>;
<a name="l00100"></a>00100         }
<a name="l00101"></a>00101         <span class="keywordflow">if</span> (network_iter-&gt;servers().empty() || (<a class="code" href="classServerConnection.html#f242a50989467275c426f9e25ad74b6b" title="Set if the last connection attempted timed out.">M_timed_out</a> &amp;&amp; !<a class="code" href="classServerConnection.html#325de08b35f8b26eaea50b2edb0c4c36" title="The number of connect attempts left that will time out, until we stop trying.">M_timed_out_count</a>))
<a name="l00102"></a>00102           <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>.reset();     <span class="comment">// If we don't have any servers, or when all servers timed out three times on a row.</span>
<a name="l00103"></a>00103         <span class="keywordflow">else</span>
<a name="l00104"></a>00104         {
<a name="l00105"></a>00105           std::stable_sort(network_iter-&gt;servers().begin(), network_iter-&gt;servers().end(), <a class="code" href="structConnectionOrder.html" title="Ordering predicate for Server objects.">ConnectionOrder</a>());
<a name="l00106"></a>00106           <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a> = network_iter-&gt;servers().front();
<a name="l00107"></a>00107         }
<a name="l00108"></a>00108         <span class="keywordflow">break</span>;
<a name="l00109"></a>00109       }
<a name="l00110"></a>00110   }
<a name="l00111"></a>00111   <a class="code" href="classServerConnection.html#da968ead31fd07d9964f251530cc81d3" title="True if we should try to (re)connect.">M_reconnect</a> = <span class="keyword">true</span>;
<a name="l00112"></a>00112   <span class="keywordflow">if</span> (<a class="code" href="classServerConnection.html#5386bd208b67215459af782ab85c4631" title="Return true if we have a server object.">has_server</a>())
<a name="l00113"></a>00113   {
<a name="l00114"></a>00114     timeval next_connect;
<a name="l00115"></a>00115     timeradd(&amp;<a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>-&gt;last_connection_event(), &amp;<a class="code" href="classServerConnection.html#0bd8fa9e9cfbfae860406eae4b270885" title="The next connect delay.">M_connect_delay</a>, &amp;next_connect);
<a name="l00116"></a>00116     timeval now = timerRequest.get_now();
<a name="l00117"></a>00117     <span class="keywordflow">if</span> (timercmp(&amp;now, &amp;next_connect, &gt;))
<a name="l00118"></a>00118       <a class="code" href="classServerConnection.html#0bb470a3215a2780f846e806897359c5" title="Attempt an immediate connect to the server.">do_connect</a>();
<a name="l00119"></a>00119     <span class="keywordflow">else</span>
<a name="l00120"></a>00120       timerRequest(<a class="code" href="classServerConnection.html#0bd8fa9e9cfbfae860406eae4b270885" title="The next connect delay.">M_connect_delay</a>, *<span class="keyword">this</span>, &amp;<a class="code" href="classServerConnection.html#8107012a4c7d6b008c1d9401f78851f1" title="Called when the timer for a delayed connect expired.">ServerConnection::delayed_connect</a>);
<a name="l00121"></a>00121   }
<a name="l00122"></a>00122   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().has_client_session())
<a name="l00123"></a>00123   {
<a name="l00124"></a>00124     <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(!<a class="code" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb" title="True if this connection is a secondary connection, while the primary still exists...">M_secondary_connection</a>);    <span class="comment">// The secondary connection should always have a server.</span>
<a name="l00125"></a>00125     <a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().<a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#c6c444fa618e12e0be321c5e75f20a84" title="The UserAnswer event server.">user_answer_event_server</a>
<a name="l00126"></a>00126         (<a class="code" href="classUserAnswerRequestData.html" title="Request data passed to the event server.">UserAnswerRequestData</a>(<a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().client_session(), <a class="code" href="question__nt_8h.html#027b743250267c94e5a1a63e0bbb3846bb516cb7284441ea7de98a9408a8351f" title="What server should I connect to (type: &amp;lt;server&amp;gt; [&amp;lt;port&amp;gt; [&amp;lt;localip&amp;gt;]])...">server_port_question</a>,
<a name="l00127"></a>00127         <span class="stringliteral">"What server should I connect to (type: &lt;server&gt; [&lt;port&gt; [&lt;localip&gt;]])?"</span>),
<a name="l00128"></a>00128         *<span class="keyword">this</span>, &amp;<a class="code" href="classServerConnection.html#f7186fd0672f082a283600406f86fd1b" title="This function is called when an answer to the server/port question is received.">ServerConnection::received_server_port_answer</a>);
<a name="l00129"></a>00129   }
<a name="l00130"></a>00130   <span class="keywordflow">else</span>
<a name="l00131"></a>00131     <a class="code" href="classServerConnection.html#00dd03d4df481351061cafa48f74b6ed" title="Disconnect from the server.">disconnect</a>();
<a name="l00132"></a>00132 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="00dd03d4df481351061cafa48f74b6ed"></a><!-- doxytag: member="ServerConnection::disconnect" ref="00dd03d4df481351061cafa48f74b6ed" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::disconnect           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Disconnect from the server. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00168">168</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="debug_8h-source.html#l00214">DoutEntering</a>, <a class="el" href="ServerConnection_8h-source.html#l00063">M_reconnect</a>, and <a class="el" href="ServerConnection_8h-source.html#l00060">M_server_session</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="ServerSession_8cc-source.html#l00515">ServerSession::force_quit()</a>, <a class="el" href="ServerSession_8cc-source.html#l00389">ServerSession::found_network_name()</a>, <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>, and <a class="el" href="ServerConnection_8h-source.html#l00111">~ServerConnection()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00169"></a>00169       {
<a name="l00170"></a>00170         <a class="code" href="debug_8h.html#3dc350a548c074386c3ec0271d16a7a8" title="Debugging macro.">DoutEntering</a>(dc::debug, <span class="stringliteral">"ServerConnection::disconnect() for "</span> &lt;&lt; *<span class="keyword">this</span>);
<a name="l00171"></a>00171         <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>);
<a name="l00172"></a>00172         <a class="code" href="classServerConnection.html#da968ead31fd07d9964f251530cc81d3" title="True if we should try to (re)connect.">M_reconnect</a> = <span class="keyword">false</span>;            <span class="comment">// Before calling del(), otherwise 'session_lost' will</span>
<a name="l00173"></a>00173                                         <span class="comment">// immediately try to reconnect.</span>
<a name="l00174"></a>00174         <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>-&gt;del();        <span class="comment">// This calls session_lost (possibly with a tiny delay),</span>
<a name="l00175"></a>00175                                         <span class="comment">// messages in the socket queue are first flushed.</span>
<a name="l00176"></a>00176       }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="4cb8d6fa95cdc9a4042978d5f290b1b7"></a><!-- doxytag: member="ServerConnection::session_lost" ref="4cb8d6fa95cdc9a4042978d5f290b1b7" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::session_lost           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function is called when the <a class="el" href="classServerSession.html" title="A server session, from connect till disconnect.">ServerSession</a> object is destroyed. 
<p>
Never call this function directly. 
<p>Definition at line <a class="el" href="ServerConnection_8cc-source.html#l00252">252</a> of file <a class="el" href="ServerConnection_8cc-source.html">ServerConnection.cc</a>.</p>

<p>References <a class="el" href="Identity_8h-source.html#l00208">Identity::client_session()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="Identity_8h-source.html#l00265">Identity::destroy_secondary_server_connection()</a>, <a class="el" href="ServerConnection_8h-source.html#l00038">disconnected</a>, <a class="el" href="IdentityReference_8h-source.html#l00037">IdentityReference::identity()</a>, <a class="el" href="ServerConnection_8h-source.html#l00068">M_connected</a>, <a class="el" href="ServerConnection_8h-source.html#l00063">M_reconnect</a>, <a class="el" href="ServerConnection_8h-source.html#l00083">M_secondary_connection</a>, <a class="el" href="ServerConnection_8h-source.html#l00057">M_server</a>, <a class="el" href="ServerConnection_8h-source.html#l00060">M_server_session</a>, <a class="el" href="ServerConnection_8h-source.html#l00071">M_state</a>, and <a class="el" href="ClientSession_8cc-source.html#l00265">ClientSession::serversession_lost()</a>.</p>

<p>Referenced by <a class="el" href="ServerSession_8cc-source.html#l00334">ServerSession::~ServerSession()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00253"></a>00253 { 
<a name="l00254"></a>00254   <span class="keywordflow">if</span> (<a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> != <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2519f950c18a0ec32082cf9984cd2b225" title="Disconnected.">disconnected</a>)
<a name="l00255"></a>00255   {
<a name="l00256"></a>00256     <span class="comment">// Inform the server object.</span>
<a name="l00257"></a>00257     <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>-&gt;connection_lost();
<a name="l00258"></a>00258     <span class="comment">// Let the client know that the connection was broken.</span>
<a name="l00259"></a>00259     <span class="keywordflow">if</span> (!<a class="code" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb" title="True if this connection is a secondary connection, while the primary still exists...">M_secondary_connection</a> &amp;&amp; <a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().has_client_session())
<a name="l00260"></a>00260       <a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().<a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#f33264c0e0add56fbe88630c41a23aee" title="This function is called from ServerSession::session_lost().">serversession_lost</a>();
<a name="l00261"></a>00261   }
<a name="l00262"></a>00262   <a class="code" href="classServerConnection.html#a0d3f683f7af15bbc0a84203bde206b9">M_connected</a> = <span class="keyword">false</span>;
<a name="l00263"></a>00263   <a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> = <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2519f950c18a0ec32082cf9984cd2b225" title="Disconnected.">disconnected</a>;
<a name="l00264"></a>00264   <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a> = NULL;
<a name="l00265"></a>00265   <span class="keywordflow">if</span> (<a class="code" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb" title="True if this connection is a secondary connection, while the primary still exists...">M_secondary_connection</a>)
<a name="l00266"></a>00266   {
<a name="l00267"></a>00267     <a class="code" href="classServerConnection.html#da968ead31fd07d9964f251530cc81d3" title="True if we should try to (re)connect.">M_reconnect</a> = <span class="keyword">false</span>;
<a name="l00268"></a>00268     <a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().<a class="code" href="classIdentity.html#ccac348b8786786a5af3b5a9dcbf9e21">destroy_secondary_server_connection</a>();
<a name="l00269"></a>00269   }
<a name="l00270"></a>00270   <span class="keywordflow">if</span> (<a class="code" href="classServerConnection.html#da968ead31fd07d9964f251530cc81d3" title="True if we should try to (re)connect.">M_reconnect</a>)
<a name="l00271"></a>00271     <a class="code" href="classServerConnection.html#a5c1bf21b5efcc2b80985b397d3ee57f" title="Connect to the server and stay connected.">connect</a>(<span class="keyword">true</span>);
<a name="l00272"></a>00272 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8107012a4c7d6b008c1d9401f78851f1"></a><!-- doxytag: member="ServerConnection::delayed_connect" ref="8107012a4c7d6b008c1d9401f78851f1" args="(timer_event_type_ct const &amp;expired_at)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::delayed_connect           </td>
          <td>(</td>
          <td class="paramtype">timer_event_type_ct const &amp;&nbsp;</td>
          <td class="paramname"> <em>expired_at</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Called when the timer for a delayed connect expired. 
<p>
Never call this function directly. 
<p>Definition at line <a class="el" href="ServerConnection_8cc-source.html#l00138">138</a> of file <a class="el" href="ServerConnection_8cc-source.html">ServerConnection.cc</a>.</p>

<p>References <a class="el" href="ServerConnection_8cc-source.html#l00149">do_connect()</a>, <a class="el" href="debug_8h-source.html#l00214">DoutEntering</a>, <a class="el" href="ServerConnection_8h-source.html#l00141">has_server()</a>, <a class="el" href="ServerConnection_8h-source.html#l00190">is_connected()</a>, <a class="el" href="ServerConnection_8h-source.html#l00063">M_reconnect</a>, and <a class="el" href="ServerConnection_8h-source.html#l00060">M_server_session</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00139"></a>00139 {
<a name="l00140"></a>00140   <a class="code" href="debug_8h.html#3dc350a548c074386c3ec0271d16a7a8" title="Debugging macro.">DoutEntering</a>(dc::debug, <span class="stringliteral">"ServerConnection::delayed_connect("</span> &lt;&lt; expired_at.get_expire_time() &lt;&lt; <span class="stringliteral">")"</span>);
<a name="l00141"></a>00141   <span class="keywordflow">if</span> (!<a class="code" href="classServerConnection.html#8d362234844f0be20b157f1f8d8756e7" title="Return true if we are connected with a server.">is_connected</a>() &amp;&amp; <a class="code" href="classServerConnection.html#da968ead31fd07d9964f251530cc81d3" title="True if we should try to (re)connect.">M_reconnect</a> &amp;&amp; <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a> &amp;&amp; <a class="code" href="classServerConnection.html#5386bd208b67215459af782ab85c4631" title="Return true if we have a server object.">has_server</a>())
<a name="l00142"></a>00142     <a class="code" href="classServerConnection.html#0bb470a3215a2780f846e806897359c5" title="Attempt an immediate connect to the server.">do_connect</a>();
<a name="l00143"></a>00143 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f7186fd0672f082a283600406f86fd1b"></a><!-- doxytag: member="ServerConnection::received_server_port_answer" ref="f7186fd0672f082a283600406f86fd1b" args="(UserAnswerEventType const &amp;event_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::received_server_port_answer           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classUserAnswerEventType.html">UserAnswerEventType</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>event_type</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function is called when an answer to the server/port question is received. 
<p>
Never call this function directly. 
<p>Definition at line <a class="el" href="ServerConnection_8cc-source.html#l00201">201</a> of file <a class="el" href="ServerConnection_8cc-source.html">ServerConnection.cc</a>.</p>

<p>References <a class="el" href="UserAnswer_8h-source.html#l00041">UserAnswer::answer()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="debug_8h-source.html#l00214">DoutEntering</a>, <a class="el" href="ServerConnection_8h-source.html#l00141">has_server()</a>, <a class="el" href="IdentityReference_8h-source.html#l00037">IdentityReference::identity()</a>, <a class="el" href="ServerConnection_8h-source.html#l00057">M_server</a>, <a class="el" href="ServerConnection_8h-source.html#l00077">M_timed_out</a>, and <a class="el" href="ServerConnection_8h-source.html#l00144">server()</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00202"></a>00202 {
<a name="l00203"></a>00203   <a class="code" href="debug_8h.html#3dc350a548c074386c3ec0271d16a7a8" title="Debugging macro.">DoutEntering</a>(dc::debug, <span class="stringliteral">"ServerConnection::received_server_port_answer("</span> &lt;&lt; event_type &lt;&lt; <span class="stringliteral">")"</span>);
<a name="l00204"></a>00204   std::string answer = event_type.answer();
<a name="l00205"></a>00205   std::string hostname;
<a name="l00206"></a>00206   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> port = 6667;
<a name="l00207"></a>00207   <span class="keyword">struct </span>in_addr vhost = { INADDR_ANY };
<a name="l00208"></a>00208 
<a name="l00209"></a>00209   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> count = 0;
<a name="l00210"></a>00210   std::stringstream ss(answer);
<a name="l00211"></a>00211   std::string buf;
<a name="l00212"></a>00212   <span class="keywordflow">while</span> ((ss &gt;&gt; buf))
<a name="l00213"></a>00213   {
<a name="l00214"></a>00214     <span class="keywordflow">if</span> (count == 0)
<a name="l00215"></a>00215       hostname = buf;
<a name="l00216"></a>00216     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (count == 1)
<a name="l00217"></a>00217       port = atoi(buf.c_str());
<a name="l00218"></a>00218     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (count == 2)
<a name="l00219"></a>00219       inet_aton(buf.c_str(), &amp;vhost);
<a name="l00220"></a>00220     ++count;
<a name="l00221"></a>00221   }
<a name="l00222"></a>00222 
<a name="l00223"></a>00223   <span class="comment">// See if this server was already known.</span>
<a name="l00224"></a>00224   <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
<a name="l00225"></a>00225   <span class="keywordflow">for</span> (networks_type::iterator network_iter = Application::instance().networks().begin(); network_iter != Application::instance().networks().end(); ++network_iter)
<a name="l00226"></a>00226   {
<a name="l00227"></a>00227     <span class="comment">// Never change network.</span>
<a name="l00228"></a>00228     <span class="keywordflow">if</span> (<a class="code" href="classServerConnection.html#5386bd208b67215459af782ab85c4631" title="Return true if we have a server object.">has_server</a>() &amp;&amp; <a class="code" href="classServerConnection.html#c31da41babaae4b0f781f6e6f1e177ad" title="Returns the server that we are connected with or connecting to.">server</a>()-&gt;network().name() != network_iter-&gt;name())
<a name="l00229"></a>00229       <span class="keywordflow">continue</span>;
<a name="l00230"></a>00230     <span class="keywordflow">for</span> (Network::servers_type::iterator server_iter = network_iter-&gt;servers().begin(); server_iter != network_iter-&gt;servers().end(); ++server_iter)
<a name="l00231"></a>00231       <span class="keywordflow">if</span> (strcasecmp((*server_iter)-&gt;hostname().c_str(), hostname.c_str()) == 0 &amp;&amp; memcmp(&amp;(*server_iter)-&gt;vhost(), &amp;vhost, <span class="keyword">sizeof</span>(vhost)) == 0)
<a name="l00232"></a>00232       {
<a name="l00233"></a>00233         Dout(dc::notice, <span class="stringliteral">"Found existing server "</span> &lt;&lt; *server_iter);
<a name="l00234"></a>00234         found = <span class="keyword">true</span>;
<a name="l00235"></a>00235         <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a> = *server_iter;
<a name="l00236"></a>00236         <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>-&gt;set_port(port);
<a name="l00237"></a>00237         <span class="keywordflow">break</span>;
<a name="l00238"></a>00238       }
<a name="l00239"></a>00239     <span class="keywordflow">if</span> (found)
<a name="l00240"></a>00240       <span class="keywordflow">break</span>;
<a name="l00241"></a>00241   }
<a name="l00242"></a>00242   <span class="keywordflow">if</span> (!found)
<a name="l00243"></a>00243     <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>.reset(NEW(<a class="code" href="classServer.html" title="An IRC server.">Server</a>(<a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().private_network(), hostname, port, vhost)));
<a name="l00244"></a>00244   <a class="code" href="classServerConnection.html#f242a50989467275c426f9e25ad74b6b" title="Set if the last connection attempted timed out.">M_timed_out</a> = <span class="keyword">false</span>;
<a name="l00245"></a>00245   <a class="code" href="classServerConnection.html#a5c1bf21b5efcc2b80985b397d3ee57f" title="Connect to the server and stay connected.">connect</a>(<span class="keyword">false</span>);
<a name="l00246"></a>00246 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="2779cc22d1b308d478c74fd4105d8ec3"></a><!-- doxytag: member="ServerConnection::error_message_received" ref="2779cc22d1b308d478c74fd4105d8ec3" args="(ServerMessageIn const &amp;msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::error_message_received           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classServerMessageIn.html">ServerMessageIn</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function is called if an ERROR message is received. 
<p>
Never call this function directly. 
<p>Definition at line <a class="el" href="ServerConnection_8cc-source.html#l00281">281</a> of file <a class="el" href="ServerConnection_8cc-source.html">ServerConnection.cc</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00214">DoutEntering</a>, <a class="el" href="ServerConnection_8h-source.html#l00073">M_connect_delay</a>, <a class="el" href="ServerConnection_8h-source.html#l00071">M_state</a>, <a class="el" href="MessageIn_8h-source.html#l00109">MessageIn::param()</a>, <a class="el" href="ServerConnection_8h-source.html#l00153">server_session()</a>, <a class="el" href="ServerSession_8h-source.html#l00175">ServerSession::set_disconnect_reason()</a>, and <a class="el" href="ServerConnection_8h-source.html#l00040">successful_connect</a>.</p>

<p>Referenced by <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00282"></a>00282 {
<a name="l00283"></a>00283   <a class="code" href="debug_8h.html#3dc350a548c074386c3ec0271d16a7a8" title="Debugging macro.">DoutEntering</a>(dc::notice, <span class="stringliteral">"ServerConnection::error_message_received("</span> &lt;&lt; msg &lt;&lt; <span class="stringliteral">")"</span>);
<a name="l00284"></a>00284 
<a name="l00285"></a>00285   <a class="code" href="classServerConnection.html#832a5728134205d1bcd2ef367b136c04" title="Return the ServerSession.">server_session</a>().<a class="code" href="classServerSession.html#107a2150c039e369b50ee3ffe1809457" title="Set the disconnect reason to disconnect_reason.">set_disconnect_reason</a>(msg.param(0));
<a name="l00286"></a>00286 
<a name="l00287"></a>00287   <span class="keywordflow">if</span> (<a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> &lt; <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef220561b24714ed87425f7d797a83f1f78" title="Received first server message.">successful_connect</a>)
<a name="l00288"></a>00288   {
<a name="l00289"></a>00289     <span class="comment">// FIXME: only do this when the connection was throttled.</span>
<a name="l00290"></a>00290     <span class="comment">// Different actions are needed on different errors.</span>
<a name="l00291"></a>00291     <a class="code" href="classServerConnection.html#0bd8fa9e9cfbfae860406eae4b270885" title="The next connect delay.">M_connect_delay</a>.tv_sec *= 2;  
<a name="l00292"></a>00292     <span class="keywordflow">if</span> (<a class="code" href="classServerConnection.html#0bd8fa9e9cfbfae860406eae4b270885" title="The next connect delay.">M_connect_delay</a>.tv_sec &gt; 600)
<a name="l00293"></a>00293       <a class="code" href="classServerConnection.html#0bd8fa9e9cfbfae860406eae4b270885" title="The next connect delay.">M_connect_delay</a>.tv_sec = 600;
<a name="l00294"></a>00294     Dout(dc::notice, <span class="stringliteral">"Incrementing connect delay to "</span> &lt;&lt; <a class="code" href="classServerConnection.html#0bd8fa9e9cfbfae860406eae4b270885" title="The next connect delay.">M_connect_delay</a>);
<a name="l00295"></a>00295   }
<a name="l00296"></a>00296 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5b7a006c3d2be22e831a6e29b054592c"></a><!-- doxytag: member="ServerConnection::successful_connection" ref="5b7a006c3d2be22e831a6e29b054592c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::successful_connection           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Called when the first message is received from the server. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8cc-source.html#l00300">300</a> of file <a class="el" href="ServerConnection_8cc-source.html">ServerConnection.cc</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="ServerConnection_8h-source.html#l00039">authentication_started</a>, <a class="el" href="ServerConnection_8h-source.html#l00073">M_connect_delay</a>, <a class="el" href="ServerConnection_8h-source.html#l00071">M_state</a>, <a class="el" href="ServerConnection_8h-source.html#l00080">M_timed_out_count</a>, <a class="el" href="ServerConnection_8h-source.html#l00074">S_connect_delay_init</a>, and <a class="el" href="ServerConnection_8h-source.html#l00040">successful_connect</a>.</p>

<p>Referenced by <a class="el" href="AuthState_8cc-source.html#l00103">AuthState::auth_notice_looking_up_hostname()</a>, <a class="el" href="AuthState_8cc-source.html#l00128">AuthState::auth_notice_looking_up_ident()</a>, and <a class="el" href="ServerConnection_8cc-source.html#l00312">decode_ping()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00301"></a>00301 {
<a name="l00302"></a>00302   <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> == <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef257f508eceda8432c9eab0643f0e6346d" title="PASS, NICK and USER message sent.">authentication_started</a> || <a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> == <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef220561b24714ed87425f7d797a83f1f78" title="Received first server message.">successful_connect</a>);
<a name="l00303"></a>00303   <a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> = <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef220561b24714ed87425f7d797a83f1f78" title="Received first server message.">successful_connect</a>;
<a name="l00304"></a>00304   <a class="code" href="classServerConnection.html#0bd8fa9e9cfbfae860406eae4b270885" title="The next connect delay.">M_connect_delay</a> = <a class="code" href="classServerConnection.html#119910e5efed5d10039adf7f13fb1167" title="The initial connect delay.">S_connect_delay_init</a>;       <span class="comment">// We didn't get throttled.</span>
<a name="l00305"></a>00305   <a class="code" href="classServerConnection.html#325de08b35f8b26eaea50b2edb0c4c36" title="The number of connect attempts left that will time out, until we stop trying.">M_timed_out_count</a> = 0;
<a name="l00306"></a>00306 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="61f1caf7c83a2bdef5d6d75968754fcd"></a><!-- doxytag: member="ServerConnection::decode_ping" ref="61f1caf7c83a2bdef5d6d75968754fcd" args="(ServerMessageIn const &amp;pong_msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::decode_ping           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classServerMessageIn.html">ServerMessageIn</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>ping_msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function is called when a PING message is received. 
<p>
Never call this function directly. 
<p>Definition at line <a class="el" href="ServerConnection_8cc-source.html#l00312">312</a> of file <a class="el" href="ServerConnection_8cc-source.html">ServerConnection.cc</a>.</p>

<p>References <a class="el" href="Priority_8cc-source.html#l00023">default_priority()</a>, <a class="el" href="ServerConnection_8h-source.html#l00060">M_server_session</a>, <a class="el" href="ServerConnection_8h-source.html#l00071">M_state</a>, <a class="el" href="MessageIn_8h-source.html#l00109">MessageIn::param()</a>, <a class="el" href="ServerConnection_8h-source.html#l00041">pong_sent</a>, <a class="el" href="ServerSession_8h-source.html#l00135">ServerSession::queue_msg()</a>, <a class="el" href="ServerConnection_8h-source.html#l00043">real_nick_sent</a>, <a class="el" href="ServerConnection_8h-source.html#l00153">server_session()</a>, <a class="el" href="ServerSession_8h-source.html#l00091">ServerSession::set_auth_ping_argument()</a>, and <a class="el" href="ServerConnection_8cc-source.html#l00300">successful_connection()</a>.</p>

<p>Referenced by <a class="el" href="ServerSession_8cc-source.html#l00032">ServerSession::new_message_received()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00313"></a>00313 {
<a name="l00314"></a>00314   <span class="keywordflow">if</span> (<a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> &gt;= <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef23fcdc806883284d1121056468515dc4d" title="NICK with real nick name sent.">real_nick_sent</a>)
<a name="l00315"></a>00315   {
<a name="l00316"></a>00316     <a class="code" href="classMessageOut.html" title="An output message.">MessageOut</a> msgout(<a class="code" href="Priority_8cc.html#18032271e548be4e8a0bacc13c4785f0" title="Return the default priority for command.">default_priority</a>(keys::PONG));
<a name="l00317"></a>00317     <a class="code" href="classServerConnection.html#832a5728134205d1bcd2ef367b136c04" title="Return the ServerSession.">server_session</a>().<a class="code" href="classServerSession.html#6921a52d4541f22dc13cf48b743baf19" title="Queue message msg.">queue_msg</a>(msgout &lt;&lt; keys::PONG &lt;&lt; ping_msg.param(0));
<a name="l00318"></a>00318   }
<a name="l00319"></a>00319   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> &gt;= <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2e329594b1df5c5307e5e5126edb1d605" title="PONG and MODE +i sent.">pong_sent</a>)
<a name="l00320"></a>00320     *<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a> &lt;&lt; <span class="stringliteral">"PONG "</span> &lt;&lt; ping_msg.param(0) &lt;&lt; <span class="stringliteral">"\r\n"</span>;
<a name="l00321"></a>00321   <span class="keywordflow">else</span>
<a name="l00322"></a>00322   {
<a name="l00323"></a>00323     <a class="code" href="classServerConnection.html#5b7a006c3d2be22e831a6e29b054592c" title="Called when the first message is received from the server.">successful_connection</a>();
<a name="l00324"></a>00324     <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>-&gt;<a class="code" href="classServerSession.html#007e71fd0ebc59b15455cf7cfc73acd3" title="Called from ServerConnection::decode_ping with the argument of the first PING.">set_auth_ping_argument</a>(ping_msg.param(0));
<a name="l00325"></a>00325   }
<a name="l00326"></a>00326 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5d35def1ca0c87f06ba7d7f685f64e72"></a><!-- doxytag: member="ServerConnection::send_pong_and_mode" ref="5d35def1ca0c87f06ba7d7f685f64e72" args="(ExpressionEventType const &amp;event_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::send_pong_and_mode           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classExpressionEventType.html">ExpressionEventType</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>event_type</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function is called when it is safe to call it. 
<p>
See <a class="el" href="classAuthState.html#d59117fea56a3a6e52ed0eceaeded634" title="Contruct a new AuthState object, starting a new authentication cycle.">AuthState::AuthState</a>. Never call this function directly. 
<p>Definition at line <a class="el" href="ServerConnection_8cc-source.html#l00333">333</a> of file <a class="el" href="ServerConnection_8cc-source.html">ServerConnection.cc</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="ServerSession_8h-source.html#l00094">ServerSession::auth_ping_argument()</a>, <a class="el" href="debug_8h-source.html#l00214">DoutEntering</a>, <a class="el" href="ServerConnection_8cc-source.html#l00377">invisible_event()</a>, <a class="el" href="ServerSession_8h-source.html#l00069">ServerSession::M_detected_network</a>, <a class="el" href="ServerConnection_8h-source.html#l00057">M_server</a>, <a class="el" href="ServerConnection_8h-source.html#l00060">M_server_session</a>, <a class="el" href="ServerConnection_8h-source.html#l00071">M_state</a>, <a class="el" href="ServerSession_8h-source.html#l00112">ServerSession::message_event_server()</a>, <a class="el" href="Matcher_8h-source.html#l00308">MatchRequest::mynick()</a>, <a class="el" href="ServerSession_8h-source.html#l00117">ServerSession::nicks()</a>, <a class="el" href="NickPair_8h-source.html#l00050">NickPair::out_nick()</a>, <a class="el" href="ServerConnection_8h-source.html#l00041">pong_sent</a>, <a class="el" href="ServerConnection_8cc-source.html#l00392">received_first_umode()</a>, <a class="el" href="ServerConnection_8h-source.html#l00040">successful_connect</a>, and <a class="el" href="ServerSession_8h-source.html#l00129">ServerSession::user_mode()</a>.</p>

<p>Referenced by <a class="el" href="AuthState_8cc-source.html#l00075">AuthState::send_pong_and_mode()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00334"></a>00334 {
<a name="l00335"></a>00335   <a class="code" href="debug_8h.html#3dc350a548c074386c3ec0271d16a7a8" title="Debugging macro.">DoutEntering</a>(dc::notice, <span class="stringliteral">"ServerConnection::send_pong_and_mode("</span> &lt;&lt; event_type &lt;&lt; <span class="stringliteral">")"</span>);
<a name="l00336"></a>00336 
<a name="l00337"></a>00337   <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> == <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef220561b24714ed87425f7d797a83f1f78" title="Received first server message.">successful_connect</a>);                        <span class="comment">// We received at least the PING.</span>
<a name="l00338"></a>00338   <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(!<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>-&gt;<a class="code" href="classServerSession.html#a194c92493a43f5c86d79eb5ea8e9c27" title="Return argument of the first PING.">auth_ping_argument</a>().empty());      <span class="comment">// Didn't we?</span>
<a name="l00339"></a>00339 
<a name="l00340"></a>00340   *<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a> &lt;&lt; <span class="stringliteral">"PONG "</span> &lt;&lt; <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>-&gt;<a class="code" href="classServerSession.html#a194c92493a43f5c86d79eb5ea8e9c27" title="Return argument of the first PING.">auth_ping_argument</a>() &lt;&lt; <span class="stringliteral">"\r\n"</span>;
<a name="l00341"></a>00341   <a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> = <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2e329594b1df5c5307e5e5126edb1d605" title="PONG and MODE +i sent.">pong_sent</a>;
<a name="l00342"></a>00342 
<a name="l00343"></a>00343   <span class="comment">// Send the 'invisible' user mode in the same packet as the PONG, in the hope</span>
<a name="l00344"></a>00344   <span class="comment">// that the server will process them at the same time. That way we are not</span>
<a name="l00345"></a>00345   <span class="comment">// (for 2 seconds) visible to the network.</span>
<a name="l00346"></a>00346   <span class="comment">// Thus, we will have sent [PASS], NICK, USER, PONG, MODE +i -- which should</span>
<a name="l00347"></a>00347   <span class="comment">// be processed immediately (we have 5 free messages before the flood protection</span>
<a name="l00348"></a>00348   <span class="comment">// kicks in).</span>
<a name="l00349"></a>00349   <span class="keywordtype">char</span> service_mode = <span class="charliteral">'x'</span>;      <span class="comment">// FIXME, this isn't the same on every network.</span>
<a name="l00350"></a>00350   <span class="comment">// If we don't know if the USER did set the user mode, ask for the user mode to see if it did.</span>
<a name="l00351"></a>00351   <span class="comment">// Always sent the +i to assure invisibility at the same time as the PONG is</span>
<a name="l00352"></a>00352   <span class="comment">// processed.</span>
<a name="l00353"></a>00353   <span class="keywordflow">if</span> (!<a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>-&gt;version().get_user_supports_umode())
<a name="l00354"></a>00354   {
<a name="l00355"></a>00355     <span class="comment">// Always set invisibility.</span>
<a name="l00356"></a>00356     *<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a> &lt;&lt; <span class="stringliteral">"MODE "</span> &lt;&lt; <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>-&gt;<a class="code" href="classServerSession.html#3bf7aaaf37f650ecae8ede46fddb06e6" title="Server session nick pair.">nicks</a>().<a class="code" href="classNickPair.html#3b35892ac9ec3e9b7a8c5354675da03f" title="Returns the last NICK sent.">out_nick</a>() &lt;&lt; <span class="stringliteral">" +i\r\n"</span>;
<a name="l00357"></a>00357     <span class="comment">// Test.</span>
<a name="l00358"></a>00358     *<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a> &lt;&lt; <span class="stringliteral">"MODE "</span> &lt;&lt; <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>-&gt;<a class="code" href="classServerSession.html#3bf7aaaf37f650ecae8ede46fddb06e6" title="Server session nick pair.">nicks</a>().<a class="code" href="classNickPair.html#3b35892ac9ec3e9b7a8c5354675da03f" title="Returns the last NICK sent.">out_nick</a>() &lt;&lt; <span class="stringliteral">"\r\n"</span>;
<a name="l00359"></a>00359     <span class="comment">// Finish.</span>
<a name="l00360"></a>00360     *<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a> &lt;&lt; <span class="stringliteral">"MODE "</span> &lt;&lt; <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>-&gt;<a class="code" href="classServerSession.html#3bf7aaaf37f650ecae8ede46fddb06e6" title="Server session nick pair.">nicks</a>().<a class="code" href="classNickPair.html#3b35892ac9ec3e9b7a8c5354675da03f" title="Returns the last NICK sent.">out_nick</a>() &lt;&lt; <span class="stringliteral">" +"</span> &lt;&lt; service_mode &lt;&lt; <span class="stringliteral">"\r\n"</span>;
<a name="l00361"></a>00361   }
<a name="l00362"></a>00362   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!*<a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>-&gt;version().get_user_supports_umode())
<a name="l00363"></a>00363     *<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a> &lt;&lt; <span class="stringliteral">"MODE "</span> &lt;&lt; <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>-&gt;<a class="code" href="classServerSession.html#3bf7aaaf37f650ecae8ede46fddb06e6" title="Server session nick pair.">nicks</a>().<a class="code" href="classNickPair.html#3b35892ac9ec3e9b7a8c5354675da03f" title="Returns the last NICK sent.">out_nick</a>() &lt;&lt; <span class="stringliteral">" +i"</span> &lt;&lt; service_mode &lt;&lt; <span class="stringliteral">"\r\n"</span>;
<a name="l00364"></a>00364 
<a name="l00365"></a>00365   <a class="code" href="classConstExpression.html" title="An expression consisting of a constant.">ConstExpression&lt;UserModeMask&gt;</a> mask(<a class="code" href="structUserModeMask.html">UserModeMask</a>(<span class="charliteral">'i'</span>) | service_mode);
<a name="l00366"></a>00366   ON_TRUE((*<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>-&gt;<a class="code" href="classServerSession.html#eb14b6156420f8413e9d3e905688783d" title="Return my user mode.">user_mode</a>() &amp; mask) == mask &amp;&amp; *<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>-&gt;<a class="code" href="classServerSession.html#ff50b0591d529f0a69d9c9f05695f716" title="True if the network is fully detected.">M_detected_network</a>, *<span class="keyword">this</span>, &amp;<a class="code" href="classServerConnection.html#4c6cc9ba1f2ebf73e0173d00df30cac3" title="Called when we first turn invisible.">ServerConnection::invisible_event</a>);
<a name="l00367"></a>00367 
<a name="l00368"></a>00368   <a class="code" href="classMatchRequest.html" title="A match request.">MatchRequest</a> match_request;
<a name="l00369"></a>00369   match_request(keys::MODE).<a class="code" href="classMatchRequest.html#b5ca0d5cb18fa48ce6ce3b9beaa480c4" title="Request a match if parameter param contains our nick name.">mynick</a>(0);
<a name="l00370"></a>00370   <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>-&gt;<a class="code" href="classServerSession.html#8fc297dda17c13decc4906f165d2de19" title="Return a reference to the event server for incoming messages.">message_event_server</a>()(match_request, *<span class="keyword">this</span>, &amp;<a class="code" href="classServerConnection.html#f8258e3de592f47fab265f0d1a0abd44" title="Called for the first MODE &amp;lt;mynick&amp;gt; received from the server.">ServerConnection::received_first_umode</a>);
<a name="l00371"></a>00371 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f8258e3de592f47fab265f0d1a0abd44"></a><!-- doxytag: member="ServerConnection::received_first_umode" ref="f8258e3de592f47fab265f0d1a0abd44" args="(MatcherEventType const &amp;event_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::received_first_umode           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatcherEventType.html">MatcherEventType</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>event_type</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Called for the first MODE &lt;mynick&gt; received from the server. 
<p>
This call-back is used to extract the real ident and real hostname, as the IRC server sees it. 
<p>Definition at line <a class="el" href="ServerConnection_8cc-source.html#l00392">392</a> of file <a class="el" href="ServerConnection_8cc-source.html">ServerConnection.cc</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="debug_8h-source.html#l00214">DoutEntering</a>, <a class="el" href="IdentityReference_8h-source.html#l00037">IdentityReference::identity()</a>, <a class="el" href="Matcher_8h-source.html#l00367">MatcherEventType::message()</a>, <a class="el" href="MessageIn_8h-source.html#l00127">MessageIn::prefix_part()</a>, <a class="el" href="Identity_8h-source.html#l00159">Identity::set_ident()</a>, and <a class="el" href="Identity_8h-source.html#l00163">Identity::set_real_hostname()</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00333">send_pong_and_mode()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00393"></a>00393 {
<a name="l00394"></a>00394   <a class="code" href="debug_8h.html#3dc350a548c074386c3ec0271d16a7a8" title="Debugging macro.">DoutEntering</a>(dc::debug, <span class="stringliteral">"ServerConnection::received_first_umode("</span> &lt;&lt; event_type &lt;&lt; <span class="stringliteral">")"</span>);
<a name="l00395"></a>00395   <a class="code" href="classMessageIn_1_1Part.html" title="Part of an MessageIn.">MessageIn::Part</a> <span class="keyword">const</span>&amp; prefix(event_type.message().prefix_part());
<a name="l00396"></a>00396   <span class="keywordtype">char</span> <span class="keyword">const</span>* p = strchr(prefix.start(), <span class="charliteral">'!'</span>);
<a name="l00397"></a>00397   <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(p);
<a name="l00398"></a>00398   <span class="keywordtype">char</span> <span class="keyword">const</span>* ident = p + 1;
<a name="l00399"></a>00399   p = strchr(p, <span class="charliteral">'@'</span>);
<a name="l00400"></a>00400   <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(p);
<a name="l00401"></a>00401   <span class="keywordtype">size_t</span> ident_len = p - ident;
<a name="l00402"></a>00402   <span class="keywordtype">char</span> <span class="keyword">const</span>* real_hostname = p + 1;
<a name="l00403"></a>00403   <span class="keywordtype">size_t</span> real_hostname_len = prefix.end() - real_hostname;
<a name="l00404"></a>00404   <a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().<a class="code" href="classIdentity.html#c82636dc236ae926a782ca602b800ff5" title="Set host name string as returned by real_hostname().">set_real_hostname</a>(std::string(real_hostname, real_hostname_len));
<a name="l00405"></a>00405   <a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().<a class="code" href="classIdentity.html#07a9dbfdd574e3661874ac30e810f699" title="Set ident string as returned by ident().">set_ident</a>(std::string(ident, ident_len));
<a name="l00406"></a>00406 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8d362234844f0be20b157f1f8d8756e7"></a><!-- doxytag: member="ServerConnection::is_connected" ref="8d362234844f0be20b157f1f8d8756e7" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ServerConnection::is_connected           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if we are connected with a server. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00190">190</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00068">M_connected</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00138">delayed_connect()</a>, and <a class="el" href="debug__ostream__operators_8cc-source.html#l00318">operator&lt;&lt;()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00190"></a>00190 { <span class="keywordflow">return</span> <a class="code" href="classServerConnection.html#a0d3f683f7af15bbc0a84203bde206b9">M_connected</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c1772a42084aa68f59995d694b1ecf85"></a><!-- doxytag: member="ServerConnection::reconnect" ref="c1772a42084aa68f59995d694b1ecf85" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ServerConnection::reconnect           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return true if we try to (stay) connect(ed). 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00193">193</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00063">M_reconnect</a>.</p>

<p>Referenced by <a class="el" href="debug__ostream__operators_8cc-source.html#l00318">operator&lt;&lt;()</a>, and <a class="el" href="ServerSession_8cc-source.html#l00334">ServerSession::~ServerSession()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00193"></a>00193 { <span class="keywordflow">return</span> <a class="code" href="classServerConnection.html#da968ead31fd07d9964f251530cc81d3" title="True if we should try to (re)connect.">M_reconnect</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="fc6d34c855c60f8bf8309657345e8bdf"></a><!-- doxytag: member="ServerConnection::connect_delay" ref="fc6d34c855c60f8bf8309657345e8bdf" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">timeval ServerConnection::connect_delay           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Accessor for M_connect_delay. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00196">196</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00073">M_connect_delay</a>.</p>

<p>Referenced by <a class="el" href="debug__ostream__operators_8cc-source.html#l00318">operator&lt;&lt;()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00196"></a>00196 { <span class="keywordflow">return</span> <a class="code" href="classServerConnection.html#0bd8fa9e9cfbfae860406eae4b270885" title="The next connect delay.">M_connect_delay</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c05da809200d6c4dd415e36e9c0be9a1"></a><!-- doxytag: member="ServerConnection::timed_out" ref="c05da809200d6c4dd415e36e9c0be9a1" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ServerConnection::timed_out           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Accessor for M_timed_out. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00199">199</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00077">M_timed_out</a>.</p>

<p>Referenced by <a class="el" href="debug__ostream__operators_8cc-source.html#l00318">operator&lt;&lt;()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00199"></a>00199 { <span class="keywordflow">return</span> <a class="code" href="classServerConnection.html#f242a50989467275c426f9e25ad74b6b" title="Set if the last connection attempted timed out.">M_timed_out</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8edbdbceff10b2fc18ab0eb056489430"></a><!-- doxytag: member="ServerConnection::timed_out_count" ref="8edbdbceff10b2fc18ab0eb056489430" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ServerConnection::timed_out_count           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Accessor for M_timed_out_count. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00202">202</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00080">M_timed_out_count</a>.</p>

<p>Referenced by <a class="el" href="debug__ostream__operators_8cc-source.html#l00318">operator&lt;&lt;()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00202"></a>00202 { <span class="keywordflow">return</span> <a class="code" href="classServerConnection.html#325de08b35f8b26eaea50b2edb0c4c36" title="The number of connect attempts left that will time out, until we stop trying.">M_timed_out_count</a>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="4c6cc9ba1f2ebf73e0173d00df30cac3"></a><!-- doxytag: member="ServerConnection::invisible_event" ref="4c6cc9ba1f2ebf73e0173d00df30cac3" args="(ExpressionEventType const &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::invisible_event           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classExpressionEventType.html">ExpressionEventType</a> const &amp;&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Called when we first turn invisible. 
<p>
This function is called when MODE +i is received.<p>
Never call this function directly. 
<p>Definition at line <a class="el" href="ServerConnection_8cc-source.html#l00377">377</a> of file <a class="el" href="ServerConnection_8cc-source.html">ServerConnection.cc</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="Identity_8h-source.html#l00282">Identity::authentication()</a>, <a class="el" href="debug_8h-source.html#l00214">DoutEntering</a>, <a class="el" href="IdentityReference_8h-source.html#l00037">IdentityReference::identity()</a>, <a class="el" href="Identity_8h-source.html#l00126">Identity::key()</a>, <a class="el" href="ServerConnection_8h-source.html#l00042">login_sent</a>, <a class="el" href="ServerConnection_8h-source.html#l00060">M_server_session</a>, <a class="el" href="ServerConnection_8h-source.html#l00071">M_state</a>, <a class="el" href="ServerConnection_8h-source.html#l00041">pong_sent</a>, and <a class="el" href="Authentication_8h-source.html#l00064">Authentication::service_pass()</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00333">send_pong_and_mode()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00378"></a>00378 {
<a name="l00379"></a>00379   <a class="code" href="debug_8h.html#3dc350a548c074386c3ec0271d16a7a8" title="Debugging macro.">DoutEntering</a>(dc::notice, <span class="stringliteral">"ServerConnection::invisible_event("</span> &lt;&lt; event_type &lt;&lt; <span class="charliteral">')'</span>);
<a name="l00380"></a>00380   <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(event_type);   <span class="comment">// It should be true, of course.</span>
<a name="l00381"></a>00381   
<a name="l00382"></a>00382   <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> == <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2e329594b1df5c5307e5e5126edb1d605" title="PONG and MODE +i sent.">pong_sent</a>);
<a name="l00383"></a>00383   <a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> = <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef27fedf7842abd845d06c188fc73e5775b" title="Login message to X sent.">login_sent</a>;
<a name="l00384"></a>00384   *<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a> &lt;&lt; <span class="stringliteral">"PRIVMSG X@channels.undernet.org :login "</span> &lt;&lt;
<a name="l00385"></a>00385       <a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().<a class="code" href="classIdentity.html#0cfb4a50c8b09d335de9f268aa1fc5de" title="The key of this Identity.">key</a>() &lt;&lt; <span class="charliteral">' '</span> &lt;&lt; <a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().<a class="code" href="classIdentity.html#b94224aa9917eafb7885d0411cf4bfd9" title="Return the authentication object.">authentication</a>().<a class="code" href="classAuthentication.html#8d36f4697dab1354c0033cdf01b40f0b" title="Return the Service password (used to login into X, for example).">service_pass</a>() &lt;&lt; <span class="stringliteral">"\r\n"</span>;
<a name="l00386"></a>00386 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="dcd89496205b529710f2159fb29a3fd5"></a><!-- doxytag: member="ServerConnection::make_primary" ref="dcd89496205b529710f2159fb29a3fd5" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::make_primary           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<p><b>For internal use only.</b></p>
<p>
</p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00208">208</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00083">M_secondary_connection</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00208"></a>00208 { <a class="code" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb" title="True if this connection is a secondary connection, while the primary still exists...">M_secondary_connection</a> = <span class="keyword">false</span>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7d0a881ff795d8189da0dacd839ba01d"></a><!-- doxytag: member="ServerConnection::make_secondary" ref="7d0a881ff795d8189da0dacd839ba01d" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::make_secondary           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<p><b>For internal use only.</b></p>
<p>
</p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00211">211</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>References <a class="el" href="ServerConnection_8h-source.html#l00083">M_secondary_connection</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00211"></a>00211 { <a class="code" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb" title="True if this connection is a secondary connection, while the primary still exists...">M_secondary_connection</a> = <span class="keyword">true</span>; }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0bb470a3215a2780f846e806897359c5"></a><!-- doxytag: member="ServerConnection::do_connect" ref="0bb470a3215a2780f846e806897359c5" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnection::do_connect           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Attempt an immediate connect to the server. 
<p>
Never call this function directly. Call <a class="el" href="classServerConnection.html#a5c1bf21b5efcc2b80985b397d3ee57f" title="Connect to the server and stay connected.">ServerConnection::connect()</a> instead. 
<p>Definition at line <a class="el" href="ServerConnection_8cc-source.html#l00149">149</a> of file <a class="el" href="ServerConnection_8cc-source.html">ServerConnection.cc</a>.</p>

<p>References <a class="el" href="debug_8h-source.html#l00062">ASSERT</a>, <a class="el" href="ServerConnection_8h-source.html#l00039">authentication_started</a>, <a class="el" href="Identity_8h-source.html#l00208">Identity::client_session()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="ClientSession_8cc-source.html#l00206">ClientSession::del_private_target()</a>, <a class="el" href="ServerConnection_8h-source.html#l00038">disconnected</a>, <a class="el" href="debug_8h-source.html#l00214">DoutEntering</a>, <a class="el" href="IdentityReference_8h-source.html#l00037">IdentityReference::identity()</a>, <a class="el" href="ServerConnection_8h-source.html#l00068">M_connected</a>, <a class="el" href="ServerConnection_8h-source.html#l00083">M_secondary_connection</a>, <a class="el" href="ServerConnection_8h-source.html#l00057">M_server</a>, <a class="el" href="ServerConnection_8h-source.html#l00060">M_server_session</a>, <a class="el" href="ServerConnection_8h-source.html#l00071">M_state</a>, <a class="el" href="ServerConnection_8h-source.html#l00077">M_timed_out</a>, <a class="el" href="UserAnswer_8cc-source.html#l00027">question_target_name()</a>, <a class="el" href="Identity_8cc-source.html#l00753">Identity::send_notice()</a>, <a class="el" href="question__nt_8h-source.html#l00023">server_port_question</a>, and <a class="el" href="ServerSession_8cc-source.html#l00322">ServerSession::start_authentication()</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, and <a class="el" href="ServerConnection_8cc-source.html#l00138">delayed_connect()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00150"></a>00150 {
<a name="l00151"></a>00151   <a class="code" href="debug_8h.html#3dc350a548c074386c3ec0271d16a7a8" title="Debugging macro.">DoutEntering</a>(dc::debug, <span class="stringliteral">"ServerConnection::do_connect()"</span>);
<a name="l00152"></a>00152   <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> == <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2519f950c18a0ec32082cf9984cd2b225" title="Disconnected.">disconnected</a>);
<a name="l00153"></a>00153 
<a name="l00154"></a>00154   <span class="keywordflow">if</span> (<a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().has_client_session())
<a name="l00155"></a>00155   {
<a name="l00156"></a>00156     std::ostringstream buf;
<a name="l00157"></a>00157     buf &lt;&lt; <span class="stringliteral">"Trying to connect to \""</span> &lt;&lt; <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>-&gt;hostname().c_str() &lt;&lt; <span class="stringliteral">"\" (port "</span> &lt;&lt; <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>-&gt;next_port() &lt;&lt; <span class="stringliteral">")."</span>;
<a name="l00158"></a>00158     <a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().<a class="code" href="classIdentity.html#ad20e55e2b6fbe3022e63c3223abae08" title="Send a notice to the client.">send_notice</a>(buf.str(), <a class="code" href="question__nt_8h.html#027b743250267c94e5a1a63e0bbb3846bb516cb7284441ea7de98a9408a8351f" title="What server should I connect to (type: &amp;lt;server&amp;gt; [&amp;lt;port&amp;gt; [&amp;lt;localip&amp;gt;]])...">server_port_question</a>);
<a name="l00159"></a>00159   }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161   <span class="comment">// Reset the timed_out flag.</span>
<a name="l00162"></a>00162   <a class="code" href="classServerConnection.html#f242a50989467275c426f9e25ad74b6b" title="Set if the last connection attempted timed out.">M_timed_out</a> = <span class="keyword">false</span>;
<a name="l00163"></a>00163   <span class="comment">// Set new time out timer.</span>
<a name="l00164"></a>00164   timeval delay = { 4, 0 };
<a name="l00165"></a>00165   timerRequest(delay, *<span class="keyword">this</span>, &amp;ServerConnection::connect_timed_out);
<a name="l00166"></a>00166 
<a name="l00167"></a>00167   <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(<a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>-&gt;next_port() != 0);
<a name="l00168"></a>00168   <span class="keywordflow">if</span> (<a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>-&gt;connect(<a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>-&gt;hostname().c_str(), <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>-&gt;next_port(), <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>-&gt;vhost()))
<a name="l00169"></a>00169   {
<a name="l00170"></a>00170     <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>-&gt;attempting_to_connect();
<a name="l00171"></a>00171     <a class="code" href="classServerConnection.html#a0d3f683f7af15bbc0a84203bde206b9">M_connected</a> = <span class="keyword">true</span>;
<a name="l00172"></a>00172     <a class="code" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66" title="A pointer to the current server session, or NULL when there is none.">M_server_session</a>-&gt;<a class="code" href="classServerSession.html#b5e541da0e832562f5bf104ae2973a6e" title="Called from ServerConnection::do_connect. Takes care of sending PASS/NICK/USER/PONG/MODE...">start_authentication</a>();
<a name="l00173"></a>00173     <a class="code" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea" title="The state of the connection.">M_state</a> = <a class="code" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef257f508eceda8432c9eab0643f0e6346d" title="PASS, NICK and USER message sent.">authentication_started</a>;
<a name="l00174"></a>00174   }
<a name="l00175"></a>00175   <span class="keywordflow">else</span>
<a name="l00176"></a>00176   {
<a name="l00177"></a>00177     <a class="code" href="debug_8h.html#ca68c0d4ac8df0838e209fb5300f7be3" title="Assert if debugging is turned on.">ASSERT</a>(!<a class="code" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb" title="True if this connection is a secondary connection, while the primary still exists...">M_secondary_connection</a>);    <span class="comment">// FIXME</span>
<a name="l00178"></a>00178     <span class="comment">// If the connect failed, then we have to ask the user for another servername.</span>
<a name="l00179"></a>00179     <a class="code" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834" title="The server that we are connected to or trying to connect to, or NULL when the server...">M_server</a>.reset();
<a name="l00180"></a>00180     <span class="keywordflow">if</span> (<a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().has_client_session())
<a name="l00181"></a>00181       <a class="code" href="classIdentityReference.html#d6ecfc07c4dba821671a00c8ced70b04" title="Returns a const reference to the underlying identity.">identity</a>().<a class="code" href="classIdentity.html#4cd26e4bddc74ee29d48d62eb36998ec" title="Return the current ClientSession.">client_session</a>().<a class="code" href="classClientSession.html#488ed5623c5661d68bf7a80825a53897" title="Remove target_name from the private targets list.">del_private_target</a>(<a class="code" href="UserAnswer_8cc.html#aae7ee220771f4ad3ecc9ac74c87e7b0" title="Convert question index number into the channel name it belongs to.">question_target_name</a>(<a class="code" href="question__nt_8h.html#027b743250267c94e5a1a63e0bbb3846bb516cb7284441ea7de98a9408a8351f" title="What server should I connect to (type: &amp;lt;server&amp;gt; [&amp;lt;port&amp;gt; [&amp;lt;localip&amp;gt;]])...">server_port_question</a>));
<a name="l00182"></a>00182     <span class="comment">// Try again.</span>
<a name="l00183"></a>00183     <a class="code" href="classServerConnection.html#a5c1bf21b5efcc2b80985b397d3ee57f" title="Connect to the server and stay connected.">connect</a>(<span class="keyword">true</span>);
<a name="l00184"></a>00184   }
<a name="l00185"></a>00185 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Friends And Related Function Documentation</h2>
<a class="anchor" name="854fdc699d94494e229e845d6e75e5f1"></a><!-- doxytag: member="ServerConnection::operator&lt;&lt;" ref="854fdc699d94494e229e845d6e75e5f1" args="(std::ostream &amp;os, ServerConnection const &amp;server_connection)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt;           </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classServerConnection.html">ServerConnection</a> const &amp;&nbsp;</td>
          <td class="paramname"> <em>server_connection</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
For debugging purposes. Write a <a class="el" href="classServerConnection.html" title="Object representing the server-side connection.">ServerConnection</a> to <em>os</em>. 
<p>

<p>Definition at line <a class="el" href="debug__ostream__operators_8cc-source.html#l00318">318</a> of file <a class="el" href="debug__ostream__operators_8cc-source.html">debug_ostream_operators.cc</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00319"></a>00319 {
<a name="l00320"></a>00320   os &lt;&lt; <span class="stringliteral">"{server:"</span>;
<a name="l00321"></a>00321   <span class="keywordflow">if</span> (server_connection.M_server.get())
<a name="l00322"></a>00322     os &lt;&lt; *server_connection.M_server.get();
<a name="l00323"></a>00323   <span class="keywordflow">else</span>
<a name="l00324"></a>00324     os &lt;&lt; <span class="stringliteral">"&lt;none&gt;"</span>;
<a name="l00325"></a>00325   os &lt;&lt; <span class="stringliteral">"; server_session:"</span>;
<a name="l00326"></a>00326   <span class="keywordflow">if</span> (server_connection.has_server_session())
<a name="l00327"></a>00327     os &lt;&lt; server_connection.server_session();
<a name="l00328"></a>00328   <span class="keywordflow">else</span>
<a name="l00329"></a>00329     os &lt;&lt; <span class="stringliteral">"&lt;NULL&gt;"</span>;
<a name="l00330"></a>00330   os &lt;&lt; <span class="stringliteral">"; reconnect:"</span>;
<a name="l00331"></a>00331   <span class="keywordflow">if</span> (server_connection.reconnect())
<a name="l00332"></a>00332     os &lt;&lt; <span class="stringliteral">"true"</span>;
<a name="l00333"></a>00333   <span class="keywordflow">else</span>
<a name="l00334"></a>00334     os &lt;&lt; <span class="stringliteral">"false"</span>;
<a name="l00335"></a>00335   os &lt;&lt; <span class="stringliteral">"; connected:"</span>;
<a name="l00336"></a>00336   <span class="keywordflow">if</span> (server_connection.is_connected())
<a name="l00337"></a>00337     os &lt;&lt; <span class="stringliteral">"true"</span>;
<a name="l00338"></a>00338   <span class="keywordflow">else</span>
<a name="l00339"></a>00339     os &lt;&lt; <span class="stringliteral">"false"</span>;
<a name="l00340"></a>00340   os &lt;&lt; <span class="stringliteral">"; state:"</span> &lt;&lt; server_connection.state();
<a name="l00341"></a>00341   os &lt;&lt; <span class="stringliteral">"; connect_delay:"</span> &lt;&lt; server_connection.connect_delay();
<a name="l00342"></a>00342   os &lt;&lt; <span class="stringliteral">"; timed_out:"</span>;
<a name="l00343"></a>00343   <span class="keywordflow">if</span> (server_connection.timed_out())
<a name="l00344"></a>00344     os &lt;&lt; <span class="stringliteral">"true"</span>;
<a name="l00345"></a>00345   <span class="keywordflow">else</span>
<a name="l00346"></a>00346     os &lt;&lt; <span class="stringliteral">"false"</span>;
<a name="l00347"></a>00347   os &lt;&lt; <span class="stringliteral">"; timed_out_count:"</span> &lt;&lt; server_connection.timed_out_count();
<a name="l00348"></a>00348   os &lt;&lt; <span class="stringliteral">"; secondary_connection:"</span> &lt;&lt; server_connection.secondary_connection();
<a name="l00349"></a>00349   <span class="keywordflow">return</span> os &lt;&lt; <span class="charliteral">'}'</span>;
<a name="l00350"></a>00350 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="32cfadcb86d87c251daca5574a492834"></a><!-- doxytag: member="ServerConnection::M_server" ref="32cfadcb86d87c251daca5574a492834" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classServer.html">Server</a>&gt; <a class="el" href="classServerConnection.html#32cfadcb86d87c251daca5574a492834">ServerConnection::M_server</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The server that we are connected to or trying to connect to, or NULL when the server is still unknown. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00057">57</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00149">do_connect()</a>, <a class="el" href="ServerConnection_8h-source.html#l00141">has_server()</a>, <a class="el" href="debug__ostream__operators_8cc-source.html#l00318">operator&lt;&lt;()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00201">received_server_port_answer()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00333">send_pong_and_mode()</a>, <a class="el" href="ServerConnection_8h-source.html#l00144">server()</a>, and <a class="el" href="ServerConnection_8cc-source.html#l00252">session_lost()</a>.</p>

</div>
</div><p>
<a class="anchor" name="54a242749c6d8c4f074d54cb034c7b66"></a><!-- doxytag: member="ServerConnection::M_server_session" ref="54a242749c6d8c4f074d54cb034c7b66" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classServerSession.html">ServerSession</a>* <a class="el" href="classServerConnection.html#54a242749c6d8c4f074d54cb034c7b66">ServerConnection::M_server_session</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
A pointer to the current server session, or NULL when there is none. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00060">60</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00312">decode_ping()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00138">delayed_connect()</a>, <a class="el" href="ServerConnection_8h-source.html#l00168">disconnect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00149">do_connect()</a>, <a class="el" href="ServerConnection_8h-source.html#l00150">has_server_session()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00377">invisible_event()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00333">send_pong_and_mode()</a>, <a class="el" href="ServerConnection_8h-source.html#l00153">server_session()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00252">session_lost()</a>, and <a class="el" href="ServerConnection_8h-source.html#l00111">~ServerConnection()</a>.</p>

</div>
</div><p>
<a class="anchor" name="da968ead31fd07d9964f251530cc81d3"></a><!-- doxytag: member="ServerConnection::M_reconnect" ref="da968ead31fd07d9964f251530cc81d3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classServerConnection.html#da968ead31fd07d9964f251530cc81d3">ServerConnection::M_reconnect</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
True if we should try to (re)connect. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00063">63</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00138">delayed_connect()</a>, <a class="el" href="ServerConnection_8h-source.html#l00168">disconnect()</a>, <a class="el" href="ServerConnection_8h-source.html#l00193">reconnect()</a>, and <a class="el" href="ServerConnection_8cc-source.html#l00252">session_lost()</a>.</p>

</div>
</div><p>
<a class="anchor" name="a0d3f683f7af15bbc0a84203bde206b9"></a><!-- doxytag: member="ServerConnection::M_connected" ref="a0d3f683f7af15bbc0a84203bde206b9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classServerConnection.html#a0d3f683f7af15bbc0a84203bde206b9">ServerConnection::M_connected</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
TCP/IP connect in progress, or connected. True if we actually attempted to connect to the server (after calling <a class="el" href="classServerConnection.html#0bb470a3215a2780f846e806897359c5" title="Attempt an immediate connect to the server.">ServerConnection::do_connect</a>). Reset when the session was lost (or destructed). 
<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00068">68</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00149">do_connect()</a>, <a class="el" href="ServerConnection_8h-source.html#l00190">is_connected()</a>, and <a class="el" href="ServerConnection_8cc-source.html#l00252">session_lost()</a>.</p>

</div>
</div><p>
<a class="anchor" name="8ee9481e0fce407147dc1b3a0a6afbea"></a><!-- doxytag: member="ServerConnection::M_state" ref="8ee9481e0fce407147dc1b3a0a6afbea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ServerConnection_8h.html#8bd3e377b5e0da0a7d154425796c9ef2">state_nt</a> <a class="el" href="classServerConnection.html#8ee9481e0fce407147dc1b3a0a6afbea">ServerConnection::M_state</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The state of the connection. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00071">71</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8h-source.html#l00134">change_state()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00312">decode_ping()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00149">do_connect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00281">error_message_received()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00377">invisible_event()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00333">send_pong_and_mode()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00252">session_lost()</a>, <a class="el" href="ServerConnection_8h-source.html#l00120">state()</a>, and <a class="el" href="ServerConnection_8cc-source.html#l00300">successful_connection()</a>.</p>

</div>
</div><p>
<a class="anchor" name="0bd8fa9e9cfbfae860406eae4b270885"></a><!-- doxytag: member="ServerConnection::M_connect_delay" ref="0bd8fa9e9cfbfae860406eae4b270885" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">timeval <a class="el" href="classServerConnection.html#0bd8fa9e9cfbfae860406eae4b270885">ServerConnection::M_connect_delay</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The next connect delay. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00073">73</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="ServerConnection_8h-source.html#l00196">connect_delay()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00281">error_message_received()</a>, and <a class="el" href="ServerConnection_8cc-source.html#l00300">successful_connection()</a>.</p>

</div>
</div><p>
<a class="anchor" name="119910e5efed5d10039adf7f13fb1167"></a><!-- doxytag: member="ServerConnection::S_connect_delay_init" ref="119910e5efed5d10039adf7f13fb1167" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">timeval <a class="el" href="classServerConnection.html#119910e5efed5d10039adf7f13fb1167">ServerConnection::S_connect_delay_init</a> = { 1, 0 }<code> [static, private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The initial connect delay. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00074">74</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00300">successful_connection()</a>.</p>

</div>
</div><p>
<a class="anchor" name="f242a50989467275c426f9e25ad74b6b"></a><!-- doxytag: member="ServerConnection::M_timed_out" ref="f242a50989467275c426f9e25ad74b6b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classServerConnection.html#f242a50989467275c426f9e25ad74b6b">ServerConnection::M_timed_out</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set if the last connection attempted timed out. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00077">77</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00149">do_connect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00201">received_server_port_answer()</a>, and <a class="el" href="ServerConnection_8h-source.html#l00199">timed_out()</a>.</p>

</div>
</div><p>
<a class="anchor" name="325de08b35f8b26eaea50b2edb0c4c36"></a><!-- doxytag: member="ServerConnection::M_timed_out_count" ref="325de08b35f8b26eaea50b2edb0c4c36" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classServerConnection.html#325de08b35f8b26eaea50b2edb0c4c36">ServerConnection::M_timed_out_count</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The number of connect attempts left that will time out, until we stop trying. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00080">80</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00300">successful_connection()</a>, and <a class="el" href="ServerConnection_8h-source.html#l00202">timed_out_count()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c8237a669a8f97c83d51e5bdfd0189cb"></a><!-- doxytag: member="ServerConnection::M_secondary_connection" ref="c8237a669a8f97c83d51e5bdfd0189cb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classServerConnection.html#c8237a669a8f97c83d51e5bdfd0189cb">ServerConnection::M_secondary_connection</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
True if this connection is a secondary connection, while the primary still exists. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00083">83</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8cc-source.html#l00073">connect()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00149">do_connect()</a>, <a class="el" href="ServerConnection_8h-source.html#l00208">make_primary()</a>, <a class="el" href="ServerConnection_8h-source.html#l00211">make_secondary()</a>, <a class="el" href="ServerConnection_8h-source.html#l00130">my_serverside_nick_name()</a>, <a class="el" href="ServerConnection_8h-source.html#l00123">secondary_connection()</a>, <a class="el" href="ServerConnection_8cc-source.html#l00252">session_lost()</a>, and <a class="el" href="ServerConnection_8h-source.html#l00126">set_my_serverside_nick_name()</a>.</p>

</div>
</div><p>
<a class="anchor" name="babd0c0817882b21608aac804d267293"></a><!-- doxytag: member="ServerConnection::M_my_serverside_nick_name" ref="babd0c0817882b21608aac804d267293" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classServerConnection.html#babd0c0817882b21608aac804d267293">ServerConnection::M_my_serverside_nick_name</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This is my serverside nick name for as long as this is a secondary connection. 
<p>

<p>Definition at line <a class="el" href="ServerConnection_8h-source.html#l00086">86</a> of file <a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a>.</p>

<p>Referenced by <a class="el" href="ServerConnection_8h-source.html#l00130">my_serverside_nick_name()</a>, and <a class="el" href="ServerConnection_8h-source.html#l00126">set_my_serverside_nick_name()</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="ServerConnection_8h-source.html">ServerConnection.h</a><li><a class="el" href="ServerConnection_8cc-source.html">ServerConnection.cc</a></ul>
</div>
<hr>

<TABLE WIDTH=100% BORDER=0 CELLSPACING=0 CELLPADDING=0>
<TR>
<TH ALIGN=left BGCOLOR="#e8feff"><ADDRESS>Copyright &copy; 2005-2007 Carlo Wood.&nbsp; All rights reserved.</ADDRESS></TH>
</TR>
</TABLE>

</DIV>
</BODY>
</HTML>

