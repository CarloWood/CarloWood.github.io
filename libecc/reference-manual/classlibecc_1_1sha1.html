<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html LANG="en_US">

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="Author" content="Carlo Wood">
<meta name="description" content="Elliptic Curve Cryptography C++ Library">
<meta name="keywords" content="libecc, fast, elliptic curves, cryptography, fixed key size, speed, object orientation, OO, C++">
<title>libecc: Elliptic Curve Cryptography C++ Library - Reference Manual</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<script src="../scripts/detect_browser.js"></script>
<script>need_style_doxygen=1</script>
<script src="../scripts/load_style_sheets.js"></script>
</head>

<body>
<div class="normal">

<center>
<a class="qindex" href="../index.html">Main Page</a> &nbsp;
<a class="qindex" href="index.html">Reference Manual</a> &nbsp;
<a class="qindex" href="annotated.html">Compound List</a> &nbsp;
<a class="qindex" href="files.html">File List</a> &nbsp;
</center>

<hr size=1 noshade>
<!-- Generated by Doxygen 1.7.1 -->
  <div class="navpath">
    <ul>
      <li><a class="el" href="namespacelibecc.html">libecc</a>      </li>
      <li><a class="el" href="classlibecc_1_1sha1.html">libecc::sha1</a>      </li>
    </ul>
  </div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a>  </div>
  <div class="headertitle">
<h1>libecc::sha1 Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="libecc::sha1" -->
<p>SHA-1.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="sha_8h_source.html">sha.h</a>&gt;</code></p>

<p><a href="classlibecc_1_1sha1-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibecc_1_1sha1.html#a3d55f3d9e981a5f48890b98c69544b3c">sha1</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor. Constructs a SHA-1 object.  <a href="#a3d55f3d9e981a5f48890b98c69544b3c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibecc_1_1sha1.html#a9ce56f57a08d90fd9fa99a455fae992b">process_msg</a> (<a class="el" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">bitset_digit_t</a> const *message, size_t number_of_bits)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process a complete message.  <a href="#a9ce56f57a08d90fd9fa99a455fae992b"></a><br/></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;unsigned int n&gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classlibecc_1_1sha1.html#a09b8de1c4ffbb69fb38e0a0dc7014649">process_msg</a> (<a class="el" href="classlibecc_1_1bitset.html">bitset</a>&lt; n &gt; const &amp;message, size_t number_of_bits=n)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process a complete message.  <a href="#a09b8de1c4ffbb69fb38e0a0dc7014649"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibecc_1_1bitset.html">bitset</a>&lt; 160 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibecc_1_1sha1.html#ab4570628861c190c54249b0941f9e938">digest</a> (void) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The resulting hash value.  <a href="#ab4570628861c190c54249b0941f9e938"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibecc_1_1sha1.html#a991069366621032ac974548506f81cd5">reset</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reset the state of the SHA-1 object.  <a href="#a991069366621032ac974548506f81cd5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibecc_1_1sha1.html#a71d46789f247fb1607b0eb331247a01e">process_block</a> (<a class="el" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">bitset_digit_t</a> const *block)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process the next data block.  <a href="#a71d46789f247fb1607b0eb331247a01e"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>SHA-1. </p>
<p>This class allows one to calculate a hash value of a bitset using the Secure Hash Algorithm 1, as described in the <a href="http://www.itl.nist.gov/fipspubs/fip180-1.htm">FIPS PUB 180-1</a>.</p>
<p>Unlike most implementations, this is a bit oriented implementation and therefore more suitable to calculate hash values of bitsets than to calculate hash values of character strings (like for example a text file).</p>
<p>The correct use is as follows.</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="classlibecc_1_1bitset.html" title="A bitset with a fixed number of bits.">libecc::bitset&lt;10&gt;</a> msg(<span class="stringliteral">&quot;3FF&quot;</span>); <span class="comment">// A bit set of 10 ones.</span>
 <a class="code" href="classlibecc_1_1sha1.html" title="SHA-1.">libecc::sha1</a> hash_obj;
 hash_obj.<a class="code" href="classlibecc_1_1sha1.html#a9ce56f57a08d90fd9fa99a455fae992b" title="Process a complete message.">process_msg</a>(msg);
 <a class="code" href="classlibecc_1_1bitset.html" title="A bitset with a fixed number of bits.">libecc::bitset&lt;160&gt;</a> hash(hash_obj.<a class="code" href="classlibecc_1_1sha1.html#ab4570628861c190c54249b0941f9e938" title="The resulting hash value.">digest</a>());
</pre></div> <hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a3d55f3d9e981a5f48890b98c69544b3c"></a><!-- doxytag: member="libecc::sha1::sha1" ref="a3d55f3d9e981a5f48890b98c69544b3c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libecc::sha1::sha1 </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor. Constructs a SHA-1 object. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ab4570628861c190c54249b0941f9e938"></a><!-- doxytag: member="libecc::sha1::digest" ref="ab4570628861c190c54249b0941f9e938" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibecc_1_1bitset.html">bitset</a>&lt; 160 &gt; libecc::sha1::digest </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The resulting hash value. </p>
<p>This method returns the hash value of the last message that was processed, as a 160 bit bitset. </p>

</div>
</div>
<a class="anchor" id="a71d46789f247fb1607b0eb331247a01e"></a><!-- doxytag: member="libecc::sha1::process_block" ref="a71d46789f247fb1607b0eb331247a01e" args="(bitset_digit_t const *block)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libecc::sha1::process_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">bitset_digit_t</a> const *&nbsp;</td>
          <td class="paramname"> <em>block</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process the next data block. </p>
<p>This method will process the next block of data. The argument <em>block</em> should be a pointer to an array of <code>bitset_digit_t</code> having a total size of 512 bits. </p>

<p>Referenced by <a class="el" href="classlibecc_1_1sha1.html#a9ce56f57a08d90fd9fa99a455fae992b">process_msg()</a>.</p>

</div>
</div>
<a class="anchor" id="a09b8de1c4ffbb69fb38e0a0dc7014649"></a><!-- doxytag: member="libecc::sha1::process_msg" ref="a09b8de1c4ffbb69fb38e0a0dc7014649" args="(bitset&lt; n &gt; const &amp;message, size_t number_of_bits=n)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned int n&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void libecc::sha1::process_msg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibecc_1_1bitset.html">bitset</a>&lt; n &gt; const &amp;&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>number_of_bits</em> = <code>n</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process a complete message. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>message</em>&nbsp;</td><td>A bitset containing the message that the hash has to be calculated for.&nbsp; Only the first <em>number_of_bits</em> least significant bits are considered to be part of the message. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>number_of_bits</em>&nbsp;</td><td>The number of bits in the message.&nbsp; This value must be less or equal to the size of the bitset. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="classlibecc_1_1sha1.html#a09b8de1c4ffbb69fb38e0a0dc7014649">process_msg()</a>.</p>

<p>Referenced by <a class="el" href="classlibecc_1_1sha1.html#a09b8de1c4ffbb69fb38e0a0dc7014649">process_msg()</a>.</p>

</div>
</div>
<a class="anchor" id="a9ce56f57a08d90fd9fa99a455fae992b"></a><!-- doxytag: member="libecc::sha1::process_msg" ref="a9ce56f57a08d90fd9fa99a455fae992b" args="(bitset_digit_t const *message, size_t number_of_bits)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libecc::sha1::process_msg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">bitset_digit_t</a> const *&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>number_of_bits</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process a complete message. </p>
<p>Calculate the hash value of a message of <em>number_of_bits</em>, passed as an array of <code>bitset_digit_t</code>.&nbsp; The last bit of the message is the least significant bit of the first digit.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>message</em>&nbsp;</td><td>A pointer to an array of <code>bitset_digit_t</code>, containing the message bits. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>number_of_bits</em>&nbsp;</td><td>The number of valid bits in the array, only the first <em>number_of_bits</em> are considered to be part of the message.</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example:</b></p>
<p>The following code would correctly print the hash value of a string of characters.</p>
<div class="fragment"><pre class="fragment"> <span class="keywordtype">void</span> print_hash(std::string <span class="keyword">const</span>&amp; message)
 {
   <span class="keyword">using</span> libecc::bitset_digit_t;
   <span class="keywordtype">size_t</span> digits = (message.size() + <span class="keyword">sizeof</span>(bitset_digit_t) - 1) / <span class="keyword">sizeof</span>(bitset_digit_t);
   <a class="code" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d" title="Internal data type, used to store the bits of class bitset.">bitset_digit_t</a>* buf = <span class="keyword">new</span> <a class="code" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d" title="Internal data type, used to store the bits of class bitset.">bitset_digit_t</a>[digits];
   <span class="keywordtype">int</span> shift = 0, digit = -1;
   <span class="keywordflow">for</span> (std::string::const_reverse_iterator iter = message.rbegin();
        iter != message.rend(); ++iter)
   {
     <span class="keywordflow">if</span> (shift == 0)
       buf[++digit] = *iter;
     <span class="keywordflow">else</span>
       buf[digit] |= *iter &lt;&lt; 8 * shift;
     shift = (shift + 1) % <span class="keyword">sizeof</span>(<a class="code" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d" title="Internal data type, used to store the bits of class bitset.">bitset_digit_t</a>);
   }
   <a class="code" href="classlibecc_1_1sha1.html" title="SHA-1.">libecc::sha1</a> hash_obj;
   hash_obj.<a class="code" href="classlibecc_1_1sha1.html#a9ce56f57a08d90fd9fa99a455fae992b" title="Process a complete message.">process_msg</a>(buf, 8 * message.size());
   <span class="keyword">delete</span> [] buf;
   std::cout &lt;&lt; hash_obj.<a class="code" href="classlibecc_1_1sha1.html#ab4570628861c190c54249b0941f9e938" title="The resulting hash value.">digest</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
 }
</pre></div> 
<p>References <a class="el" href="classlibecc_1_1sha1.html#a71d46789f247fb1607b0eb331247a01e">process_block()</a>, <a class="el" href="structlibecc_1_1bitset__base.html#a546fff5ea210a08046d3429642bd0cf4">libecc::bitset_base&lt; N &gt;::reset()</a>, <a class="el" href="classlibecc_1_1sha1.html#a991069366621032ac974548506f81cd5">reset()</a>, and <a class="el" href="structlibecc_1_1bitset__base.html#ad3363dbe3669a797faf02253655f49ec">libecc::bitset_base&lt; N &gt;::set()</a>.</p>

</div>
</div>
<a class="anchor" id="a991069366621032ac974548506f81cd5"></a><!-- doxytag: member="libecc::sha1::reset" ref="a991069366621032ac974548506f81cd5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libecc::sha1::reset </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reset the state of the SHA-1 object. </p>
<p>This method needs to be called prior to calculating the hash value of a message with <a class="el" href="classlibecc_1_1sha1.html#a71d46789f247fb1607b0eb331247a01e" title="Process the next data block.">sha1::process_block</a>.&nbsp; </p>

<p>Referenced by <a class="el" href="classlibecc_1_1sha1.html#a9ce56f57a08d90fd9fa99a455fae992b">process_msg()</a>.</p>

</div>
</div>
</div>
<address>Copyright &copy; 2002-2008 Carlo Wood.&nbsp; All rights reserved.</address>

</div>
</body>
</html>

