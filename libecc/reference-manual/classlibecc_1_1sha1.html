<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html LANG="en_US">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="Author" content="Carlo Wood">
<meta name="description" content="Elliptic Curve Cryptography C++ Library">
<meta name="keywords" content="libecc, fast, elliptic curves, cryptography, fixed key size, speed, object orientation, OO, C++">
<title>libecc: Elliptic Curve Cryptography C++ Library - Reference Manual</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<script src="../scripts/detect_browser.js"></script>
<script>need_style_doxygen=1</script>
<script src="../scripts/load_style_sheets.js"></script>
</head>
<body>
<div class="normal">
<center>
<a class="qindex" href="../index.html">Main Page</a> &nbsp;
<a class="qindex" href="index.html">Reference Manual</a> &nbsp;
<a class="qindex" href="annotated.html">Compound List</a> &nbsp;
<a class="qindex" href="files.html">File List</a> &nbsp;
</center>
<hr size=1 noshade>
<!-- Generated by Doxygen 1.8.18 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibecc.html">libecc</a></li><li class="navelem"><a class="el" href="classlibecc_1_1sha1.html">sha1</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classlibecc_1_1sha1-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">libecc::sha1 Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>SHA-1.  
 <a href="classlibecc_1_1sha1.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="sha_8h_source.html">sha.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3d55f3d9e981a5f48890b98c69544b3c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibecc_1_1sha1.html#a3d55f3d9e981a5f48890b98c69544b3c">sha1</a> (void)</td></tr>
<tr class="memdesc:a3d55f3d9e981a5f48890b98c69544b3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. Constructs a SHA-1 object.  <a href="classlibecc_1_1sha1.html#a3d55f3d9e981a5f48890b98c69544b3c">More...</a><br /></td></tr>
<tr class="separator:a3d55f3d9e981a5f48890b98c69544b3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ce56f57a08d90fd9fa99a455fae992b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibecc_1_1sha1.html#a9ce56f57a08d90fd9fa99a455fae992b">process_msg</a> (<a class="el" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">bitset_digit_t</a> const *message, size_t number_of_bits)</td></tr>
<tr class="memdesc:a9ce56f57a08d90fd9fa99a455fae992b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process a complete message.  <a href="classlibecc_1_1sha1.html#a9ce56f57a08d90fd9fa99a455fae992b">More...</a><br /></td></tr>
<tr class="separator:a9ce56f57a08d90fd9fa99a455fae992b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adab62d7757f3fdcb8e532380b1b20e52"><td class="memTemplParams" colspan="2">template&lt;unsigned int n&gt; </td></tr>
<tr class="memitem:adab62d7757f3fdcb8e532380b1b20e52"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classlibecc_1_1sha1.html#adab62d7757f3fdcb8e532380b1b20e52">process_msg</a> (<a class="el" href="classlibecc_1_1bitset.html">bitset</a>&lt; n &gt; const &amp;message, size_t number_of_bits=n)</td></tr>
<tr class="memdesc:adab62d7757f3fdcb8e532380b1b20e52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process a complete message.  <a href="classlibecc_1_1sha1.html#adab62d7757f3fdcb8e532380b1b20e52">More...</a><br /></td></tr>
<tr class="separator:adab62d7757f3fdcb8e532380b1b20e52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed9202a9c145cdefd20c00e776c02010"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibecc_1_1bitset.html">bitset</a>&lt; 160 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibecc_1_1sha1.html#aed9202a9c145cdefd20c00e776c02010">digest</a> (void) const</td></tr>
<tr class="memdesc:aed9202a9c145cdefd20c00e776c02010"><td class="mdescLeft">&#160;</td><td class="mdescRight">The resulting hash value.  <a href="classlibecc_1_1sha1.html#aed9202a9c145cdefd20c00e776c02010">More...</a><br /></td></tr>
<tr class="separator:aed9202a9c145cdefd20c00e776c02010"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a991069366621032ac974548506f81cd5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibecc_1_1sha1.html#a991069366621032ac974548506f81cd5">reset</a> ()</td></tr>
<tr class="memdesc:a991069366621032ac974548506f81cd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the state of the SHA-1 object.  <a href="classlibecc_1_1sha1.html#a991069366621032ac974548506f81cd5">More...</a><br /></td></tr>
<tr class="separator:a991069366621032ac974548506f81cd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71d46789f247fb1607b0eb331247a01e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibecc_1_1sha1.html#a71d46789f247fb1607b0eb331247a01e">process_block</a> (<a class="el" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">bitset_digit_t</a> const *block)</td></tr>
<tr class="memdesc:a71d46789f247fb1607b0eb331247a01e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the next data block.  <a href="classlibecc_1_1sha1.html#a71d46789f247fb1607b0eb331247a01e">More...</a><br /></td></tr>
<tr class="separator:a71d46789f247fb1607b0eb331247a01e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>SHA-1. </p>
<p>This class allows one to calculate a hash value of a bitset using the Secure Hash Algorithm 1, as described in the <a href="http://www.itl.nist.gov/fipspubs/fip180-1.htm">FIPS PUB 180-1</a>.</p>
<p>Unlike most implementations, this is a bit oriented implementation and therefore more suitable to calculate hash values of bitsets than to calculate hash values of character strings (like for example a text file).</p>
<p>The correct use is as follows.</p>
<div class="fragment"><div class="line"><a class="code" href="classlibecc_1_1bitset.html">libecc::bitset&lt;10&gt;</a> msg(<span class="stringliteral">&quot;3FF&quot;</span>);  <span class="comment">// A bit set of 10 ones.</span></div>
<div class="line"><a class="code" href="classlibecc_1_1sha1.html">libecc::sha1</a> hash_obj;</div>
<div class="line">hash_obj.<a class="code" href="classlibecc_1_1sha1.html#a9ce56f57a08d90fd9fa99a455fae992b">process_msg</a>(msg);</div>
<div class="line"><a class="code" href="classlibecc_1_1bitset.html">libecc::bitset&lt;160&gt;</a> hash(hash_obj.<a class="code" href="classlibecc_1_1sha1.html#aed9202a9c145cdefd20c00e776c02010">digest</a>());</div>
</div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3d55f3d9e981a5f48890b98c69544b3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d55f3d9e981a5f48890b98c69544b3c">&#9670;&nbsp;</a></span>sha1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libecc::sha1::sha1 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. Constructs a SHA-1 object. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aed9202a9c145cdefd20c00e776c02010"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed9202a9c145cdefd20c00e776c02010">&#9670;&nbsp;</a></span>digest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibecc_1_1bitset.html">bitset</a>&lt; 160 &gt; libecc::sha1::digest </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The resulting hash value. </p>
<p>This method returns the hash value of the last message that was processed, as a 160 bit bitset. </p>

</div>
</div>
<a id="a71d46789f247fb1607b0eb331247a01e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71d46789f247fb1607b0eb331247a01e">&#9670;&nbsp;</a></span>process_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libecc::sha1::process_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">bitset_digit_t</a> const *&#160;</td>
          <td class="paramname"><em>block</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process the next data block. </p>
<p>This method will process the next block of data. The argument <em>block</em> should be a pointer to an array of <code>bitset_digit_t</code> having a total size of 512 bits. </p>

<p class="reference">Referenced by <a class="el" href="classlibecc_1_1sha1.html#a9ce56f57a08d90fd9fa99a455fae992b">process_msg()</a>.</p>

</div>
</div>
<a id="adab62d7757f3fdcb8e532380b1b20e52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adab62d7757f3fdcb8e532380b1b20e52">&#9670;&nbsp;</a></span>process_msg() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned int n&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libecc::sha1::process_msg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibecc_1_1bitset.html">bitset</a>&lt; n &gt; const &amp;&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>number_of_bits</em> = <code>n</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process a complete message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>A bitset containing the message that the hash has to be calculated for.&#160; Only the first <em>number_of_bits</em> least significant bits are considered to be part of the message. </td></tr>
    <tr><td class="paramname">number_of_bits</td><td>The number of bits in the message.&#160; This value must be less or equal to the size of the bitset. </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="classlibecc_1_1sha1.html#a9ce56f57a08d90fd9fa99a455fae992b">process_msg()</a>.</p>

</div>
</div>
<a id="a9ce56f57a08d90fd9fa99a455fae992b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ce56f57a08d90fd9fa99a455fae992b">&#9670;&nbsp;</a></span>process_msg() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libecc::sha1::process_msg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">bitset_digit_t</a> const *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>number_of_bits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process a complete message. </p>
<p>Calculate the hash value of a message of <em>number_of_bits</em>, passed as an array of <code>bitset_digit_t</code>.&#160; The last bit of the message is the least significant bit of the first digit.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>A pointer to an array of <code>bitset_digit_t</code>, containing the message bits. </td></tr>
    <tr><td class="paramname">number_of_bits</td><td>The number of valid bits in the array, only the first <em>number_of_bits</em> are considered to be part of the message.</td></tr>
  </table>
  </dd>
</dl>
<p><b>Example:</b></p>
<p>The following code would correctly print the hash value of a string of characters.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> print_hash(std::string <span class="keyword">const</span>&amp; message)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">libecc::bitset_digit_t</a>;</div>
<div class="line">  <span class="keywordtype">size_t</span> digits = (message.size() + <span class="keyword">sizeof</span>(<a class="code" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">bitset_digit_t</a>) - 1) / <span class="keyword">sizeof</span>(<a class="code" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">bitset_digit_t</a>);</div>
<div class="line">  <a class="code" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">bitset_digit_t</a>* buf = <span class="keyword">new</span> <a class="code" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">bitset_digit_t</a>[digits];</div>
<div class="line">  <span class="keywordtype">int</span> shift = 0, digit = -1;</div>
<div class="line">  <span class="keywordflow">for</span> (std::string::const_reverse_iterator iter = message.rbegin();</div>
<div class="line">       iter != message.rend(); ++iter)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span> (shift == 0)</div>
<div class="line">      buf[++digit] = *iter;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      buf[digit] |= *iter &lt;&lt; 8 * shift;</div>
<div class="line">    shift = (shift + 1) % <span class="keyword">sizeof</span>(<a class="code" href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">bitset_digit_t</a>);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="classlibecc_1_1sha1.html">libecc::sha1</a> hash_obj;</div>
<div class="line">  hash_obj.<a class="code" href="classlibecc_1_1sha1.html#a9ce56f57a08d90fd9fa99a455fae992b">process_msg</a>(buf, 8 * message.size());</div>
<div class="line">  <span class="keyword">delete</span> [] buf;</div>
<div class="line">  std::cout &lt;&lt; hash_obj.<a class="code" href="classlibecc_1_1sha1.html#aed9202a9c145cdefd20c00e776c02010">digest</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
<p class="reference">References <a class="el" href="classlibecc_1_1sha1.html#a71d46789f247fb1607b0eb331247a01e">process_block()</a>, and <a class="el" href="classlibecc_1_1sha1.html#a991069366621032ac974548506f81cd5">reset()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classlibecc_1_1sha1.html#adab62d7757f3fdcb8e532380b1b20e52">process_msg()</a>.</p>

</div>
</div>
<a id="a991069366621032ac974548506f81cd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a991069366621032ac974548506f81cd5">&#9670;&nbsp;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libecc::sha1::reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset the state of the SHA-1 object. </p>
<p>This method needs to be called prior to calculating the hash value of a message with <a class="el" href="classlibecc_1_1sha1.html#a71d46789f247fb1607b0eb331247a01e" title="Process the next data block.">sha1::process_block</a>.&#160; </p>

<p class="reference">Referenced by <a class="el" href="classlibecc_1_1sha1.html#a9ce56f57a08d90fd9fa99a455fae992b">process_msg()</a>.</p>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="aclasslibecc_1_1sha1_html_a9ce56f57a08d90fd9fa99a455fae992b"><div class="ttname"><a href="classlibecc_1_1sha1.html#a9ce56f57a08d90fd9fa99a455fae992b">libecc::sha1::process_msg</a></div><div class="ttdeci">void process_msg(bitset_digit_t const *message, size_t number_of_bits)</div><div class="ttdoc">Process a complete message.</div><div class="ttdef"><b>Definition:</b> sha.cc:237</div></div>
<div class="ttc" id="aclasslibecc_1_1bitset_html"><div class="ttname"><a href="classlibecc_1_1bitset.html">libecc::bitset</a></div><div class="ttdoc">A bitset with a fixed number of bits.</div><div class="ttdef"><b>Definition:</b> bitset.h:1993</div></div>
<div class="ttc" id="anamespacelibecc_html_a7a7be7cc5bc91d345df9a5668e8a866d"><div class="ttname"><a href="namespacelibecc.html#a7a7be7cc5bc91d345df9a5668e8a866d">libecc::bitset_digit_t</a></div><div class="ttdeci">unsigned long bitset_digit_t</div><div class="ttdoc">Internal data type, used to store the bits of class bitset.</div><div class="ttdef"><b>Definition:</b> bitset.h:69</div></div>
<div class="ttc" id="aclasslibecc_1_1sha1_html_aed9202a9c145cdefd20c00e776c02010"><div class="ttname"><a href="classlibecc_1_1sha1.html#aed9202a9c145cdefd20c00e776c02010">libecc::sha1::digest</a></div><div class="ttdeci">bitset&lt; 160 &gt; digest(void) const</div><div class="ttdoc">The resulting hash value.</div><div class="ttdef"><b>Definition:</b> sha.cc:34</div></div>
<div class="ttc" id="aclasslibecc_1_1sha1_html"><div class="ttname"><a href="classlibecc_1_1sha1.html">libecc::sha1</a></div><div class="ttdoc">SHA-1.</div><div class="ttdef"><b>Definition:</b> sha.h:56</div></div>
<address>Copyright &copy; 2002-2008 Carlo Wood.&nbsp; All rights reserved.</address>
</div>
</body>
</html>
