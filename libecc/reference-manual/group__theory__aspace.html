<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html LANG="en_US">

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="Author" content="Carlo Wood">
<meta name="description" content="Elliptic Curve Cryptography C++ Library">
<meta name="keywords" content="libecc, fast, elliptic curves, cryptography, fixed key size, speed, object orientation, OO, C++">
<title>libecc: Elliptic Curve Cryptography C++ Library - Reference Manual</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<script src="../scripts/detect_browser.js"></script>
<script>need_style_doxygen=1</script>
<script src="../scripts/load_style_sheets.js"></script>
</head>

<body>
<div class="normal">

<center>
<a class="qindex" href="../index.html">Main Page</a> &nbsp;
<a class="qindex" href="index.html">Reference Manual</a> &nbsp;
<a class="qindex" href="annotated.html">Compound List</a> &nbsp;
<a class="qindex" href="files.html">File List</a> &nbsp;
</center>

<hr size=1 noshade>
<!-- Generated by Doxygen 1.7.1 -->
<div class="header">
  <div class="headertitle">
<h1>Cracking parameter <span class="formula">a</span> of the elliptic curve</h1>  </div>
</div>
<div class="contents">
<table class="memberdecls">
</table>
<h3>Introduction</h3>
<p>As was deduced from the <a class="el" href="group__theory__point.html#bruteforcedata">brute force point counting data</a> for all possible elliptic curves of the form <span class="formula">x<sup>3</sup> + ax<sup>2</sup> + b = y<sup>2</sup> + xy</span> over binary fields up till and including extension degree <span class="formula">m = 10</span>, the values of parameter <span class="formula">a</span> can be devided into two sets, both of a size <span class="formula">q/2</span>, where <span class="formula">q = 2<sup>m</sup></span> is the <a class="el" href="group__theory__polynomial.html#fieldcardinality">cardinality</a> of the field and therefore equal to the number of possible values of <span class="formula">a</span>.&nbsp; Let us call these two sets <span class="formula">A<sub>0</sub></span> and <span class="formula">A<sub>1</sub></span> so that <span class="formula">A<sub>0</sub></span> <img class="formulaInl" alt="$\cup$" src="form_1022_0.png"/> <span class="formula">A<sub>1</sub> = <img class="formulaInl" alt="$\mathbb{F}_q$" src="form_1022_1.png"/></span>, <span class="formula">A<sub>0</sub></span> <img class="formulaInl" alt="$\cap$" src="form_1022_2.png"/> <span class="formula">A<sub>1</sub> = <img class="formulaInl" alt="$\emptyset$" src="form_1022_3.png"/></span> and <span class="formula"><span class="vbars">A<sub>0</sub></span> = <span class="vbars">A<sub>1</sub></span> = q/2</span>.</p>
<p>Then furthermore it was found that <span class="formula">A<sub>0</sub></span> and <span class="formula">A<sub>1</sub></span> are only a function of the field (<span class="formula">GF(2<sup>m</sup>)/&lt;t<sup>m</sup>+t<sup>k</sup>+1&gt;</span>) and not of <span class="formula">b</span>.&nbsp; Let <span class="formula">a<sub>0</sub> <img class="formulaInl" alt="$\in$" src="form_1022_4.png"/> A<sub>0</sub></span> and <span class="formula">a<sub>1</sub> <img class="formulaInl" alt="$\in$" src="form_1022_4.png"/> A<sub>1</sub></span>, and then define the curves <span class="formula">E<sub>0</sub></span> and <span class="formula">E<sub>1</sub></span> to be <span class="formula">E<sub>0</sub>: x<sup>3</sup> + a<sub>0</sub>x<sup>2</sup> + b = y<sup>2</sup> + xy</span> and <span class="formula">E<sub>1</sub>: x<sup>3</sup> + a<sub>1</sub>x<sup>2</sup> + b = y<sup>2</sup> + xy</span>, then it was found that for some fixed <span class="formula">b</span> also <span class="formula">#<b></b>E<sub>0</sub></span> and <span class="formula">#<b></b>E<sub>1</sub></span> are fixed (not depending on the specific choice of <span class="formula">a<sub>0</sub></span> and <span class="formula">a<sub>1</sub></span> respectively) and that <span class="formula">#<b></b>E<sub>0</sub> + #<b></b>E<sub>1</sub> = 2(q + 1)</span>.&nbsp; (Note: the notation <span class="formula">#<b></b>E</span> is often used in literature to denote the cardinality of the Abelian group formed by the points of the elliptic curve <span class="formula">E</span>).</p>
<p>We would like to find how <span class="formula">A<sub>0</sub></span> and <span class="formula">A<sub>1</sub></span> depend on the field parameters, because that will reduce the amount of computations needed during the continuation of this research dramatically, as then we only have to try two values of <span class="formula">a</span> instead of <span class="formula">q</span> values.</p>
<h3>A hyperplane</h3>
<p><a class="anchor" id="basis"></a> The finite field <span class="formula"><img class="formulaInl" alt="$\mathbb{F}_{2^m}$" src="form_1022_5.png"/></span>, called a <em>binary field</em>, can be viewed as a vector space of dimension <span class="formula">m</span> over <span class="formulaF"> <img class="formulaInl" alt="$\mathbb{F}$" src="form_1022_6.png"/><sub>2</sub></span>.&nbsp; That is, there exists a set of <span class="formula">m</span> elements <span class="formula">{ <img class="formulaInl" alt="$\alpha$" src="form_1022_7.png"/><sub>0</sub>, <img class="formulaInl" alt="$\alpha$" src="form_1022_7.png"/><sub>1</sub>, ..., <img class="formulaInl" alt="$\alpha$" src="form_1022_7.png"/><sub>m-1</sub>}</span> in <span class="formula"><img class="formulaInl" alt="$\mathbb{F}_{2^m}$" src="form_1022_5.png"/></span> such that each <span class="formula">a <img class="formulaInl" alt="$\in$" src="form_1022_4.png"/> <img class="formulaInl" alt="$\mathbb{F}_{2^m}$" src="form_1022_5.png"/></span> can be written uniquely in the form</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ a = \sum_{i=0}^{m-1} c_i\alpha_i \]" src="form_1022_8.png"/>
</p>
<p> where <span class="formula">c<sub>i</sub> <img class="formulaInl" alt="$\in$" src="form_1022_4.png"/> {0,1}</span>.</p>
<p>The set <span class="formula">{ <img class="formulaInl" alt="$\alpha$" src="form_1022_7.png"/><sub>0</sub>, <img class="formulaInl" alt="$\alpha$" src="form_1022_7.png"/><sub>1</sub>, ..., <img class="formulaInl" alt="$\alpha$" src="form_1022_7.png"/><sub>m-1</sub>}</span> is called a <em>basis</em> of <span class="formula"><img class="formulaInl" alt="$\mathbb{F}_{2^m}$" src="form_1022_5.png"/></span> over <span class="formulaF"> <img class="formulaInl" alt="$\mathbb{F}$" src="form_1022_6.png"/><sub>2</sub></span>.&nbsp; We can then represent <span class="formula">a</span> as a binary vector <span class="formula">(c<sub>0</sub>, c<sub>1</sub>, ..., c<sub>m-1</sub>)</span>.&nbsp; Libecc uses the <a class="el" href="group__theory__polynomial.html#fieldcardinality">polynomial basis</a>, so in our case we just have <span class="formula"><img class="formulaInl" alt="$\alpha$" src="form_1022_7.png"/><sub>i</sub> = t<sup>i</sup></span> where <span class="formula">t</span> is the fixed complex (or whatever) root of our reduction trinomial <span class="formula">t<sup>m</sup> + t<sup>k</sup> + 1</span>.&nbsp; (Note that it is possible to chose another basis, called a <em>normal basis</em>, of the form <span class="formula">{ <img class="formulaInl" alt="$\beta$" src="form_1022_9.png"/>, <img class="formulaInl" alt="$\beta$" src="form_1022_9.png"/><sup>2</sup>, <img class="formulaInl" alt="$\beta$" src="form_1022_9.png"/><sup>2<sup>2</sup></sup>, ..., <img class="formulaInl" alt="$\beta$" src="form_1022_9.png"/><sup>2<sup>m-1</sup></sup>}</span> where <span class="formula"><img class="formulaInl" alt="$\beta$" src="form_1022_9.png"/> <img class="formulaInl" alt="$\in$" src="form_1022_4.png"/> <img class="formulaInl" alt="$\mathbb{F}_{2^m}$" src="form_1022_5.png"/></span>.&nbsp; It is well known that such a basis always exists).</p>
<p>The observation that <span class="formula">A<sub>0</sub></span> is exactly half of the total space, and considering that there are only two possible values per 'dimension', indicates that <span class="formula">A<sub>0</sub></span> is a subspace of <span class="formula"><img class="formulaInl" alt="$\mathbb{F}_{2^m}$" src="form_1022_5.png"/></span> of one dimension less than <span class="formula"><img class="formulaInl" alt="$\mathbb{F}_{2^m}$" src="form_1022_5.png"/></span>.&nbsp;</p>
<hr/>
<p>It seems highly unlikely that this subspace would be 'curved'.&nbsp; I cannot prove this at this point, but it seems to me that there must be some kind of symmetry between the different dimensions: when we exchange any two coordinates then there shouldn't be a dramatic impact on the other coordinates.&nbsp; One property of a given coordinate <span class="formula">c<sub>i</sub></span> that I expect to stay fixed under the permutation of the other coordinates is the property of whether or not toggling <span class="formula">c<sub>i</sub></span> causes us to switch between <span class="formula">A<sub>0</sub></span> and <span class="formula">A<sub>1</sub></span>.&nbsp; This doesn't mean that a permutation of the other coordinates doesn't cause us to switch between <span class="formula">A<sub>0</sub></span> and <span class="formula">A<sub>1</sub></span> too, but it shouldn't cause us to change from switching to non-switching.&nbsp;</p>
<p><a class="anchor" id="hypothesis1"></a> <b>HYPOTHESIS 1</b></p>
<p><span class="formula">A<sub>0</sub></span> is a <a href="http://mathworld.wolfram.com/Hyperplane.html">hyperplane</a>.</p>
<p>As one of the goals of this project is to reach people who did not study mathematics, lets first explain what a hyperplane means.&nbsp; Consider some n-dimensional vector space for which there exists an orthogonal basis.&nbsp; An orthogonal basis is a basis of elements (vectors) of that vector space that are all orthogonal to eachother.&nbsp; Orthogonal means, in terms of vectors, that they make an angle of 90 degrees with eachother.&nbsp; When two vectors are orthogonal, then their inproduct will be zero.&nbsp; I hestitate to explain inproduct, because when you don't know that then I doubt you would be reading this in the first place.&nbsp; But why not, the inproduct of two vectors can be calculated by multiplying their coordinates pair-wise and then summing up all those products.&nbsp; Thus, if one vector has coordinates <span class="formula">(1,1,0,0,1,0,1)</span> (in some seven dimensional space) and another one has coordinates <span class="formula">(0,0,1,1,0,1,0)</span> then they make an angle of 90 degrees because <span class="formula">1*0 + 1*0 + 0*1 + 0*1 + 1*0 + 0*1 + 1*0 = 0</span>.&nbsp; A hyperplane is a subspace of one dimension less than the space in which it is contained (mathematicians would say, of <a href="http://mathworld.wolfram.com/Codimension.html">codimension</a> 1) that is 'flat'.&nbsp; That means that there exists a fixed vector <b>n</b> that that is a normal of the hyperplane at any point (it makes an angle of 90 degrees with the hyperplane at any point; or in other words with any vector that is the result of subtracting two arbitrary, though distinct, vectors that are element of the hyperplane).&nbsp; Ok, by now you should get the picture that the thing is 'flat'!</p>
<p>Let us next show that a hyperplane indeed fulfills the intuitive feeling that whether or not toggling any bit of <span class="formula">a</span> causes us to either switch between <span class="formula">A<sub>0</sub></span> and <span class="formula">A<sub>1</sub></span> or not, independent of the choice of the other bits.&nbsp; Lets use the notation from above and write <span class="formula">a</span> as a binary vector <span class="formula">(c<sub>0</sub>, c<sub>1</sub>, ..., c<sub>m-1</sub>)</span> where <span class="formula">c<sub>i</sub> <img class="formulaInl" alt="$\in$" src="form_1022_4.png"/> {0,1}</span> represents the bits of <span class="formula">a</span>.&nbsp; Furthermore, let n be represented by the binary vector <span class="formula">(n<sub>0</sub>, n<sub>1</sub>, ..., n<sub>m-1</sub>)</span>.&nbsp; Without loss of generality, we can chose <span class="formula">a = 0 = (0, 0, ..., 0)</span> to be element of <span class="formula">A<sub>0</sub></span> (it has to be an element of either <span class="formula">A<sub>0</sub></span> or <span class="formula">A<sub>1</sub></span>, so why not <span class="formula">A<sub>0</sub></span>).&nbsp; Assume that <span class="formula">A<sub>0</sub></span> is a hyperplane and that <span class="formula">n</span> is the normal of that hyperplane.&nbsp; Then the angle that the vector <span class="formula">n</span> makes at any point <span class="formula">a<sub>0</sub> <img class="formulaInl" alt="$\in$" src="form_1022_4.png"/> A<sub>0</sub></span> will be 90 degrees, as per our definition that <span class="formula">n</span> is the normal of the hyperplane <span class="formula">A<sub>0</sub></span>.&nbsp; And that means that the inproduct of <span class="formula">n</span> with <span class="formula">a<sub>0</sub> - a<sub>i</sub></span> will be 0 for any arbitrary <span class="formula">a<sub>i</sub> <img class="formulaInl" alt="$\in$" src="form_1022_4.png"/> A<sub>0</sub></span>.&nbsp; Therefore also for <span class="formula">a<sub>i</sub> = 0</span>.&nbsp; Let <span class="formula">(a<sub>0,0</sub>, a<sub>0,1</sub>, ..., a<sub>0,m-1</sub>)</span> be the vector representation of <span class="formula">a<sub>0</sub></span> then the inproduct can be written as <span class="formula"><img class="formulaInl" alt="$\sum_{i=0}^{i=m-1}n_ia_{0,i} = 0$" src="form_1022_10.png"/> [mod 2]</span>.&nbsp; And since the <span class="formula">n<sub>i</sub></span> are fixed, this clearly shows that when <span class="formula">n<sub>i</sub> = 0</span> then changing <span class="formula">a<sub>0,i</sub></span> has no influence on the result of the inproduct and therefore will not cause a change of <span class="formula">a<sub>0</sub></span> being an element of <span class="formula">A<sub>0</sub></span>.&nbsp; While when <span class="formula">n<sub>i</sub> = 1</span> then changing the corresponding bit <span class="formula">a<sub>0,i</sub></span> will toggle the outcome of the inproduct and hence cause that vector not to be an element of <span class="formula">A<sub>0</sub></span> anymore.&nbsp; And this is independent of the value of any of the other bits.</p>
<p>Understanding the above (and still assuming that <span class="formula">A<sub>0</sub></span> is indeed a hyperplane of course) it is very easy to find the normal <span class="formula">(n<sub>0</sub>, n<sub>1</sub>, ..., n<sub>m-1</sub>)</span>.&nbsp; One only has to try each value of <span class="formula">a</span> with exactly one bit set (which are only <span class="formula">m</span> different values).&nbsp; Let this single bit be <span class="formula">c<sub>j</sub></span> so that </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ c_i = \begin{cases} 0 &amp; i \neq j \\ 1 &amp; i = j \end{cases} \]" src="form_1022_11.png"/>
</p>
<p> If, using this <span class="formula">a</span>, the resulting curve has the cardinality <span class="formula">#<b></b>E<sub>0</sub></span>, the cardinality corresponding to <span class="formula">A<sub>0</sub></span>, then the inproduct has to be 0 (because we defined that <span class="formula">a = 0</span> is element of <span class="formula">A<sub>0</sub></span>).&nbsp; The inproduct will therefore have to equal 1 precisely for each <span class="formula">j</span> that corresponds to <span class="formula">A<sub>1</sub></span> and thus has a cardinality <span class="formula">#<b></b>E<sub>1</sub> <img class="formulaInl" alt="$\neq$" src="form_1022_12.png"/> #<b></b>E<sub>0</sub></span>!&nbsp; And the inproduct will only be 1 when <span class="formula">n<sub>j</sub> = 1</span>.</p>
<p>An algorithm for finding the normal <span class="formula">n</span> of hyperplane <span class="formula">A<sub>0</sub></span> could therefore be the following:</p>
<ol>
<li>
Find the cardinality of the curve with <span class="formula">a = 0</span> and some fixed <span class="formula">b</span> (<span class="formula">#<b></b>E<sub>0</sub></span>). </li>
<li>
Find the cardinality of all curves with a parameter <span class="formula">a</span> that has exactly one bit set, <span class="formula">c<sub>j</sub></span>, using the same fixed parameter <span class="formula">b</span>. </li>
<li>
If the cardinality of the curve with just <span class="formula">c<sub>j</sub></span> set is equal to <span class="formula">#<b></b>E<sub>0</sub></span> then <span class="formula">n<sub>j</sub> = 0</span>, otherwise <span class="formula">n<sub>j</sub> = 1</span>. </li>
</ol>
<p>There is a little problem with this algorithm.&nbsp; This project has two goals: 1) to make elliptic curve cryptography more accessible to people without a mathematic university degree, and 2) to be the first Open Source project providing the means to generate your own cryptographically safe curves, which basically comes down to providing the means to determine the cardinality of an arbitrary elliptic curve.&nbsp; Therefore, an algorithm with the phrase "Find the cardinality of all curves ... blah blah" is easier said than done.&nbsp; Surely, we can do the above brute force, and it would be feasible for curves over fields up till extension degrees of <span class="formula">m = 31</span>, and that might be enough to guess a relationship between <span class="formula">A<sub>0</sub></span> and <span class="formula">m</span>, but... we still have a hypothesis to prove too, namely that <span class="formula">A<sub>0</sub></span> is indeed a hyperplane and using the above algorithm won't prove that at all, it will just give results.&nbsp; Therefore, it would be necessary to check in addition whether or not the resulting normal <span class="formula">n</span> is indeed a normal to <em>all</em> <span class="formula">a<sub>0</sub> <img class="formulaInl" alt="$\in$" src="form_1022_4.png"/> A<sub>0</sub></span>!&nbsp; And determining the cardinality of the curves for any <span class="formula">a</span> is really too much and/or will not give enough data points to feel secure about the hypothesis...</p>
<p>Time to become really smart therefore (and believe it or not but I am actually proud of the following, heheh).&nbsp;</p>
<p>Suppose for a moment that <span class="formula">#<b></b>E<sub>0</sub></span> is a multiple of 4 (as is the case as I will show below).&nbsp; That is, <span class="formula">#<b></b>E<sub>0</sub> = 4k</span> for some <span class="formula">k <img class="formulaInl" alt="$\in$" src="form_1022_4.png"/> <img class="formulaInl" alt="$\mathbb{N}$" src="form_1022_13.png"/></span>.&nbsp; Then <span class="formula">#<b></b>E<sub>1</sub> = 2(q + 1) - #<b></b>E<sub>0</sub> = 2(2<sup>m</sup> + 1) - 4k <img class="formulaInl" alt="$\equiv$" src="form_1022_14.png"/> 2 mod 4</span> for <span class="formula">m <img class="formulaInl" alt="$\geq$" src="form_1022_15.png"/> 1</span>.&nbsp; In other words, then <span class="formula">#<b></b>E<sub>1</sub></span> is <em>not</em> divisable by 4.</p>
<p>Further, <a href="group__theory__cyclic.html">recall</a> that the <a class="el" href="group__theory__cyclic.html#orderofpoint">order</a> of any point on the curve devides the cardinality of the curve.&nbsp; That means that if we can find any point that has order 4, then the curve must have a cardinality that is divisable by 4.&nbsp; Moreover, we are free to chose any arbitrary value of <span class="formula">b</span> for this investigation (as <span class="formula">A<sub>0</sub></span> does not depend on it).&nbsp; So, we can chose <span class="formula">b = 1</span>.</p>
<p>Then it is easy to prove that there is always a solution to the curve with <span class="formula">a = 0</span> with x coordinate 1.&nbsp; Recall that <span class="formula">E<sub>0</sub>: x<sup>3</sup> + a<sub>0</sub>x<sup>2</sup> + b = y<sup>2</sup> + xy</span> and set <span class="formula">a<sub>0</sub> = 0</span>, <span class="formula">b = 1</span> and <span class="formula">x = 1</span> to get <span class="formula">0 = y<sup>2</sup> + y</span>, which has two solutions <span class="formula">y = 0</span> and <span class="formula">y = 1</span>.&nbsp; And thus, the point <span class="formula">P = (1, 0)</span> is an element of this curve.&nbsp; Now lets calculate the order of <span class="formula">P</span>.&nbsp; Doubling the point, using the <a href="http://www.certicom.com/index.php?action=ecc_tutorial,ecc_tut_4_2">known rules</a>,</p>
<hr/>
 <b>Doubling a point P</b></p>
<p>If <span class="formula">P<sub>x</sub> = 0</span>, then <span class="formula">2P = 0</span>.</p>
<p>Provided that <span class="formula">P<sub>x</sub></span> is not 0,</p>
<p><span class="formula">2P = R</span> where</p>
<p><span class="formula">s = P<sub>x</sub> + P<sub>y</sub> / P<sub>x</sub></span></p>
<p><span class="formula">R<sub>x</sub> = s<sup>2</sup> + s + a</span> and <span class="formula">R<sub>y</sub> = P<sub>x</sub><sup>2</sup> + (s + 1)R<sub>x</sub></span> <hr/>
<p>gives us the following for our <span class="formula">P = (1, 0)</span>.&nbsp; <span class="formula">s = 1 + 0 / 1 = 1</span>, <span class="formula">R<sub>x</sub> = 1 + 1 + 0 = 0</span> and <span class="formula">R<sub>y</sub> = 1 + (1 + 1)0 = 1</span>.&nbsp; In other words <span class="formula">2P = (0, 1)</span>.&nbsp; And because now the x coordinate is 0, doubling this point again results in 0 (the "point at infinity").&nbsp; So, the order of this point is 4 independent of the extension degree of the field (we only used that the field characteristic is 2)!</p>
<p>This in turn means that the cardinality of every elliptic curve of the form <span class="formula">E<sub>0</sub><sup>1</sup>: x<sup>3</sup> + a<sub>0</sub>x<sup>2</sup> + 1 = y<sup>2</sup> + xy</span> over <span class="formula"><img class="formulaInl" alt="$\mathbb{F}_{2^m}$" src="form_1022_5.png"/></span>, with <span class="formula">a<sub>0</sub> <img class="formulaInl" alt="$\in$" src="form_1022_4.png"/> A<sub>0</sub></span> is a multiple of 4, for any <span class="formula">m</span>.&nbsp; Conversely, also for any <span class="formula">m</span>, every elliptic curve of the form <span class="formula">E<sub>1</sub><sup>1</sup>: x<sup>3</sup> + a<sub>1</sub>x<sup>2</sup> + 1 = y<sup>2</sup> + xy</span> over <span class="formula"><img class="formulaInl" alt="$\mathbb{F}_{2^m}$" src="form_1022_5.png"/></span>, with <span class="formula">a<sub>1</sub> <img class="formulaInl" alt="$\in$" src="form_1022_4.png"/> A<sub>1</sub></span> is not divisable by 4, as was shown above.</p>
<p>As we saw before, there will always be a solution to the general elliptic equation <span class="formula">E: x<sup>3</sup> + ax<sup>2</sup> + b = y<sup>2</sup> + xy</span>.&nbsp; for which <span class="formula">x <img class="formulaInl" alt="$\neq$" src="form_1022_12.png"/> 0</span>, let us call those solutions <span class="formula">(x, y)</span> for now and remember that <span class="formula">x <img class="formulaInl" alt="$\neq$" src="form_1022_12.png"/> 0</span>.&nbsp; But there does not necessarily exist a solution with <span class="formula">x = <img class="formulaInl" alt="$\sqrt[4]{b}$" src="form_1022_16.png"/></span> (huh, where did that come from? Well, that will become clear in a minute).</p>
<p>Please note that the only solution to <span class="formula">x<sup>4</sup> = b</span> is the unique <span class="formula">x = <img class="formulaInl" alt="$\sqrt[4]{b}$" src="form_1022_16.png"/></span>, because as we saw before there is only a single solution for a square root in a field with characteristic 2, and likewise there is only a single solution for <span class="formula"><img class="formulaInl" alt="$\sqrt[4]{b} = \sqrt{\sqrt{b}}$" src="form_1022_17.png"/></span>.</p>
<p>Consider the equation</p>
<p><span class="formulaDsp"> <span class="formula">x<sup>3</sup> + ax<sup>2</sup> + x<sup>4</sup> = y<sup>2</sup> + xy</span></span></p>
<p>This equation can only ever be true when <span class="formula">x = <img class="formulaInl" alt="$\sqrt[4]{b}$" src="form_1022_16.png"/></span>, because <span class="formula">x</span> and <span class="formula">y</span> are given to satisfy the curve equation and thus the above equation is equivalent with <span class="formula">x<sup>4</sup> = b</span> (just add the curve equation to it).</p>
<p>We can rewrite this equation as <span class="formula">x<sup>4</sup> + y<sup>2</sup> + x<sup>3</sup> + xy + ax<sup>2</sup> = 0</span> and then, remembering that <span class="formula">x <img class="formulaInl" alt="$\neq$" src="form_1022_12.png"/> 0</span>, divide both sides by <span class="formula">x<sup>2</sup></span> to get</p>
<p><span class="formulaDsp"> <span class="formula">x<sup>2</sup> + y<sup>2</sup>/x<sup>2</sup> + x + y/x + a = 0</span></span></p>
<p>Because of the field characteristic 2, we have <span class="formula">x<sup>2</sup> + y<sup>2</sup>/x<sup>2</sup> = (x + y/x)<sup>2</sup></span>.&nbsp; Then, with <span class="formula">s = x + y/x</span>, the equation becomes equivalent with</p>
<p><span class="formulaDsp"> <span class="formula">s<sup>2</sup> + s + a = 0</span></span></p>
<p>Now looking again to the rules for point doubling, this means that adding <span class="formula">(x, y)</span> to itself will result in a point with x-coordinate 0, if and only if <span class="formula">x = <img class="formulaInl" alt="$\sqrt[4]{b}$" src="form_1022_16.png"/></span>!&nbsp; In other words, when <span class="formula">( <img class="formulaInl" alt="$\sqrt[4]{b}$" src="form_1022_16.png"/>, y )</span> is a solution of the elliptive curve then this point will have order 4 and the cardinality of the curve will be a multiple of 4 and the chosen parameter <span class="formula">a</span> must be element of <span class="formula">A<sub>0</sub></span>.&nbsp; However, if there is no solution with <span class="formula">x = <img class="formulaInl" alt="$\sqrt[4]{b}$" src="form_1022_16.png"/></span> then there exists no point with order 4, and thus 4 does not devide the cardinality of the curve and the chosen parameter <span class="formula">a</span> must be element of <span class="formula">A<sub>1</sub></span>.&nbsp;</p>
<p>This result did not use my hypothesis that <span class="formula">A<sub>0</sub></span> is a hyperplane, but it also doesn't give us a formula for <span class="formula">A<sub>0</sub></span>.&nbsp; We'd still have to try every possible value of <span class="formula">a</span>, but at least we don't have to calculate a cardinality anymore!</p>
<p>Assuming that <span class="formula">A<sub>0</sub></span> is a hyperplane however, we can now formulate the much faster algorithm (using <span class="formula">x = b = 1</span>, and using the fact that <span class="formula">a</span> with just bit <span class="formula">c<sub>j</sub></span> set is equal to <span class="formula">t<sup>j</sup></span>):</p>
<ol>
<li>
Try to solve the equation <span class="formula">y<sup>2</sup> + y + t<sup>j</sup> = 0</span>, where <span class="formula">j</span> runs over all bits of <span class="formula">a</span>, <span class="formula">0 <img class="formulaInl" alt="$\leq$" src="form_1022_18.png"/> j &lt; m</span>. </li>
<li>
If there is a solution then <span class="formula">n<sub>j</sub> = 0</span>, otherwise <span class="formula">n<sub>j</sub> = 1</span>. </li>
</ol>
<p>This algorithm is fast enough for every <span class="formula">m</span> and will suffice to find two values of <span class="formula">a</span> that do not result in two isomorphic curves.&nbsp; Since we can always use <span class="formula">a = 0</span> for <span class="formula">E<sub>0</sub></span> it will even suffice to find just a single <span class="formula">j</span> for which the above equation is not soluble.</p>
<p><a class="anchor" id="whata0"></a> If <span class="formula">A<sub>0</sub></span> is not (always) a hyperplane then in order to find all of <span class="formula">A<sub>0</sub></span> we'd have find all <span class="formula">a<sub>0</sub></span> for which there exists a solution for <span class="formula">y<sup>2</sup> + y + a<sub>0</sub> = 0</span>.&nbsp; Also in this case it will suffice to find just a single <span class="formula">a<sub>1</sub></span> for which the equation is not soluble, but - it might come in handy later when we actually <em>known</em> what <span class="formula">A<sub>0</sub></span> is, and therefore I'd like to prove that it is, in fact, a hyperplane.</p>
<hr/>
<p>In order to do that we need two new mathematical tools.&nbsp; The <a class="el" href="group__theory__frobenius.html">Frobenius automorphism</a> and the <a class="el" href="group__theory__trace.html">trace</a>.&nbsp; I dedicated a special chapter to each, so please follow those links and get yourself familiar with these expressions.</p>
<hr/>
<h3>PROOF OF HYPOTHESIS 1</h3>
<p>Ok, now we have the mathematical tools to actually prove that <span class="formula">A<sub>0</sub></span> is a hyperplane.</p>
<p><a class="el" href="group__theory__aspace.html#whata0">Recall</a> that <span class="formula">A<sub>0</sub></span> exists of all elements <span class="formula">a<sub>0</sub></span> for which there exists a <span class="formula">y</span> such that <span class="formula">y<sup>2</sup> + y + a<sub>0</sub> = 0</span>.&nbsp; Then, using <a class="el" href="group__theory__trace.html#theorem5">theorem 5</a>, we can immediately conclude that those are the values for which the <a class="el" href="group__theory__trace.html">trace</a> is 0.&nbsp; And thus</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{matrix} Tr(a_0) = 0 \\ Tr(a_1) = 1 \end{matrix} \]" src="form_1022_19.png"/>
</p>
<p>Let <span class="formula">t<sup>j</sup></span> be an element of <span class="formula">A<sub>1</sub></span>, so that <span class="formula">Tr(t<sup>j</sup>) = 1</span>, then it is now easy to see that toggling that bit will switch between <span class="formula">A<sub>0</sub></span> and <span class="formula">A<sub>1</sub></span> independent of the value of the other bits:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ Tr(a + t^j) = Tr(a) + Tr(t^j) = Tr(a) + 1 \]" src="form_1022_20.png"/>
</p>
<p>And that proves that <span class="formula">A<sub>0</sub></span> (and <span class="formula">A<sub>1</sub></span>) is a hyperplane.</p>
<hr/>
<p>Our quest continues in the next chapter <a class="el" href="group__theory__bspace.html">Cracking parameter b of the elliptic curve</a> . </p>
</div>
<address>Copyright &copy; 2002-2008 Carlo Wood.&nbsp; All rights reserved.</address>

</div>
</body>
</html>

