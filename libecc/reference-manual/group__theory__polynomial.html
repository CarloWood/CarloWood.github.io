<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html LANG="en_US">

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="Author" content="Carlo Wood">
<meta name="description" content="Elliptic Curve Cryptography C++ Library">
<meta name="keywords" content="libecc, fast, elliptic curves, cryptography, fixed key size, speed, object orientation, OO, C++">
<title>libecc: Elliptic Curve Cryptography C++ Library - Reference Manual</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<script src="../scripts/detect_browser.js"></script>
<script>need_style_doxygen=1</script>
<script src="../scripts/load_style_sheets.js"></script>
</head>

<body>
<div class="normal">

<center>
<a class="qindex" href="../index.html">Main Page</a> &nbsp;
<a class="qindex" href="index.html">Reference Manual</a> &nbsp;
<a class="qindex" href="annotated.html">Compound List</a> &nbsp;
<a class="qindex" href="files.html">File List</a> &nbsp;
</center>

<hr size=1 noshade>
<!-- Generated by Doxygen 1.7.1 -->
<div class="header">
  <div class="headertitle">
<h1>Theory: Galois fields with cardinality 2<SUP>m</SUP>, the polynomial basis</h1>  </div>
</div>
<div class="contents">
<table class="memberdecls">
</table>
<h2>Introduction</h2>
<h3>Fields</h3>
<p>A <a href="http://planetmath.org/encyclopedia/Field.html">Field</a> is a set of elements for which addition, subtraction, multiplication and division are defined, along with a few intuitive axioms like that there must exist a <span class="formula">0</span> (for which <span class="formula">x + 0 = x</span> for every <span class="formula">x</span> element of the field) and a <span class="formula">1</span> (for which <span class="formula">1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>x = x</span> for every <span class="formula">x</span> element of the field) and the commutative and associative rules.&nbsp; Note that <img class="formulaInl" alt="$\mathbb{N}$" src="form_1022_13.png"/>, the natural numbers, that our ancestors used for counting similar things, is not a field: There is no solution for <span class="formula">3 + x = 0</span> in the natural numbers and something is only a field when every element has an 'additive inverse'.&nbsp; Even if we add all the negative numbers, to get <img class="formulaInl" alt="$\mathbb{Z}$" src="form_1022_58.png"/>, we still don't have a field because a field also must have a multiplicative inverse for every non-zero element, and clearly there is no solution for <span class="formula">3x = 1</span> that is element of <img class="formulaInl" alt="$\mathbb{Z}$" src="form_1022_58.png"/>, either.&nbsp; That way we naturally arrive at <img class="formulaInl" alt="$\mathbb{Q}$" src="form_1022_266.png"/> as the "smallest" field (remember, <img class="formulaInl" alt="$\mathbb{Q}$" src="form_1022_266.png"/> are the rational numbers and exist of all elements <span class="formula">r/s</span> with <img class="formulaInl" alt="$r \in \mathbb{Z}$" src="form_1022_268.png"/> and <img class="formulaInl" alt="$s \in \mathbb{Z}\setminus\{0\}$" src="form_1022_269.png"/>).&nbsp;</p>
<h3>Finite fields</h3>
<p>However all of the above sets are infinite.&nbsp; We can also define addition and multiplication for <em>finite</em> sets.&nbsp; First of all we will need a <span class="formula">0</span> and a <span class="formula">1</span>, and then some more elements.&nbsp; Consider the set <span class="formula">{0, 1, a, b, c, d, e, ..., x}</span> where adding the <span class="formula">0</span> to any element gives that same element, multiplying <span class="formula">0</span> with any element gives <span class="formula">0</span> and multiplying <span class="formula">1</span> with any element gives that same element, as is required by the axioms.&nbsp; Another field axiom is that <span class="formula">0</span> and <span class="formula">1</span> must differ.&nbsp; This implies that adding <span class="formula">1</span> repeatedly must either be a new element, or be equal to <span class="formula">0</span> (because we have only a finite field we will always have to end up with a previously defined element 'cause we run out of elements!&nbsp; But setting <span class="formula">1 + 1 + 1 + 1 + 1</span> equal to some (smaller) non-zero element like say <span class="formula">1 + 1 + 1</span> has the problem that although <span class="formula">1 + 1 + 1 + 1</span> and <span class="formula">1 + 1</span> were different elements, adding <span class="formula">1</span> to either gives apparently the same element and then we don't have a field anymore).&nbsp; Let us assume at first that adding <span class="formula">1</span> repeatedly gives <em>all</em> elements of the set, before returning to <span class="formula">0</span>, then it can be proven that the total number of elements has to be prime (<span class="formula">p</span>) for this set to be possibly a field (otherwise one cannot define multiplicative inverses for all elements).</p>
<p>For example, lets consider a set of 5 elements: <span class="formula">{0, 1, a, b, c}</span> where <span class="formula">1 + 1 = a</span>, <span class="formula">a + 1 = b</span>, <span class="formula">b + 1 = c</span> and <span class="formula">c + 1 = 0</span>.&nbsp; Then this defines all possible ways one can add and subtract elements (Ie, <span class="formula">b + c =</span> <span class="formula">(a + 1) + (b + 1) =</span> <span class="formula">((1 + 1) + 1) + (((1 + 1) + 1) + 1)</span> which is equal to, using the associative rules that allows us to reorder the brackets, <span class="formula">= ((((1 + 1) + 1) + 1) + 1) + (1 + 1) =</span> <span class="formula">(c + 1) + a = 0 + a = a</span>).&nbsp; In order to associate multiplication with addition, we have to realize that although these elements are not integers, we still have <span class="formula">x + x + x = <b>3</b> <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>x</span> (where <span class="formula"><b>3</b></span> is an integer).&nbsp; Replace <span class="formula">x</span> with the unity of our to-be-field (<span class="formula">1</span>) and we get: <span class="formula">b = 1 + 1 + 1 = <b>3</b></span> <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><span class="formula">1</span>.&nbsp; If we look at '<span class="formula">1</span>' as some universal unity that <em>always</em> gives the same thing when multiplying anything with it - than apparently our <span class="formula">1</span> added three times with itself is the integer 3.&nbsp; If we go that way however, then we have to realize that working in our field the integer <b>5</b> is equivalent with <span class="formula">0</span> and <span class="formula">x + x + x + x + x =</span> <span class="formula"><b>5</b> <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>x = 0</span> for any <span class="formula">x</span> element of our field (where <b>5</b> is the normal integer: there is no element <span class="formula">5</span> in our original set.&nbsp; Also note that the smallest positive integer <span class="formula">p</span>, for which <span class="formula">p <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>x = 0</span> for every <span class="formula">x</span> element of the field, is called the <em>field characteristic</em>.&nbsp; In the case that the whole field can be generated by adding <span class="formula">1</span> to itself, this characteristic is equal to the number of elements; later we will see that a field always will have precisely <span class="formula">p<sup>m</sup></span> elements where <span class="formula">p</span> is prime and <span class="formula">m</span> some positive integer).&nbsp; Nevertheless, this is a convenient way of looking at it and we might as well rename our elements into <span class="formula">{0, 1, 2, 3, 4}</span>.&nbsp; Clearly, now we have defined not only addition but also multiplication: for example <span class="formula">3</span> <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><span class="formula">4 = 3 + 3 + 3 + 3</span> (<span class="formula">= 2</span>).&nbsp; If the total number of elements in this finite (commutative) ring is prime, then we automatically have a field: then every element (except <span class="formula">0</span>) will have a (unique) multiplicative inverse.&nbsp; In our case, <span class="formula">1</span> <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><span class="formula">1 = 1</span>, <span class="formula">2</span> <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><span class="formula">3 = 3</span> <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><span class="formula">2 = 1</span> and <span class="formula">4</span> <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><span class="formula">4 = 1</span>.&nbsp; It is left to the reader to check that this is not the case when <span class="formula">p</span> is not prime.&nbsp; Finite fields (Galois fields) are thus a lot easier than infinite fields: the only restriction is that the characteristic of the field is prime after which you get division for free.</p>
<p><a class="anchor" id="fieldextension"></a> </p>
<h3>Field extension</h3>
<p>Our next step is to investigate if we can extend a finite field by stubbornly adding another element that is <em>not</em> an integer, something completely different (and no, that won't be a cow - it will turn out to be some complex number). Lets assume we want to add the element '<span class="formula">t</span>', so that our example set becomes: <span class="formula">{0, 1, 2, 3, 4, t}</span> This clearly isn't a field anymore.&nbsp; In order to keep it a field, we will have to add more elements so that the field remains closed under addition and multiplication (closed means that adding/multiplying any two elements gives again an element of the field).&nbsp; It will not be hard to see that this leads to us having to add every arbitrary polynomial of <span class="formula">t</span> with coefficients from <span class="formula">{0, 1, 2, 3, 4} =</span> <img class="formulaInl" alt="$\mathbb{Z}_5$" src="form_1022_270.png"/>, by only looking at addition and multiplication.&nbsp; For example we could repeatedly multiply with elements and add elements until we got the element <span class="formula">3t<sup>8</sup> + 2t<sup>5</sup> + t<sup>4</sup> + 4t + 1</span>.&nbsp; Please note that the coefficients are elements of <img class="formulaInl" alt="$\mathbb{Z}_5$" src="form_1022_270.png"/>: there will not be a <span class="formula">6t</span>, after all <span class="formula">6t = 5t + t = 0t + t = t</span>.&nbsp; Also note that the characteristic of the field is still 5: adding any polynomial 5 times to itself will give <span class="formula">0</span>: <span class="formula">5 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/>(3t + 4) = (5</span> <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><span class="formula">3)t + 5</span> <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><span class="formula">4 = 0t + 0 = 0</span>.&nbsp;</p>
<p>There is a nasty problem now: the field isn't finite anymore!&nbsp; There are an infinite number of polynomials to begin with, and we didn't even take care of division yet: in order to make this a field again we'd have to add all rational expressions <span class="formula">r(t)/s(t)</span> where <span class="formula">r(t)</span> and <span class="formula">s(t)</span> are polynomials over <img class="formulaInl" alt="$\mathbb{Z}_5$" src="form_1022_270.png"/> and for the (fixed) <span class="formula">t</span>, the <span class="formula">s(t)</span> are restricted to those unequal <span class="formula">0</span>.</p>
<p>But, this is about finite fields - and we already know that finite fields are a lot easier (under certain restrictions).&nbsp; First of all we will have to get rid of the larger part of all polynomials by restricting them to some maximum degree; we simply pick some polynomial of degree <span class="formula">m</span> say, and state that that is equal to <span class="formula">0</span> (remember, this is very well possible: <span class="formula">t</span> is a complex number and there will exist a polynomial for which <span class="formula">r(t) = 0</span>).&nbsp; As a direct result we will have gotten rid of all polynomials of degree <span class="formula">m</span> and higher: for example, suppose that <span class="formula">r(t) = t<sup>3</sup> + t<sup>2</sup> + 1 = 0</span> (and thus, after adding <span class="formula">4t<sup>2</sup> + 4t</span> to both sides: <span class="formula">t<sup>3</sup> = 4t<sup>2</sup> + 4t</span>) then we can write <span class="formula">t<sup>4</sup></span> as a polynomial of a lower degree, namely: <span class="formula">t<sup>4</sup> =</span> <span class="formula">t t<sup>3</sup> =</span> <span class="formula">t (4t<sup>2</sup> + 4) =</span> <span class="formula">4t<sup>3</sup> + 4t =</span> <span class="formula">4(4t<sup>2</sup> + 4) + 4t =</span> <span class="formula">t<sup>2</sup> + 4t + 1</span>, which has a degree less than 3.&nbsp; This so called reduction polynomial <span class="formula">r(t) = 0</span> is very much like the characteristic <span class="formula">p = 5</span> that we had before: it works as a modulo.&nbsp; That is, two elements are equivalent when their difference is a multiple of the modulo (ie, <span class="formula">2</span> <img class="formulaInl" alt="$\equiv$" src="form_1022_14.png"/> <span class="formula">17</span> (pronounce: 2 is <a href="http://planetmath.org/encyclopedia/Congruences.html">congruent</a> to 17) because <span class="formula">17 - 2 = 5</span> <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><span class="formula">3</span>).&nbsp; Likewise, when any two polynomials of <span class="formula">t</span> have a difference that can be written as <span class="formula">r(t)v(t)</span> then they are equivalent.&nbsp; It will therefore not come as a surprise that the restriction upon our reduction polynomial, in order for the resulting set of polynomials to be a field, is that it has to be 'prime'.&nbsp; That means, that <span class="formula">r(t)</span> cannot be written as the product of two polynomials of lesser degree.&nbsp; In other words, <span class="formula">r(t)</span> must be an <em>irreducible</em> polynomial (the proof of this is given <a class="el" href="group__theory__polynomial.html#irrproof">below</a>).&nbsp;</p>
<p><a class="anchor" id="fieldcardinality"></a> </p>
<h3>Galois fields of cardinality 2<SUP>m</SUP></h3>
<p>For computational reasons we will restrict ourselfs in libecc to irreducible polynomials with only three terms: <span class="formula">t<sup>m</sup> + t<sup>k</sup> + 1 = 0</span>.&nbsp; Moreover, for computational reasons, we will use fields of characteristic 2 and the number of elements of our finite field will be of the form <span class="formula">2<sup>m</sup></span>.&nbsp; Note that this means that <span class="formula">t<sup>n</sup> + t<sup>n</sup> = 2t<sup>n</sup> = 0t<sup>n</sup> = 0</span>.</p>
<p><b>Example</b></p>
<p>Let the reduction polynomial be of degree <span class="formula">m = 4</span>.<br/>
 Then the total number of field elements is <span class="formula">2<sup>4</sup> = 16</span>:</p>
<p><span class="formula">0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = 0</span><br/>
 <span class="formula">0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = 1</span><br/>
 <span class="formula">0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t</span><br/>
 <span class="formula">0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t + 1</span><br/>
 <span class="formula">0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t<sup>2</sup></span><br/>
 <span class="formula">0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t<sup>2</sup> + 1</span><br/>
 <span class="formula">0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t<sup>2</sup> + t</span><br/>
 <span class="formula">0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t<sup>2</sup> + t + 1</span><br/>
 <span class="formula">1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t<sup>3</sup></span><br/>
 <span class="formula">1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t<sup>3</sup> + 1</span><br/>
 <span class="formula">1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t<sup>3</sup> + t</span><br/>
 <span class="formula">1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t<sup>3</sup> + t + 1</span><br/>
 <span class="formula">1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t<sup>3</sup> + t<sup>2</sup></span><br/>
 <span class="formula">1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t<sup>3</sup> + t<sup>2</sup> + 1</span><br/>
 <span class="formula">1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 0 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t<sup>3</sup> + t<sup>2</sup> + t</span><br/>
 <span class="formula">1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>3</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>2</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>1</sup> + 1 <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>0</sup> = t<sup>3</sup> + t<sup>2</sup> + t + 1</span></p>
<p>Polynomials of a higher degree do not exist because we can always write those as a polynomial of degree 3 or less.&nbsp; For example, let the (irreducible) reduction polynomial of degree 4 be <span class="formula">t<sup>4</sup> + t + 1 = 0</span>.&nbsp; Now suppose <span class="formula">t<sup>5</sup></span> would be a field element, then we can simply prove that this polynomial is equivalent with one of the sixteen listed above by using the reduction polynomial: <span class="formula">t<sup>5</sup> = t <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>t<sup>4</sup> = t (t<sup>4</sup> + 0) = t (t<sup>4</sup> + t<sup>4</sup> + t + 1) = t (t + 1) = t<sup>2</sup> + t</span>.</p>
<p>The polynomials can thus be represented by a bitset of <span class="formula">m</span> bits.&nbsp; Each bit in turn then represents a coefficient of the polynomial.&nbsp; This is very convenient for a computer.</p>
<p>Furthermore, because the algebra of the coefficients of the polynomials has to be done modulo two (as per our definition), addition (and substraction) of two polynomials is equivalent to the exclusive-or of those bitsets.&nbsp; For example, <span class="formula">(t<sup>2</sup> + t) + (t<sup>2</sup> + 1) = t + 1</span>, which is equivalent with 0110 XOR 0101 = 0011.</p>
<p>Also multiplication can be implemented rather easily.&nbsp; Because <span class="formula">t<sup>p</sup> (t<sup>2</sup> + 1) = t<sup>2+p</sup> + t<sup>p</sup></span> it is obvious that multiplication with a single power of <span class="formula">t</span> is just a left shift.&nbsp; We <em>do</em> have to take into account the reduction polynomial though - when the degree of the resulting polynomial becomes too large.</p>
<p>Multiplication of two arbitrary polynomials exists of a few shifts and exclusive-or operations, followed by reduction with the reduction polynomial if needed.</p>
<p>For example,</p>
<p><span class="formula">t<sup>4</sup> + t + 1 <img class="formulaInl" alt="$\equiv$" src="form_1022_14.png"/> 10011</span> (reduction polynomial)<br/>
 <span class="formula">t<sup>3</sup> + t<sup>2</sup> + 1 <img class="formulaInl" alt="$\equiv$" src="form_1022_14.png"/> 1101</span><br/>
 <span class="formula">t<sup>2</sup> + t + 1 <img class="formulaInl" alt="$\equiv$" src="form_1022_14.png"/> 0111</span> </p>
<pre>
    1101
    0111 *
    ------
    1101
   11010
  110100 +  (addition is exclusive-or!)
    ------
  100011
  10011  -  (t * reduction_polynomial)
    ------
     101
</pre><p> And thus <span class="formula">(t<sup>3</sup> + t<sup>2</sup> + 1) (t<sup>2</sup> + t + 1) = t<sup>2</sup> + 1</span>.</p>
<p>The reduction polynomial could be any irreducible polynomial, but by using a trinomial (a polynomial with only three terms), reduction can be implemented much faster.&nbsp; The power of the second term (<span class="formula">k</span>) should be chosen as small as possible because also that will speed up the process of reduction.&nbsp; Therefore, for a given <span class="formula">m</span>, one should use the smallest <span class="formula">k</span> for which <span class="formula">t<sup>m</sup> + t<sup>k</sup> + 1</span> is irreducible.</p>
<p><a class="anchor" id="irrproof"></a> The reason that the reduction polynomial has to be irreducible is to ensure that the elements of the field indeed form a <a href="http://planetmath.org/encyclopedia/Field.html">Field</a>. First of all, multiplication of field elements should be commutative, that is <span class="formula">ab = ba</span> for any <span class="formula">a</span> and <span class="formula">b</span> element of the field. Now suppose that we would use a reduction polynomial that could be written as <span class="formula">P <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>Q</span> where the (irreducible) polynomials <span class="formula">P</span> and <span class="formula">Q</span> are of respectively degrees <span class="formula">p</span> and <span class="formula">q</span> with <span class="formula">0 &lt; p <img class="formulaInl" alt="$\leq$" src="form_1022_18.png"/> q &lt; p + q = m</span>.&nbsp; Then <span class="formula">P</span> and <span class="formula">Q</span> are elements of the "field" (their degree is less than <span class="formula">m</span>). Furthermore, there should exist a <span class="formula">R</span> such that <span class="formula">R <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>P = 1</span> (<span class="formula">R</span> is the multiplicative inverse of <span class="formula">P</span>).&nbsp; Then note that <span class="formula">Q = (R <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>P) <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>Q <img class="formulaInl" alt="$\neq$" src="form_1022_12.png"/><b></b>R <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/>(P <img class="formulaInl" alt="$\cdot$" src="form_1022_49.png"/><b></b>Q) = 0</span>, a contradiction!&nbsp; If the reduction polynomial is not irreducible then we don't <em>have</em> a field thus!</p>
<h3>Finding an irreducible trinomial</h3>
<p>An irreducible trinomial is a polynomial of three terms, <span class="formula">F(t) = t<sup>m</sup> + t<sup>k</sup> + 1</span> which cannot be written as the product of two polynomials of lower degree.&nbsp; Finding an irreducible polynomial is based on the theorem that <span class="formula">t<sup>(2<sup>m</sup>)</sup> - t</span> is the product of all irreducible polynomials whose degree divides m.</p>
<p>When <span class="formula">m</span> is prime then all we need to do in order to find the smallest <span class="formula">k</span> is trying all values of <span class="formula">k</span>, starting at <span class="formula">1</span>, until we find that <span class="formula">t<sup>(2<sup>m</sup>)</sup> - t = 0 &nbsp;mod F(t)</span>, or in other words that <span class="formula">t<sup>(2<sup>m</sup>-1)</sup> = 1 &nbsp;mod F(t)</span>.&nbsp; If it equals <span class="formula">1</span> then the trinomial <span class="formula">F(t)</span> is irreducible.&nbsp; [ When <span class="formula">m</span> is not prime then we also need to check that for each divisor <span class="formula">d</span> of <span class="formula">m</span> (<span class="formula">1 <img class="formulaInl" alt="$\leq$" src="form_1022_18.png"/> d &lt; m</span>) that <span class="formula">gcd(F(t), t<sup>(2<sup>d</sup>)</sup> - t) = 1</span> ].</p>
<p>More in general, let <span class="formula">a</span> be a polynomial element of the field, and let <span class="formula">n</span> be the smallest positive integer for which <span class="formula">a<sup>n</sup> = 1 &nbsp;mod F(t)</span>, then <span class="formula">n</span> is called the <em>order</em> of <span class="formula">a</span>.&nbsp; All the polynomials <span class="formula">a<sup>j</sup></span> that can be formed by running <span class="formula">j</span> over the values <span class="formula">0</span> till <span class="formula">n - 1</span>: <span class="formula">{1, a, a<sup>2</sup>, a<sup>3</sup>, ..., a<sup>n-1</sup>}</span> form a group of <span class="formula">n</span> polynomials that can be <em>generated</em> by <span class="formula">a</span>.</p>
<p>A polynomial of order <span class="formula">2<sup>m</sup> - 1</span> is called a <em>generator</em> as it generates <em>all</em> elements of the field except <span class="formula">0</span>.&nbsp; If <span class="formula">t</span> is generator of a given polynomial field over <img class="formulaInl" alt="$\mathbb{Z}_2$" src="form_1022_271.png"/><span class="formula">[t]/F(t)</span>, then the reduction polynomial <span class="formula">F(t)</span> is called <em>primitive</em>, which is more restrictive than irreducible.&nbsp; The chance that an arbitrary irreducible polynomial of prime degree is also primitive is very likely (and for large m, even for non-primes), by far most irreducible trinomials of prime degree are also primitive.</p>
<p>This is a nice moment to note the equivalence with the Random Number Generator (see <a class="el" href="classlibecc_1_1rng.html">libecc::rng</a>).&nbsp; What we have there is a shift register with feedback points using exclusive-or; this is exactly equivalent with multiplying with t and using a reduction polynomial!&nbsp; Consider a RNG with 3 bits and a feedback point <em>to</em> bit 0 and 1:</p>
<table class="doxtable">
<tr>
<td>RNG state </td><td>&nbsp; </td><td>Polynomial </td><td>&nbsp; </td><td>Reduction of <span class="formula">t<sup>n</sup></span> with <span class="formula">t<sup>3</sup> + t + 1 = 0</span> </td><td></td></tr>
<tr>
<td><code>001</code> </td><td><img class="formulaInl" alt="$\equiv$" src="form_1022_14.png"/> </td><td><span class="formula">1</span> </td><td><span class="formula">=</span> </td><td><span class="formula">t<sup>0</sup></span> </td></tr>
<tr>
<td><code>010</code> </td><td><img class="formulaInl" alt="$\equiv$" src="form_1022_14.png"/> </td><td><span class="formula">t</span> </td><td><span class="formula">=</span> </td><td><span class="formula">t<sup>1</sup></span> </td></tr>
<tr>
<td><code>100</code> </td><td><img class="formulaInl" alt="$\equiv$" src="form_1022_14.png"/> </td><td><span class="formula">t<sup>2</sup></span> </td><td><span class="formula">=</span> </td><td><span class="formula">t<sup>2</sup></span> </td></tr>
<tr>
<td><code>011</code> </td><td><img class="formulaInl" alt="$\equiv$" src="form_1022_14.png"/> </td><td><span class="formula">t + 1</span> </td><td><span class="formula">=</span> </td><td><span class="formula">t<sup>3</sup> + (t<sup>3</sup> + t + 1) = t + 1</span> </td></tr>
<tr>
<td><code>110</code> </td><td><img class="formulaInl" alt="$\equiv$" src="form_1022_14.png"/> </td><td><span class="formula">t<sup>2</sup> + t</span> </td><td><span class="formula">=</span> </td><td><span class="formula">t<sup>4</sup> + (t<sup>3</sup> + t + 1)t = t<sup>4</sup> + (t<sup>4</sup> + t<sup>2</sup> + t) = t<sup>2</sup> + t</span> </td></tr>
<tr>
<td><code>111</code> </td><td><img class="formulaInl" alt="$\equiv$" src="form_1022_14.png"/> </td><td><span class="formula">t<sup>2</sup> + t + 1</span> </td><td><span class="formula">=</span> </td><td><span class="formula">t<sup>5</sup> + (t<sup>3</sup> + t + 1)(t<sup>2</sup> + 1) = t<sup>5</sup> + (t<sup>5</sup> + t<sup>3</sup> + t<sup>2</sup>) + (t<sup>3</sup> + t + 1) = t<sup>2</sup> + t + 1</span> </td></tr>
<tr>
<td><code>101</code> </td><td><img class="formulaInl" alt="$\equiv$" src="form_1022_14.png"/> </td><td><span class="formula">t<sup>2</sup> + 1</span> </td><td><span class="formula">=</span> </td><td><span class="formula">t<sup>6</sup> + (t<sup>3</sup> + t + 1)(t<sup>3</sup> + t + 1) = t<sup>6</sup> + (t<sup>6</sup> + t<sup>4</sup> + t<sup>3</sup>) + (t<sup>4</sup> + t<sup>2</sup> + t) + (t<sup>3</sup> + t + 1) = t<sup>2</sup> + 1</span> </td></tr>
<tr>
<td><code>001</code> </td><td><img class="formulaInl" alt="$\equiv$" src="form_1022_14.png"/> </td><td><span class="formula">1</span> </td><td><span class="formula">=</span> </td><td><span class="formula">t<sup>7</sup> + (t<sup>3</sup> + t + 1)(t<sup>4</sup> + t<sup>2</sup> + t + 1) = 1</span>  </td></tr>
</table>
<p>The state of the random number generator can be seen as a polynomial over <img class="formulaInl" alt="$\mathbb{Z}_2$" src="form_1022_271.png"/> with a reduction polynomial that is determined by the feedback points.&nbsp; Each step then corresponds with multiplying the polynomial with <span class="formula">t</span>.&nbsp; The period of the RNG will be equal to the order of <span class="formula">t</span>, having a maximum value of <span class="formula">2<sup>m</sup> - 1</span> when the reduction polynomial is primitive.</p>
<p>In order to check if a given irreducible polynomial is primitive, one needs to know the factorization of <span class="formula">2<sup>m</sup> - 1</span>.&nbsp; After all, even while <span class="formula">t<sup>(2<sup>m</sup>-1)</sup> = 1 &nbsp;mod F(t)</span>, then <span class="formula">2<sup>m</sup> - 1</span> is not necessarily the smallest positive integer <span class="formula">n</span> for which <span class="formula">t<sup>n</sup> = 1 &nbsp;mod F(t)</span>.&nbsp; For example, when <span class="formula">2<sup>m</sup> - 1 = p<sub>1</sub> p<sub>2</sub> p<sub>3</sub></span> and the order of <span class="formula">t</span> is <span class="formula">p<sub>1</sub> p<sub>3</sub></span> so that <span class="formula">t<sup>p<sub>1</sub>p<sub>3</sub></sup> = 1 &nbsp;mod F(t)</span>, then also <span class="formula">t<sup>(2<sup>m</sup>-1)</sup> = t<sup>p<sub>1</sub>p<sub>2</sub>p<sub>3</sub></sup> = (t<sup>p<sub>1</sub>p<sub>3</sub></sup>)<sup>p<sub>2</sub></sup> = 1<sup>p<sub>2</sub></sup> = 1 &nbsp;mod F(t)</span>. Therefore, one must make sure that every possible fraction of <span class="formula">2<sup>m</sup> - 1</span> is not the real order.</p>
<p>Using the factorization tables of the <a href="http://www.cerias.purdue.edu/homes/ssw/cun/">Cunningham Project</a>, we have calculated a list of <a href="../external/TRINOMIALS">primitive trinomials</a>.&nbsp; The program that was used for this can be found in <code>testsuite/polynomial</code>.</p>
<h3>Further reading</h3>
<p>See also <a href="http://www.certicom.com/index.php?action=ecc_tutorial,math8">http://www.certicom.com/index.php?action=ecc_tutorial,math8</a> and chapter 4.5 of <a href="http://www.cacr.math.uwaterloo.ca/hac/">The Handbook Of Applied Cryptography</a>.</p>
<p>More information on primitive trinomials and Random Number Generators can be found on <a href="http://web.comlab.ox.ac.uk/oucl/work/richard.brent/trinom.html">Richard Brent's page</a>.&nbsp; There you can also find links to sites about <a href="http://web.comlab.ox.ac.uk/oucl/work/richard.brent/factors.html">factorization</a>.</p>
<p>If you want to go deeper into the theory of finite fields, then there is no online substitute for a good book. An excellent book that covers this material from a more mathematical (but also historical) perspective is <a href="http://www.amazon.com/exec/obidos/ASIN/1584883936/">Galois Theory (Third Edition), by Ian Stewart</a>. </p>
</div>
<address>Copyright &copy; 2002-2008 Carlo Wood.&nbsp; All rights reserved.</address>

</div>
</body>
</html>

