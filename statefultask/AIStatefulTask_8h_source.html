<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="Author" content="Carlo Wood">
<meta name="description" content="ai-statefultask">
<title>ai-statefultask version 2cfbfa5 documentation</title>
<link rel="shortcut icon" href="images/favicon.ico">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="main.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top">
<div id="titlearea">
<table>
 <tbody>
  <tr>
  <td style="width: 128px"><img src="images/aistatefultask_arc.png"></td>
  <td>
    <p id="html_header1"><span id="name">AIStatefulTask</span> &dash; Asynchronous, Stateful Task Scheduler library.</p>
    <p id="html_header2">Threads-like task objects evolving through user-defined states.</p>
  </td>
  </tr>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a3b7416cfa9e5a3b2eab8a1fbcb99a6d.html">statefultask</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AIStatefulTask.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AIStatefulTask_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#ifndef AISTATEFULTASK_H</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#define AISTATEFULTASK_H</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;threadsafe/aithreadsafe.h&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;threadsafe/AIMutex.h&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;threadpool/AIQueueHandle.h&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;utils/AIRefCount.h&quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;utils/macros.h&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;debug.h&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &lt;chrono&gt;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">class </span><a class="code" href="classAIEngine.html">AIEngine</a>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">class </span><a class="code" href="classAIStatefulTaskMutex.html">AIStatefulTaskMutex</a>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="AIStatefulTask_8h.html#ab6c86bbf81780084fce5eb93d2028af8">   58</a></span>&#160;<span class="keyword">using</span> <a class="code" href="AIStatefulTask_8h.html#ab6c86bbf81780084fce5eb93d2028af8">AIWaitConditionFunc</a> = std::function&lt;bool()&gt;;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html">   85</a></span>&#160;<span class="keyword">class </span><a class="code" href="classAIStatefulTask.html">AIStatefulTask</a> : <span class="keyword">public</span> AIRefCount</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#a5bdb546808c3ff5820246f45b8a54973">   88</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classAIStatefulTask.html#a5bdb546808c3ff5820246f45b8a54973">state_type</a> = uint32_t;        </div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">   89</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">condition_type</a> = uint32_t;    </div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keyword">enum</span> event_type {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    initial_run,              </div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    schedule_run,             </div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    normal_run,               </div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    insert_abort              </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  };</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022">  102</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022">base_state_type</a> {</div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022af78440cbabd50c6cdacd8b4b35afdefe">  103</a></span>&#160;    <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022af78440cbabd50c6cdacd8b4b35afdefe">bs_reset</a>,                 </div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022ae322cda5bdc1ea7d2daf120cc69f091a">  104</a></span>&#160;    <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022ae322cda5bdc1ea7d2daf120cc69f091a">bs_initialize</a>,            </div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022a9b6c32619c183bf636f8a38c30fa1ecc">  105</a></span>&#160;    <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022a9b6c32619c183bf636f8a38c30fa1ecc">bs_multiplex</a>,             </div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022ad10a46cd78607d3dacfcd1d3ce68f3db">  106</a></span>&#160;    <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022ad10a46cd78607d3dacfcd1d3ce68f3db">bs_abort</a>,                 </div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022aebc06158eae8ab491a771da0173360f2">  107</a></span>&#160;    <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022aebc06158eae8ab491a771da0173360f2">bs_finish</a>,                </div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022aec4ed721e379b53e6a25378842f23e48">  108</a></span>&#160;    <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022aec4ed721e379b53e6a25378842f23e48">bs_callback</a>,              </div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022a3bce552d1e92ce75c5c4e71c86a95ef2">  109</a></span>&#160;    <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022a3bce552d1e92ce75c5c4e71c86a95ef2">bs_killed</a>                 </div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  };</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#adb2ea8142438089410700b94ad354364">  114</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="classAIStatefulTask.html#a5bdb546808c3ff5820246f45b8a54973">state_type</a> constexpr <a class="code" href="classAIStatefulTask.html#adb2ea8142438089410700b94ad354364">state_end</a> = <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022a3bce552d1e92ce75c5c4e71c86a95ef2">bs_killed</a> + 1;</div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657c">  116</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657c">on_abort_st</a> {</div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657cae7b1902fa7f7ce6687e188a338721c9e">  117</a></span>&#160;    <a class="code" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657cae7b1902fa7f7ce6687e188a338721c9e">abort_parent</a>,             </div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657ca0c7895dfa591806cc29b0f39a1332213">  118</a></span>&#160;    <a class="code" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657ca0c7895dfa591806cc29b0f39a1332213">signal_parent</a>,            </div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657ca2a91b60c5720a8bf32cb05c96d115bbf">  119</a></span>&#160;    <a class="code" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657ca2a91b60c5720a8bf32cb05c96d115bbf">do_nothing</a>                </div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  };</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html">  140</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  {</div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1">  143</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1">type_t</a> {</div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1ac87839c65308c498a8b4e611c811f70d">  144</a></span>&#160;      <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1ac87839c65308c498a8b4e611c811f70d">idle_h</a>,           </div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1ab2f53bbc738d09e1fdc9cd2d1821caeb">  145</a></span>&#160;      <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1ab2f53bbc738d09e1fdc9cd2d1821caeb">immediate_h</a>,      </div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1a04950d91679c67187cfebbf5325ef0e4">  146</a></span>&#160;      <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1a04950d91679c67187cfebbf5325ef0e4">engine_h</a>,         </div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1afab9afd9e8947ac35ad9b4bbd5bf2813">  147</a></span>&#160;      <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1afab9afd9e8947ac35ad9b4bbd5bf2813">thread_pool_h</a>     </div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    };</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2">  150</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2">special_t</a> {</div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ae8710aab384c04d9e7cc871e9977a2ee">  151</a></span>&#160;      <a class="code" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ae8710aab384c04d9e7cc871e9977a2ee">idle</a> = <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1ac87839c65308c498a8b4e611c811f70d">idle_h</a>,            </div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ac0333f77fe5c74c627b723a8e70f2932">  152</a></span>&#160;      <a class="code" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ac0333f77fe5c74c627b723a8e70f2932">immediate</a> = <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1ab2f53bbc738d09e1fdc9cd2d1821caeb">immediate_h</a>   </div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    };</div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="unionAIStatefulTask_1_1Handler_1_1Handle.html">  155</a></span>&#160;    <span class="keyword">union </span><a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html">Handle</a> {</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a4147441fa0b001ee693500e9e7697f5f">  156</a></span>&#160;      <a class="code" href="classAIEngine.html">AIEngine</a>* <a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a4147441fa0b001ee693500e9e7697f5f">engine</a>;                 </div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a19e331a28c9bf538fbc545e6a646bb79">  157</a></span>&#160;      AIQueueHandle <a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a19e331a28c9bf538fbc545e6a646bb79">queue_handle</a>;       </div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a6ce5640a5a8258f7185ad4541f61c1ef">  160</a></span>&#160;      <a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a6ce5640a5a8258f7185ad4541f61c1ef">Handle</a>() { }</div><div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a25ab0183c26bf8b46fdfae8080263508">  162</a></span>&#160;      <a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a25ab0183c26bf8b46fdfae8080263508">Handle</a>(<a class="code" href="classAIEngine.html">AIEngine</a>* engine_) : engine(engine_) { }</div><div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#aee84423e83d0b9648f37908d2cd7d5fc">  164</a></span>&#160;      <a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#aee84423e83d0b9648f37908d2cd7d5fc">Handle</a>(AIQueueHandle queue_handle_) : queue_handle(queue_handle_) { }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    };</div><div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#a0941f2c6ab21a2d61027f3c01db83dad">  166</a></span>&#160;    <a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html">Handle</a> <a class="code" href="structAIStatefulTask_1_1Handler.html#a0941f2c6ab21a2d61027f3c01db83dad">m_handle</a>;    </div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#aea9e7f3a92c493364764e377c0062205">  167</a></span>&#160;    <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1">type_t</a> <a class="code" href="structAIStatefulTask_1_1Handler.html#aea9e7f3a92c493364764e377c0062205">m_type</a>;      </div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#aa1fe3cf9aacc0be068a7f86e2fbdb62d">  170</a></span>&#160;    <a class="code" href="structAIStatefulTask_1_1Handler.html#aa1fe3cf9aacc0be068a7f86e2fbdb62d">Handler</a>(<a class="code" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2">special_t</a> special) : m_type((<a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1">type_t</a>)special) { }</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#aca54ebf01e1ecef9caa3a071b52fcc39">  172</a></span>&#160;    <a class="code" href="structAIStatefulTask_1_1Handler.html#aca54ebf01e1ecef9caa3a071b52fcc39">Handler</a>(<a class="code" href="classAIEngine.html">AIEngine</a>* <a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a4147441fa0b001ee693500e9e7697f5f">engine</a>) : m_handle(engine), m_type(<a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1a04950d91679c67187cfebbf5325ef0e4">engine_h</a>) { ASSERT(engine); }</div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#a8cbc793e81e1a30a5c736d6d81784b18">  174</a></span>&#160;    <a class="code" href="structAIStatefulTask_1_1Handler.html#a8cbc793e81e1a30a5c736d6d81784b18">Handler</a>(AIQueueHandle <a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a19e331a28c9bf538fbc545e6a646bb79">queue_handle</a>) : m_handle(queue_handle), m_type(<a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1afab9afd9e8947ac35ad9b4bbd5bf2813">thread_pool_h</a>) { }</div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#af37420fb70091a985361b1701b00e4f4">  176</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structAIStatefulTask_1_1Handler.html#af37420fb70091a985361b1701b00e4f4">is_engine</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_type == <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1a04950d91679c67187cfebbf5325ef0e4">engine_h</a>; }</div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#a933c3c024a9b3fe38c97e5efbe70b17c">  178</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structAIStatefulTask_1_1Handler.html#a933c3c024a9b3fe38c97e5efbe70b17c">is_immediate</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_type == <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1ab2f53bbc738d09e1fdc9cd2d1821caeb">immediate_h</a>; }</div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#ad153dd9a853d482cd606e71162b0d322">  180</a></span>&#160;    AIQueueHandle <a class="code" href="structAIStatefulTask_1_1Handler.html#ad153dd9a853d482cd606e71162b0d322">get_queue_handle</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_type == <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1afab9afd9e8947ac35ad9b4bbd5bf2813">thread_pool_h</a> ? m_handle.<a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a19e331a28c9bf538fbc545e6a646bb79">queue_handle</a> : AIQueueHandle((std::size_t)0); }</div><div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#a02a176044564db9029919e7e8d718bd7">  182</a></span>&#160;    <span class="keyword">operator</span> bool()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_type != <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1ac87839c65308c498a8b4e611c811f70d">idle_h</a>; }        <span class="comment">// Return true when this handler can be used to actually run in.</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// Gcc complains because what is defined depends on the value of m_type.</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    PRAGMA_DIAGNOSTIC_PUSH_IGNORE_maybe_uninitialized</div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="structAIStatefulTask_1_1Handler.html#a82a63fa453b6988b945dbcfc17d5a331">  187</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structAIStatefulTask_1_1Handler.html#a82a63fa453b6988b945dbcfc17d5a331">operator==</a>(<a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a> handler)<span class="keyword"> const </span>{</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">return</span> m_type == handler.<a class="code" href="structAIStatefulTask_1_1Handler.html#aea9e7f3a92c493364764e377c0062205">m_type</a> &amp;&amp;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            (m_type != <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1a04950d91679c67187cfebbf5325ef0e4">engine_h</a> || m_handle.<a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a4147441fa0b001ee693500e9e7697f5f">engine</a> == handler.<a class="code" href="structAIStatefulTask_1_1Handler.html#a0941f2c6ab21a2d61027f3c01db83dad">m_handle</a>.<a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a4147441fa0b001ee693500e9e7697f5f">engine</a>) &amp;&amp;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            (m_type != <a class="code" href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1afab9afd9e8947ac35ad9b4bbd5bf2813">thread_pool_h</a> || m_handle.<a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a19e331a28c9bf538fbc545e6a646bb79">queue_handle</a> == handler.<a class="code" href="structAIStatefulTask_1_1Handler.html#a0941f2c6ab21a2d61027f3c01db83dad">m_handle</a>.<a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a19e331a28c9bf538fbc545e6a646bb79">queue_handle</a>); }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    PRAGMA_DIAGNOSTIC_POP</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">friend</span> std::ostream&amp; <a class="code" href="structAIStatefulTask_1_1Handler.html#a58a1b2d74e680a118cc560866c0dac0f">operator&lt;&lt;</a>(std::ostream&amp; os, <a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a> <span class="keyword">const</span>&amp; handler);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  };</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor">#ifndef DOXYGEN</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keyword">struct </span>multiplex_state_st {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022">base_state_type</a> base_state;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a> current_handler;            <span class="comment">// Current handler.</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="AIStatefulTask_8h.html#ab6c86bbf81780084fce5eb93d2028af8">AIWaitConditionFunc</a> wait_condition;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">condition_type</a> conditions;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    multiplex_state_st() : base_state(<a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022af78440cbabd50c6cdacd8b4b35afdefe">bs_reset</a>), current_handler(<a class="code" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ae8710aab384c04d9e7cc871e9977a2ee">Handler::idle</a>), wait_condition(<span class="keyword">nullptr</span>) { }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  };</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keyword">struct </span>sub_state_st {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">condition_type</a> busy;              </div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">condition_type</a> skip_wait;         </div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">condition_type</a> <a class="code" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ae8710aab384c04d9e7cc871e9977a2ee">idle</a>;              </div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classAIStatefulTask.html#a5bdb546808c3ff5820246f45b8a54973">state_type</a> run_state;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordtype">bool</span> reset;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">bool</span> need_run;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">bool</span> wait_called;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAIStatefulTask.html#a4dd75e11ef6fd1b14613ad494d8e93d9">aborted</a>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classAIStatefulTask.html#a9fe975f2acbc2e25380c77874644fd25">finished</a>;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  };</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">// Base state.</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keyword">using</span> multiplex_state_type = aithreadsafe::Wrapper&lt;multiplex_state_st, aithreadsafe::policy::Primitive&lt;std::mutex&gt;&gt;;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  multiplex_state_type mState;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">// Sub state.</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keyword">using</span> sub_state_type = aithreadsafe::Wrapper&lt;sub_state_st, aithreadsafe::policy::Primitive&lt;std::mutex&gt;&gt;;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  sub_state_type mSubState;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor">#endif // DOXYGEN</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// Mutex protecting everything below and making sure only one thread runs the task at a time.</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  AIMutex mMultiplexMutex;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">// Mutex that is locked while calling *_impl() functions and the call back.</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  std::recursive_mutex mRunMutex;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keyword">using</span> clock_type = std::chrono::steady_clock;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keyword">using</span> duration_type = clock_type::duration;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  clock_type::rep mSleep;   </div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// Callback facilities.</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// From within an other stateful task:</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  boost::intrusive_ptr&lt;AIStatefulTask&gt; mParent;       <span class="comment">// The parent object that started this task, or nullptr if there isn&#39;t any.</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <a class="code" href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">condition_type</a> mParentCondition;                    <span class="comment">// The condition (bit) that the parent should be signalled with upon a successful finish.</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <a class="code" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657c">on_abort_st</a> mOnAbort;                               <span class="comment">// What to do with the parent (if any) when aborted.</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// From outside a stateful task:</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  std::function&lt;void (bool)&gt;mCallback;                <span class="comment">// Pointer to signal/connection, or nullptr when not connected.</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">// Engine stuff.</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a> mDefaultHandler;            <span class="comment">// Default engine or queue.</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a> mTargetHandler;             <span class="comment">// Requested engine by a call to yield.</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordtype">bool</span> mYield;                        <span class="comment">// True when any yield function was called, except for yield_if_not when the passed engine already matched.</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">// Debug stuff.</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  std::thread::id mThreadId;          <span class="comment">// The thread currently running multiplex() (or std::thread::id() when none).</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022">base_state_type</a> mDebugLastState;    <span class="comment">// The previous state that multiplex() had a normal run with.</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordtype">bool</span> mDebugShouldRun;               <span class="comment">// Set if we found evidence that we should indeed call multiplex_impl().</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordtype">bool</span> mDebugAborted;                 <span class="comment">// True when abort() was called.</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordtype">bool</span> mDebugSignalPending;           <span class="comment">// True while wait() was called but didn&#39;t get idle because of a pending call to signal() that wasn&#39;t handled yet.</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordtype">bool</span> mDebugSetStatePending;         <span class="comment">// True while set_state() was called by not handled yet.</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordtype">bool</span> mDebugRefCalled;               <span class="comment">// True when ref() is called (or will be called within the critial area of mMultiplexMutex).</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor">#if defined(CWDEBUG) &amp;&amp; !defined(DOXYGEN)</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordtype">bool</span> mSMDebug;                      <span class="comment">// Print debug output only when true.</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  duration_type mDuration;            <span class="comment">// Total time spent running in the main thread.</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#a527201e427df104779c634c146a5ebda">  281</a></span>&#160;  <a class="code" href="classAIStatefulTask.html#a527201e427df104779c634c146a5ebda">AIStatefulTask</a>(CWDEBUG_ONLY(<span class="keywordtype">bool</span> debug)) : mDefaultHandler(<a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a>::<a class="code" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ae8710aab384c04d9e7cc871e9977a2ee">idle</a>), mTargetHandler(<a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a>::<a class="code" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ae8710aab384c04d9e7cc871e9977a2ee">idle</a>), mYield(false),</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;#ifdef DEBUG</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  mDebugLastState(<a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022a3bce552d1e92ce75c5c4e71c86a95ef2">bs_killed</a>), mDebugShouldRun(false), mDebugAborted(false), mDebugSignalPending(false),</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  mDebugSetStatePending(false), mDebugRefCalled(false),</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;#endif</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;#ifdef CWDEBUG</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  mSMDebug(debug),</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;#endif</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  mDuration(duration_type::zero()) { }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#ad7f8d3e0fc4f46d67cc412d39bc8fc14">  293</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classAIStatefulTask.html#ad7f8d3e0fc4f46d67cc412d39bc8fc14">~AIStatefulTask</a>()</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022">base_state_type</a> state = multiplex_state_type::rat(mState)-&gt;base_state;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    ASSERT(state == <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022a3bce552d1e92ce75c5c4e71c86a95ef2">bs_killed</a> || state == <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022af78440cbabd50c6cdacd8b4b35afdefe">bs_reset</a>);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__run.html#gac40d1760493b87dcd12920caf0165f87">run</a>(<a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a> default_handler, std::function&lt;<span class="keywordtype">void</span> (<span class="keywordtype">bool</span>)&gt; cb_function);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="group__group__run.html#ga9900f50731b8bc419d034832baef0d4c">  322</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__run.html#ga9900f50731b8bc419d034832baef0d4c">run</a>(std::function&lt;<span class="keywordtype">void</span> (<span class="keywordtype">bool</span>)&gt; cb_function) { <a class="code" href="group__group__run.html#ga9900f50731b8bc419d034832baef0d4c">run</a>(<a class="code" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ac0333f77fe5c74c627b723a8e70f2932">Handler::immediate</a>, cb_function); }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__run.html#gac40d1760493b87dcd12920caf0165f87">run</a>(<a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a> default_handler, <a class="code" href="classAIStatefulTask.html">AIStatefulTask</a>* parent, <a class="code" href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">condition_type</a> condition, <a class="code" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657c">on_abort_st</a> on_abort = <a class="code" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657cae7b1902fa7f7ce6687e188a338721c9e">abort_parent</a>);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="group__group__run.html#ga4e33d2b7c1c19072de60d6e0e835d1d4">  340</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__run.html#ga4e33d2b7c1c19072de60d6e0e835d1d4">run</a>(<a class="code" href="classAIStatefulTask.html">AIStatefulTask</a>* parent, <a class="code" href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">condition_type</a> condition, <a class="code" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657c">on_abort_st</a> on_abort = <a class="code" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657cae7b1902fa7f7ce6687e188a338721c9e">abort_parent</a>) { <a class="code" href="group__group__run.html#ga4e33d2b7c1c19072de60d6e0e835d1d4">run</a>(<a class="code" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ac0333f77fe5c74c627b723a8e70f2932">Handler::immediate</a>, parent, condition, on_abort); }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="group__group__run.html#ga6a1a48030a912ae51de1c6ff18f0d3bd">  347</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__run.html#ga6a1a48030a912ae51de1c6ff18f0d3bd">run</a>(<a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a> default_handler = <a class="code" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ac0333f77fe5c74c627b723a8e70f2932">Handler::immediate</a>) { <a class="code" href="group__group__run.html#ga6a1a48030a912ae51de1c6ff18f0d3bd">run</a>(default_handler, <span class="keyword">nullptr</span>, 0, <a class="code" href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657ca2a91b60c5720a8bf32cb05c96d115bbf">do_nothing</a>); }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__public.html#ga0593a004b92de37cbcfae9f3cfcccaec">kill</a>();</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__protected.html#ga160831e7b091af4095a9f60e33834328">set_state</a>(<a class="code" href="classAIStatefulTask.html#a5bdb546808c3ff5820246f45b8a54973">state_type</a> new_state);       <span class="comment">// Run this state the NEXT loop.</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__wait.html#gaf6b0f3ba324cd8ca6b4a2f925c106897">wait</a>(<a class="code" href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">condition_type</a> conditions);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__wait.html#ga2af39e888e9cfd3936e9fbfe399c08af">wait_until</a>(<a class="code" href="AIStatefulTask_8h.html#ab6c86bbf81780084fce5eb93d2028af8">AIWaitConditionFunc</a> <span class="keyword">const</span>&amp; wait_condition, <a class="code" href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">condition_type</a> conditions);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="group__group__wait.html#gac67d26752d9e61d9c686fbee14b4444d">  429</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__wait.html#gac67d26752d9e61d9c686fbee14b4444d">wait_until</a>(<a class="code" href="AIStatefulTask_8h.html#ab6c86bbf81780084fce5eb93d2028af8">AIWaitConditionFunc</a> <span class="keyword">const</span>&amp; wait_condition, <a class="code" href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">condition_type</a> conditions, <a class="code" href="classAIStatefulTask.html#a5bdb546808c3ff5820246f45b8a54973">state_type</a> new_state)</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="group__group__protected.html#ga160831e7b091af4095a9f60e33834328">set_state</a>(new_state);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="group__group__wait.html#ga2af39e888e9cfd3936e9fbfe399c08af">wait_until</a>(wait_condition, conditions);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__protected.html#gaf7642911a8012284ec7aa5a9a700b06b">finish</a>();</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="group__group__protected.html#ga59d5a998e43866969cd8d92b8924ddb1">is_self_locked</a>(<a class="code" href="classAIStatefulTaskMutex.html">AIStatefulTaskMutex</a>&amp; stateful_task_mutex);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__yield.html#ga00981f1360b10d5f99f805d501a537a2">yield</a>();</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__yield.html#ga32265465bc41279fea4654941ff31de7">target</a>(<a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a> handler);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__yield.html#ga00981f1360b10d5f99f805d501a537a2">yield</a>(<a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a> handler);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__yield.html#ga04f5c7619157f72cf98700e423bd6766">yield_frame</a>(<a class="code" href="classAIEngine.html">AIEngine</a>* <a class="code" href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a4147441fa0b001ee693500e9e7697f5f">engine</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> frames);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__yield.html#gaa79810701038b0c5fa974fc4b64dc902">yield_ms</a>(<a class="code" href="classAIEngine.html">AIEngine</a>* engine, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ms);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="group__group__yield.html#ga669b3bea6b80ec684cb5b96b3fb84d22">yield_if_not</a>(<a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a> handler);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// Calls wait_until.</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classAIFriendOfStatefulTask.html">AIFriendOfStatefulTask</a>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__group__public.html#gac520d813fed06cba4eef1913c3daca3f">abort</a>();</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="group__group__public.html#ga8b7111d021ba8507748df416a0631e5d">signal</a>(<a class="code" href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">condition_type</a> condition);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">// Accessors.</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#a17b9024efb750d98f835ea050a07414e">  580</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classAIStatefulTask.html#a17b9024efb750d98f835ea050a07414e">running</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> multiplex_state_type::crat(mState)-&gt;base_state == <a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022a9b6c32619c183bf636f8a38c30fa1ecc">bs_multiplex</a>; }</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classAIStatefulTask.html#a487f7328bbd5508b63855194d2403f94">waiting</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classAIStatefulTask.html#ab2b07501507b6597fbd99b859bce4261">waiting_or_aborting</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#a827dfb8d3bb87f27c2d373475d389982">  609</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classAIStatefulTask.html#a827dfb8d3bb87f27c2d373475d389982">active</a>(<a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a> handler)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> multiplex_state_type::crat(mState)-&gt;current_handler == handler; }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#a24a4e2c228f2a900e94495aa4ba662db">  617</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classAIStatefulTask.html#a24a4e2c228f2a900e94495aa4ba662db">is_immediate</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> multiplex_state_type::crat(mState)-&gt;current_handler.is_immediate(); }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">// For debugging purposes mainly.</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordtype">bool</span> default_is_immediate()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mDefaultHandler.<a class="code" href="structAIStatefulTask_1_1Handler.html#a933c3c024a9b3fe38c97e5efbe70b17c">is_immediate</a>(); }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#a9fe975f2acbc2e25380c77874644fd25">  631</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classAIStatefulTask.html#a9fe975f2acbc2e25380c77874644fd25">finished</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    sub_state_type::crat sub_state_r(mSubState);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">return</span> sub_state_r-&gt;finished ? &amp;AIStatefulTask::mOnAbort : 0;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#a4dd75e11ef6fd1b14613ad494d8e93d9">  642</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classAIStatefulTask.html#a4dd75e11ef6fd1b14613ad494d8e93d9">aborted</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> sub_state_type::crat(mSubState)-&gt;aborted; }</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#a855cb8523b22595dc5ef69361633e7bb">  647</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classAIStatefulTask.html#a855cb8523b22595dc5ef69361633e7bb">executing</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mMultiplexMutex.is_self_locked(); }</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> <span class="keyword">const</span>* <a class="code" href="classAIStatefulTask.html#a416f76c11dda361438485e424e43e501">state_str</a>(<a class="code" href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022">base_state_type</a> state);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="preprocessor">#ifdef CWDEBUG</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> <span class="keyword">const</span>* <a class="code" href="classAIStatefulTask.html#a650d995db3e1117ce9c26947aef34d90">event_str</a>(event_type event);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno"><a class="line" href="classAIStatefulTask.html#a09e20373d0b86c70a80a27e754c1bd66">  669</a></span>&#160;  duration_type <a class="code" href="classAIStatefulTask.html#a09e20373d0b86c70a80a27e754c1bd66">getDuration</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mDuration; }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">char</span> <span class="keyword">const</span>* <a class="code" href="classAIStatefulTask.html#abf2da57033c2f1d05a7f6b59fe392d67">state_str_impl</a>(<a class="code" href="classAIStatefulTask.html#a5bdb546808c3ff5820246f45b8a54973">state_type</a> run_state) <span class="keyword">const</span>;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classAIStatefulTask.html#afe86c9acff86165977302965e5401e20">initialize_impl</a>();</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classAIStatefulTask.html#a57233a1b95a6fdbef04c4cab3fd890ae">multiplex_impl</a>(<a class="code" href="classAIStatefulTask.html#a5bdb546808c3ff5820246f45b8a54973">state_type</a> run_state) = 0;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classAIStatefulTask.html#a61a6f86a6e413cf7391b756b0038d4f0">abort_impl</a>();</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classAIStatefulTask.html#a872025f08ce55e54810495690da7b337">finish_impl</a>();</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classAIStatefulTask.html#a415a771f1c6fd7046702921215eb37dc">force_killed</a>();</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordtype">void</span> reset();                                       <span class="comment">// Called from run() to (re)initialize a (re)start.</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordtype">void</span> multiplex(event_type event, <a class="code" href="structAIStatefulTask_1_1Handler.html">Handler</a> handler = <a class="code" href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ae8710aab384c04d9e7cc871e9977a2ee">Handler::idle</a>);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <a class="code" href="classAIStatefulTask.html#a5bdb546808c3ff5820246f45b8a54973">state_type</a> begin_loop();                            <span class="comment">// Called from multiplex() at the start of a loop.</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordtype">void</span> callback();                                    <span class="comment">// Called when the task finished.</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordtype">bool</span> sleep(clock_type::time_point current_time)     <span class="comment">// Count frames if necessary and return true when the task is still sleeping.</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">if</span> (mSleep == 0)</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mSleep &lt; 0)</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      ++mSleep;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mSleep &lt;= current_time.time_since_epoch().count())</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      mSleep = 0;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">return</span> mSleep != 0;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordtype">void</span> add(duration_type delta) { mDuration += delta; }</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classAIEngine.html">AIEngine</a>;      <span class="comment">// Calls multiplex(), force_killed() and add().</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;};</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="preprocessor">#if defined(CWDEBUG) &amp;&amp; !defined(DOXYGEN)</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;NAMESPACE_DEBUG_CHANNELS_START</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="keyword">extern</span> channel_ct <a class="code" href="namespacestatefultask.html">statefultask</a>;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;NAMESPACE_DEBUG_CHANNELS_END</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno"><a class="line" href="namespacetask.html">  726</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacetask.html">task</a> {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> TaskType, <span class="keyword">typename</span>... ARGS, <span class="keyword">typename</span> = <span class="keyword">typename</span> std::enable_if&lt;std::is_base_of&lt;AIStatefulTask, TaskType&gt;::value&gt;::type&gt;</div><div class="line"><a name="l00764"></a><span class="lineno"><a class="line" href="namespacetask.html#aaf85b35668e9562dc3647e4fd1a9e2fe">  764</a></span>&#160;boost::intrusive_ptr&lt;TaskType&gt; <a class="code" href="namespacetask.html#aaf85b35668e9562dc3647e4fd1a9e2fe">create</a>(ARGS&amp;&amp;... args)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;{</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="preprocessor">#ifdef CWDEBUG</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="preprocessor">#if CWDEBUG_LOCATION</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  LibcwDoutScopeBegin(LIBCWD_DEBUGCHANNELS, ::libcwd::libcw_do, dc::statefultask)</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  LibcwDoutStream &lt;&lt; <span class="stringliteral">&quot;Entering task::create&lt;&quot;</span> &lt;&lt; libcwd::type_info_of&lt;TaskType&gt;().demangled_name();</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  (LibcwDoutStream &lt;&lt; ... &lt;&lt; (<span class="stringliteral">&quot;, &quot;</span> + libcwd::type_info_of&lt;ARGS&gt;().demangled_name())) &lt;&lt; <span class="stringliteral">&quot;&gt;(&quot;</span> &lt;&lt; join(<span class="stringliteral">&quot;, &quot;</span>, args...) &lt;&lt; <span class="charliteral">&#39;)&#39;</span>;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  LibcwDoutScopeEnd;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  ::NAMESPACE_DEBUG::Indent indentation(2);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  DoutEntering(dc::evio, <span class="stringliteral">&quot;task::create&lt;&gt;(&quot;</span> &lt;&lt; join(<span class="stringliteral">&quot;, &quot;</span>, args...) &lt;&lt; <span class="charliteral">&#39;)&#39;</span>)</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  TaskType* <a class="code" href="namespacetask.html">task</a> = <span class="keyword">new</span> TaskType(std::forward&lt;ARGS&gt;(args)...);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  AllocTag2(task, <span class="stringliteral">&quot;Created with task::create&quot;</span>);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  Dout(dc::statefultask, <span class="stringliteral">&quot;Returning task pointer &quot;</span> &lt;&lt; (<span class="keywordtype">void</span>*)task &lt;&lt; <span class="stringliteral">&quot; [&quot;</span> &lt;&lt; static_cast&lt;AIStatefulTask*&gt;(task) &lt;&lt; <span class="stringliteral">&quot;].&quot;</span>);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="keywordflow">return</span> task;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;}</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;} <span class="comment">// namespace task</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AIStatefulTaskMutex_8h.html">AIStatefulTaskMutex.h</a>&quot;</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno"><a class="line" href="group__group__protected.html#ga59d5a998e43866969cd8d92b8924ddb1">  787</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="group__group__protected.html#ga59d5a998e43866969cd8d92b8924ddb1">AIStatefulTask::is_self_locked</a>(<a class="code" href="classAIStatefulTaskMutex.html">AIStatefulTaskMutex</a>&amp; stateful_task_mutex)</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;{</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordflow">return</span> stateful_task_mutex.is_self_locked(<span class="keyword">this</span>);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;}</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="preprocessor">#endif // AISTATEFULTASK_H</span></div><div class="ttc" id="structAIStatefulTask_1_1Handler_html_a49239baf5f285bd7d8161234a54c45d1"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1">AIStatefulTask::Handler::type_t</a></div><div class="ttdeci">type_t</div><div class="ttdoc">The type of m_type. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:143</div></div>
<div class="ttc" id="classAIStatefulTask_html_a17b9024efb750d98f835ea050a07414e"><div class="ttname"><a href="classAIStatefulTask.html#a17b9024efb750d98f835ea050a07414e">AIStatefulTask::running</a></div><div class="ttdeci">bool running() const</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:580</div></div>
<div class="ttc" id="classAIStatefulTask_html_a324d12498b3656b815b88741b8c5657ca2a91b60c5720a8bf32cb05c96d115bbf"><div class="ttname"><a href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657ca2a91b60c5720a8bf32cb05c96d115bbf">AIStatefulTask::do_nothing</a></div><div class="ttdoc">Abort without notifying the parent task. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:119</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_aca54ebf01e1ecef9caa3a071b52fcc39"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#aca54ebf01e1ecef9caa3a071b52fcc39">AIStatefulTask::Handler::Handler</a></div><div class="ttdeci">Handler(AIEngine *engine)</div><div class="ttdoc">Construct a Handler from an AIEngine pointer. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:172</div></div>
<div class="ttc" id="classAIStatefulTask_html_acb2390570fc523acceee2a25fc054022aec4ed721e379b53e6a25378842f23e48"><div class="ttname"><a href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022aec4ed721e379b53e6a25378842f23e48">AIStatefulTask::bs_callback</a></div><div class="ttdoc">State after finish_impl() and before the call back. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:108</div></div>
<div class="ttc" id="classAIStatefulTask_html_a24a4e2c228f2a900e94495aa4ba662db"><div class="ttname"><a href="classAIStatefulTask.html#a24a4e2c228f2a900e94495aa4ba662db">AIStatefulTask::is_immediate</a></div><div class="ttdeci">bool is_immediate() const</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:617</div></div>
<div class="ttc" id="group__group__public_html_ga0593a004b92de37cbcfae9f3cfcccaec"><div class="ttname"><a href="group__group__public.html#ga0593a004b92de37cbcfae9f3cfcccaec">AIStatefulTask::kill</a></div><div class="ttdeci">void kill()</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1146</div></div>
<div class="ttc" id="namespacetask_html_aaf85b35668e9562dc3647e4fd1a9e2fe"><div class="ttname"><a href="namespacetask.html#aaf85b35668e9562dc3647e4fd1a9e2fe">task::create</a></div><div class="ttdeci">boost::intrusive_ptr&lt; TaskType &gt; create(ARGS &amp;&amp;... args)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:764</div></div>
<div class="ttc" id="group__group__protected_html_ga59d5a998e43866969cd8d92b8924ddb1"><div class="ttname"><a href="group__group__protected.html#ga59d5a998e43866969cd8d92b8924ddb1">AIStatefulTask::is_self_locked</a></div><div class="ttdeci">bool is_self_locked(AIStatefulTaskMutex &amp;stateful_task_mutex)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:787</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html">AIStatefulTask::Handler</a></div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:140</div></div>
<div class="ttc" id="classAIStatefulTask_html_acb2390570fc523acceee2a25fc054022aebc06158eae8ab491a771da0173360f2"><div class="ttname"><a href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022aebc06158eae8ab491a771da0173360f2">AIStatefulTask::bs_finish</a></div><div class="ttdoc">State after finish() (assuming abort() isn&amp;#39;t called) and leaving multiplex_impl (if there)...</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:107</div></div>
<div class="ttc" id="classAIStatefulTask_html_acb2390570fc523acceee2a25fc054022ad10a46cd78607d3dacfcd1d3ce68f3db"><div class="ttname"><a href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022ad10a46cd78607d3dacfcd1d3ce68f3db">AIStatefulTask::bs_abort</a></div><div class="ttdoc">State after abort() and leaving inside multiplex_impl (if there), and before abort_impl(). </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:106</div></div>
<div class="ttc" id="classAIFriendOfStatefulTask_html"><div class="ttname"><a href="classAIFriendOfStatefulTask.html">AIFriendOfStatefulTask</a></div><div class="ttdef"><b>Definition:</b> AIFriendOfStatefulTask.h:60</div></div>
<div class="ttc" id="AIStatefulTask_8h_html_ab6c86bbf81780084fce5eb93d2028af8"><div class="ttname"><a href="AIStatefulTask_8h.html#ab6c86bbf81780084fce5eb93d2028af8">AIWaitConditionFunc</a></div><div class="ttdeci">std::function&lt; bool()&gt; AIWaitConditionFunc</div><div class="ttdoc">The type of the functor that must be passed as first parameter to AIStatefulTask::wait_until. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:58</div></div>
<div class="ttc" id="classAIStatefulTask_html_acb2390570fc523acceee2a25fc054022ae322cda5bdc1ea7d2daf120cc69f091a"><div class="ttname"><a href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022ae322cda5bdc1ea7d2daf120cc69f091a">AIStatefulTask::bs_initialize</a></div><div class="ttdoc">State after run and before/during initialize_impl. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:104</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_a31078b881cbbf42d2e3e3998b905d1b2ac0333f77fe5c74c627b723a8e70f2932"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ac0333f77fe5c74c627b723a8e70f2932">AIStatefulTask::Handler::immediate</a></div><div class="ttdoc">Construct an immediate Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:152</div></div>
<div class="ttc" id="classAIStatefulTask_html_ad7f8d3e0fc4f46d67cc412d39bc8fc14"><div class="ttname"><a href="classAIStatefulTask.html#ad7f8d3e0fc4f46d67cc412d39bc8fc14">AIStatefulTask::~AIStatefulTask</a></div><div class="ttdeci">virtual ~AIStatefulTask()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:293</div></div>
<div class="ttc" id="unionAIStatefulTask_1_1Handler_1_1Handle_html_a25ab0183c26bf8b46fdfae8080263508"><div class="ttname"><a href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a25ab0183c26bf8b46fdfae8080263508">AIStatefulTask::Handler::Handle::Handle</a></div><div class="ttdeci">Handle(AIEngine *engine_)</div><div class="ttdoc">Construct a Handle from an AIEngine pointer. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:162</div></div>
<div class="ttc" id="classAIStatefulTask_html_a9fe975f2acbc2e25380c77874644fd25"><div class="ttname"><a href="classAIStatefulTask.html#a9fe975f2acbc2e25380c77874644fd25">AIStatefulTask::finished</a></div><div class="ttdeci">bool finished() const</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:631</div></div>
<div class="ttc" id="classAIStatefulTask_html_abf2da57033c2f1d05a7f6b59fe392d67"><div class="ttname"><a href="classAIStatefulTask.html#abf2da57033c2f1d05a7f6b59fe392d67">AIStatefulTask::state_str_impl</a></div><div class="ttdeci">virtual char const  * state_str_impl(state_type run_state) const</div><div class="ttdoc">Called to stringify a run state for debugging output. Must be overridden. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1117</div></div>
<div class="ttc" id="AIStatefulTaskMutex_8h_html"><div class="ttname"><a href="AIStatefulTaskMutex_8h.html">AIStatefulTaskMutex.h</a></div><div class="ttdoc">Mutex for stateful tasks. Declaration of class AIStatefulTaskMutex. </div></div>
<div class="ttc" id="group__group__public_html_gac520d813fed06cba4eef1913c3daca3f"><div class="ttname"><a href="group__group__public.html#gac520d813fed06cba4eef1913c3daca3f">AIStatefulTask::abort</a></div><div class="ttdeci">void abort()</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1316</div></div>
<div class="ttc" id="classAIStatefulTask_html_acb2390570fc523acceee2a25fc054022a3bce552d1e92ce75c5c4e71c86a95ef2"><div class="ttname"><a href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022a3bce552d1e92ce75c5c4e71c86a95ef2">AIStatefulTask::bs_killed</a></div><div class="ttdoc">State after the call back, or when aborted before being initialized. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:109</div></div>
<div class="ttc" id="group__group__protected_html_gaf7642911a8012284ec7aa5a9a700b06b"><div class="ttname"><a href="group__group__protected.html#gaf7642911a8012284ec7aa5a9a700b06b">AIStatefulTask::finish</a></div><div class="ttdeci">void finish()</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1351</div></div>
<div class="ttc" id="classAIStatefulTask_html_a416f76c11dda361438485e424e43e501"><div class="ttname"><a href="classAIStatefulTask.html#a416f76c11dda361438485e424e43e501">AIStatefulTask::state_str</a></div><div class="ttdeci">static char const  * state_str(base_state_type state)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1445</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_af37420fb70091a985361b1701b00e4f4"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#af37420fb70091a985361b1701b00e4f4">AIStatefulTask::Handler::is_engine</a></div><div class="ttdeci">bool is_engine() const</div><div class="ttdoc">Return true if this is an engine Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:176</div></div>
<div class="ttc" id="group__group__yield_html_gaa79810701038b0c5fa974fc4b64dc902"><div class="ttname"><a href="group__group__yield.html#gaa79810701038b0c5fa974fc4b64dc902">AIStatefulTask::yield_ms</a></div><div class="ttdeci">void yield_ms(AIEngine *engine, unsigned int ms)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1435</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_a49239baf5f285bd7d8161234a54c45d1ac87839c65308c498a8b4e611c811f70d"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1ac87839c65308c498a8b4e611c811f70d">AIStatefulTask::Handler::idle_h</a></div><div class="ttdoc">An idle Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:144</div></div>
<div class="ttc" id="group__group__run_html_ga6a1a48030a912ae51de1c6ff18f0d3bd"><div class="ttname"><a href="group__group__run.html#ga6a1a48030a912ae51de1c6ff18f0d3bd">AIStatefulTask::run</a></div><div class="ttdeci">void run(Handler default_handler=Handler::immediate)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:347</div></div>
<div class="ttc" id="classAIStatefulTask_html_acb2390570fc523acceee2a25fc054022af78440cbabd50c6cdacd8b4b35afdefe"><div class="ttname"><a href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022af78440cbabd50c6cdacd8b4b35afdefe">AIStatefulTask::bs_reset</a></div><div class="ttdoc">Idle state before run is called. Reference count is zero (except for a possible external boost::intru...</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:103</div></div>
<div class="ttc" id="group__group__run_html_ga9900f50731b8bc419d034832baef0d4c"><div class="ttname"><a href="group__group__run.html#ga9900f50731b8bc419d034832baef0d4c">AIStatefulTask::run</a></div><div class="ttdeci">void run(std::function&lt; void(bool)&gt; cb_function)</div><div class="ttdoc">The same as above but use the immediate  Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:322</div></div>
<div class="ttc" id="classAIStatefulTask_html_acb2390570fc523acceee2a25fc054022"><div class="ttname"><a href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022">AIStatefulTask::base_state_type</a></div><div class="ttdeci">base_state_type</div><div class="ttdoc">The type of mState. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:102</div></div>
<div class="ttc" id="unionAIStatefulTask_1_1Handler_1_1Handle_html_a6ce5640a5a8258f7185ad4541f61c1ef"><div class="ttname"><a href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a6ce5640a5a8258f7185ad4541f61c1ef">AIStatefulTask::Handler::Handle::Handle</a></div><div class="ttdeci">Handle()</div><div class="ttdoc">Construct an uninitialized Handle. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:160</div></div>
<div class="ttc" id="classAIStatefulTask_html_ab2b07501507b6597fbd99b859bce4261"><div class="ttname"><a href="classAIStatefulTask.html#ab2b07501507b6597fbd99b859bce4261">AIStatefulTask::waiting_or_aborting</a></div><div class="ttdeci">bool waiting_or_aborting() const</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:441</div></div>
<div class="ttc" id="classAIStatefulTask_html_a872025f08ce55e54810495690da7b337"><div class="ttname"><a href="classAIStatefulTask.html#a872025f08ce55e54810495690da7b337">AIStatefulTask::finish_impl</a></div><div class="ttdeci">virtual void finish_impl()</div><div class="ttdoc">Called for base state bs_finish. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1136</div></div>
<div class="ttc" id="classAIStatefulTask_html"><div class="ttname"><a href="classAIStatefulTask.html">AIStatefulTask</a></div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:85</div></div>
<div class="ttc" id="classAIStatefulTask_html_a527201e427df104779c634c146a5ebda"><div class="ttname"><a href="classAIStatefulTask.html#a527201e427df104779c634c146a5ebda">AIStatefulTask::AIStatefulTask</a></div><div class="ttdeci">AIStatefulTask(bool debug)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:281</div></div>
<div class="ttc" id="group__group__yield_html_ga669b3bea6b80ec684cb5b96b3fb84d22"><div class="ttname"><a href="group__group__yield.html#ga669b3bea6b80ec684cb5b96b3fb84d22">AIStatefulTask::yield_if_not</a></div><div class="ttdeci">bool yield_if_not(Handler handler)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1416</div></div>
<div class="ttc" id="classAIStatefulTaskMutex_html"><div class="ttname"><a href="classAIStatefulTaskMutex.html">AIStatefulTaskMutex</a></div><div class="ttdef"><b>Definition:</b> AIStatefulTaskMutex.h:68</div></div>
<div class="ttc" id="classAIStatefulTask_html_adb2ea8142438089410700b94ad354364"><div class="ttname"><a href="classAIStatefulTask.html#adb2ea8142438089410700b94ad354364">AIStatefulTask::state_end</a></div><div class="ttdeci">static state_type constexpr state_end</div><div class="ttdoc">The next state value to use for derived classes. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:114</div></div>
<div class="ttc" id="classAIStatefulTask_html_a57233a1b95a6fdbef04c4cab3fd890ae"><div class="ttname"><a href="classAIStatefulTask.html#a57233a1b95a6fdbef04c4cab3fd890ae">AIStatefulTask::multiplex_impl</a></div><div class="ttdeci">virtual void multiplex_impl(state_type run_state)=0</div><div class="ttdoc">Called for base state bs_multiplex. </div></div>
<div class="ttc" id="group__group__run_html_ga4e33d2b7c1c19072de60d6e0e835d1d4"><div class="ttname"><a href="group__group__run.html#ga4e33d2b7c1c19072de60d6e0e835d1d4">AIStatefulTask::run</a></div><div class="ttdeci">void run(AIStatefulTask *parent, condition_type condition, on_abort_st on_abort=abort_parent)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:340</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_a0941f2c6ab21a2d61027f3c01db83dad"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#a0941f2c6ab21a2d61027f3c01db83dad">AIStatefulTask::Handler::m_handle</a></div><div class="ttdeci">Handle m_handle</div><div class="ttdoc">Extra data that depends on m_type. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:166</div></div>
<div class="ttc" id="unionAIStatefulTask_1_1Handler_1_1Handle_html_aee84423e83d0b9648f37908d2cd7d5fc"><div class="ttname"><a href="unionAIStatefulTask_1_1Handler_1_1Handle.html#aee84423e83d0b9648f37908d2cd7d5fc">AIStatefulTask::Handler::Handle::Handle</a></div><div class="ttdeci">Handle(AIQueueHandle queue_handle_)</div><div class="ttdoc">Construct a Handle from a thread pool handle. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:164</div></div>
<div class="ttc" id="classAIStatefulTask_html_a324d12498b3656b815b88741b8c5657cae7b1902fa7f7ce6687e188a338721c9e"><div class="ttname"><a href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657cae7b1902fa7f7ce6687e188a338721c9e">AIStatefulTask::abort_parent</a></div><div class="ttdoc">Call abort() on the parent. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:117</div></div>
<div class="ttc" id="namespacetask_html"><div class="ttname"><a href="namespacetask.html">task</a></div><div class="ttdoc">Tasks defined by the library project are put into this namespace. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:726</div></div>
<div class="ttc" id="classAIStatefulTask_html_ab2831a32490449ec5320f939363ea059"><div class="ttname"><a href="classAIStatefulTask.html#ab2831a32490449ec5320f939363ea059">AIStatefulTask::condition_type</a></div><div class="ttdeci">uint32_t condition_type</div><div class="ttdoc">The type of the busy, skip_wait and idle bit masks. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:89</div></div>
<div class="ttc" id="unionAIStatefulTask_1_1Handler_1_1Handle_html"><div class="ttname"><a href="unionAIStatefulTask_1_1Handler_1_1Handle.html">AIStatefulTask::Handler::Handle</a></div><div class="ttdoc">Contains extra data that depends on the type of the Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:155</div></div>
<div class="ttc" id="group__group__public_html_ga8b7111d021ba8507748df416a0631e5d"><div class="ttname"><a href="group__group__public.html#ga8b7111d021ba8507748df416a0631e5d">AIStatefulTask::signal</a></div><div class="ttdeci">bool signal(condition_type condition)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1285</div></div>
<div class="ttc" id="classAIStatefulTask_html_afe86c9acff86165977302965e5401e20"><div class="ttname"><a href="classAIStatefulTask.html#afe86c9acff86165977302965e5401e20">AIStatefulTask::initialize_impl</a></div><div class="ttdeci">virtual void initialize_impl()</div><div class="ttdoc">Called for base state bs_initialize. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1124</div></div>
<div class="ttc" id="classAIStatefulTask_html_a415a771f1c6fd7046702921215eb37dc"><div class="ttname"><a href="classAIStatefulTask.html#a415a771f1c6fd7046702921215eb37dc">AIStatefulTask::force_killed</a></div><div class="ttdeci">virtual void force_killed()</div><div class="ttdoc">Called from AIEngine::flush(). </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1141</div></div>
<div class="ttc" id="classAIStatefulTask_html_a09e20373d0b86c70a80a27e754c1bd66"><div class="ttname"><a href="classAIStatefulTask.html#a09e20373d0b86c70a80a27e754c1bd66">AIStatefulTask::getDuration</a></div><div class="ttdeci">duration_type getDuration() const</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:669</div></div>
<div class="ttc" id="group__group__wait_html_gac67d26752d9e61d9c686fbee14b4444d"><div class="ttname"><a href="group__group__wait.html#gac67d26752d9e61d9c686fbee14b4444d">AIStatefulTask::wait_until</a></div><div class="ttdeci">void wait_until(AIWaitConditionFunc const &amp;wait_condition, condition_type conditions, state_type new_state)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:429</div></div>
<div class="ttc" id="classAIEngine_html"><div class="ttname"><a href="classAIEngine.html">AIEngine</a></div><div class="ttdef"><b>Definition:</b> AIEngine.h:108</div></div>
<div class="ttc" id="classAIStatefulTask_html_a324d12498b3656b815b88741b8c5657ca0c7895dfa591806cc29b0f39a1332213"><div class="ttname"><a href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657ca0c7895dfa591806cc29b0f39a1332213">AIStatefulTask::signal_parent</a></div><div class="ttdoc">Call signal(condition_type) on the parent anyway. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:118</div></div>
<div class="ttc" id="group__group__protected_html_ga160831e7b091af4095a9f60e33834328"><div class="ttname"><a href="group__group__protected.html#ga160831e7b091af4095a9f60e33834328">AIStatefulTask::set_state</a></div><div class="ttdeci">void set_state(state_type new_state)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1198</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_ad153dd9a853d482cd606e71162b0d322"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#ad153dd9a853d482cd606e71162b0d322">AIStatefulTask::Handler::get_queue_handle</a></div><div class="ttdeci">AIQueueHandle get_queue_handle() const</div><div class="ttdoc">Return the AIQueueHandle to use (only call when appropriate). </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:180</div></div>
<div class="ttc" id="classAIStatefulTask_html_a487f7328bbd5508b63855194d2403f94"><div class="ttname"><a href="classAIStatefulTask.html#a487f7328bbd5508b63855194d2403f94">AIStatefulTask::waiting</a></div><div class="ttdeci">bool waiting() const</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:435</div></div>
<div class="ttc" id="group__group__wait_html_gaf6b0f3ba324cd8ca6b4a2f925c106897"><div class="ttname"><a href="group__group__wait.html#gaf6b0f3ba324cd8ca6b4a2f925c106897">AIStatefulTask::wait</a></div><div class="ttdeci">void wait(condition_type conditions)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1226</div></div>
<div class="ttc" id="classAIStatefulTask_html_a855cb8523b22595dc5ef69361633e7bb"><div class="ttname"><a href="classAIStatefulTask.html#a855cb8523b22595dc5ef69361633e7bb">AIStatefulTask::executing</a></div><div class="ttdeci">bool executing() const</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:647</div></div>
<div class="ttc" id="unionAIStatefulTask_1_1Handler_1_1Handle_html_a4147441fa0b001ee693500e9e7697f5f"><div class="ttname"><a href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a4147441fa0b001ee693500e9e7697f5f">AIStatefulTask::Handler::Handle::engine</a></div><div class="ttdeci">AIEngine * engine</div><div class="ttdoc">The actual engine when this is an engine Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:156</div></div>
<div class="ttc" id="classAIStatefulTask_html_a827dfb8d3bb87f27c2d373475d389982"><div class="ttname"><a href="classAIStatefulTask.html#a827dfb8d3bb87f27c2d373475d389982">AIStatefulTask::active</a></div><div class="ttdeci">bool active(Handler handler) const</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:609</div></div>
<div class="ttc" id="group__group__run_html_gac40d1760493b87dcd12920caf0165f87"><div class="ttname"><a href="group__group__run.html#gac40d1760493b87dcd12920caf0165f87">AIStatefulTask::run</a></div><div class="ttdeci">void run(Handler default_handler, std::function&lt; void(bool)&gt; cb_function)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1045</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_a49239baf5f285bd7d8161234a54c45d1afab9afd9e8947ac35ad9b4bbd5bf2813"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1afab9afd9e8947ac35ad9b4bbd5bf2813">AIStatefulTask::Handler::thread_pool_h</a></div><div class="ttdoc">A thread pool Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:147</div></div>
<div class="ttc" id="classAIStatefulTask_html_a324d12498b3656b815b88741b8c5657c"><div class="ttname"><a href="classAIStatefulTask.html#a324d12498b3656b815b88741b8c5657c">AIStatefulTask::on_abort_st</a></div><div class="ttdeci">on_abort_st</div><div class="ttdoc">What to do when a child task is aborted. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:116</div></div>
<div class="ttc" id="namespacestatefultask_html"><div class="ttname"><a href="namespacestatefultask.html">statefultask</a></div><div class="ttdef"><b>Definition:</b> DefaultMemoryPagePool.cxx:31</div></div>
<div class="ttc" id="classAIStatefulTask_html_a5bdb546808c3ff5820246f45b8a54973"><div class="ttname"><a href="classAIStatefulTask.html#a5bdb546808c3ff5820246f45b8a54973">AIStatefulTask::state_type</a></div><div class="ttdeci">uint32_t state_type</div><div class="ttdoc">The type of run_state. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:88</div></div>
<div class="ttc" id="unionAIStatefulTask_1_1Handler_1_1Handle_html_a19e331a28c9bf538fbc545e6a646bb79"><div class="ttname"><a href="unionAIStatefulTask_1_1Handler_1_1Handle.html#a19e331a28c9bf538fbc545e6a646bb79">AIStatefulTask::Handler::Handle::queue_handle</a></div><div class="ttdeci">AIQueueHandle queue_handle</div><div class="ttdoc">The actual thread pool queue when this is a thread pool Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:157</div></div>
<div class="ttc" id="group__group__yield_html_ga04f5c7619157f72cf98700e423bd6766"><div class="ttname"><a href="group__group__yield.html#ga04f5c7619157f72cf98700e423bd6766">AIStatefulTask::yield_frame</a></div><div class="ttdeci">void yield_frame(AIEngine *engine, unsigned int frames)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1426</div></div>
<div class="ttc" id="group__group__wait_html_ga2af39e888e9cfd3936e9fbfe399c08af"><div class="ttname"><a href="group__group__wait.html#ga2af39e888e9cfd3936e9fbfe399c08af">AIStatefulTask::wait_until</a></div><div class="ttdeci">void wait_until(AIWaitConditionFunc const &amp;wait_condition, condition_type conditions)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1269</div></div>
<div class="ttc" id="group__group__yield_html_ga32265465bc41279fea4654941ff31de7"><div class="ttname"><a href="group__group__yield.html#ga32265465bc41279fea4654941ff31de7">AIStatefulTask::target</a></div><div class="ttdeci">void target(Handler handler)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1390</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_a58a1b2d74e680a118cc560866c0dac0f"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#a58a1b2d74e680a118cc560866c0dac0f">AIStatefulTask::Handler::operator&lt;&lt;</a></div><div class="ttdeci">friend std::ostream &amp; operator&lt;&lt;(std::ostream &amp;os, Handler const &amp;handler)</div><div class="ttdoc">Write a Handler to an ostream. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:971</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_a49239baf5f285bd7d8161234a54c45d1ab2f53bbc738d09e1fdc9cd2d1821caeb"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1ab2f53bbc738d09e1fdc9cd2d1821caeb">AIStatefulTask::Handler::immediate_h</a></div><div class="ttdoc">An immediate Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:145</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_aea9e7f3a92c493364764e377c0062205"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#aea9e7f3a92c493364764e377c0062205">AIStatefulTask::Handler::m_type</a></div><div class="ttdeci">type_t m_type</div><div class="ttdoc">The type of this Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:167</div></div>
<div class="ttc" id="classAIStatefulTask_html_a61a6f86a6e413cf7391b756b0038d4f0"><div class="ttname"><a href="classAIStatefulTask.html#a61a6f86a6e413cf7391b756b0038d4f0">AIStatefulTask::abort_impl</a></div><div class="ttdeci">virtual void abort_impl()</div><div class="ttdoc">Called for base state bs_abort. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1131</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_a49239baf5f285bd7d8161234a54c45d1a04950d91679c67187cfebbf5325ef0e4"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#a49239baf5f285bd7d8161234a54c45d1a04950d91679c67187cfebbf5325ef0e4">AIStatefulTask::Handler::engine_h</a></div><div class="ttdoc">An engine Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:146</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_a8cbc793e81e1a30a5c736d6d81784b18"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#a8cbc793e81e1a30a5c736d6d81784b18">AIStatefulTask::Handler::Handler</a></div><div class="ttdeci">Handler(AIQueueHandle queue_handle)</div><div class="ttdoc">Construct a Handler from an AIQueueHandle. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:174</div></div>
<div class="ttc" id="group__group__yield_html_ga00981f1360b10d5f99f805d501a537a2"><div class="ttname"><a href="group__group__yield.html#ga00981f1360b10d5f99f805d501a537a2">AIStatefulTask::yield</a></div><div class="ttdeci">void yield()</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:1374</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_a31078b881cbbf42d2e3e3998b905d1b2ae8710aab384c04d9e7cc871e9977a2ee"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2ae8710aab384c04d9e7cc871e9977a2ee">AIStatefulTask::Handler::idle</a></div><div class="ttdoc">Construct an idle Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:151</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_aa1fe3cf9aacc0be068a7f86e2fbdb62d"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#aa1fe3cf9aacc0be068a7f86e2fbdb62d">AIStatefulTask::Handler::Handler</a></div><div class="ttdeci">Handler(special_t special)</div><div class="ttdoc">Construct a special Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:170</div></div>
<div class="ttc" id="classAIStatefulTask_html_a4dd75e11ef6fd1b14613ad494d8e93d9"><div class="ttname"><a href="classAIStatefulTask.html#a4dd75e11ef6fd1b14613ad494d8e93d9">AIStatefulTask::aborted</a></div><div class="ttdeci">bool aborted() const</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:642</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_a31078b881cbbf42d2e3e3998b905d1b2"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#a31078b881cbbf42d2e3e3998b905d1b2">AIStatefulTask::Handler::special_t</a></div><div class="ttdeci">special_t</div><div class="ttdoc">A typed use by the constuctor Handler(special_t). </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:150</div></div>
<div class="ttc" id="classAIStatefulTask_html_a650d995db3e1117ce9c26947aef34d90"><div class="ttname"><a href="classAIStatefulTask.html#a650d995db3e1117ce9c26947aef34d90">AIStatefulTask::event_str</a></div><div class="ttdeci">static char const  * event_str(event_type event)</div><div class="ttdef"><b>Definition:</b> AIStatefulTask.cxx:421</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_a933c3c024a9b3fe38c97e5efbe70b17c"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#a933c3c024a9b3fe38c97e5efbe70b17c">AIStatefulTask::Handler::is_immediate</a></div><div class="ttdeci">bool is_immediate() const</div><div class="ttdoc">Return true if this is an immediate  Handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:178</div></div>
<div class="ttc" id="classAIStatefulTask_html_acb2390570fc523acceee2a25fc054022a9b6c32619c183bf636f8a38c30fa1ecc"><div class="ttname"><a href="classAIStatefulTask.html#acb2390570fc523acceee2a25fc054022a9b6c32619c183bf636f8a38c30fa1ecc">AIStatefulTask::bs_multiplex</a></div><div class="ttdoc">State after initialize_impl and before finish() or abort(). </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:105</div></div>
<div class="ttc" id="structAIStatefulTask_1_1Handler_html_a82a63fa453b6988b945dbcfc17d5a331"><div class="ttname"><a href="structAIStatefulTask_1_1Handler.html#a82a63fa453b6988b945dbcfc17d5a331">AIStatefulTask::Handler::operator==</a></div><div class="ttdeci">bool operator==(Handler handler) const</div><div class="ttdoc">Return true when equivalent to handler. </div><div class="ttdef"><b>Definition:</b> AIStatefulTask.h:187</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<hr class="footer"/>
<address class="footer" style="text-align:left; margin-left: 10px; font-size: 90%;">
Revised Tue Dec 3 2019
<span style="float:right;">Copyright &copy; Carlo Wood, 2018-2019.</span>
</address>
</body>
</html>
